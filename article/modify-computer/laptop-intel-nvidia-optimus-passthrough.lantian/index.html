<!DOCTYPE html><html lang="zh-CN" itemscope="" itemtype="https://schema.org/Article" data-astro-cid-porej7z2=""> <head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>笔记本 Optimus MUXless 下的 Intel 和 NVIDIA 虚拟机显卡直通 - Lan Tian @ Blog</title><script>
  ;(() => {
    try {
      const mode = localStorage.getItem('user-color-scheme')
      if (mode == 'dark' || mode == 'light') {
        document.documentElement.setAttribute('data-user-color-scheme', mode)
      }
    } catch {
      // Ignore errors
    }
  })()
</script><link rel="stylesheet" href="/assets/index.CUlf1-Vz.css"><style>#post-navi[data-astro-cid-gfbmwgei]{padding:5px;border-top:1px solid var(--lt-border-weak);border-bottom:1px solid var(--lt-border-weak)}
ol[data-astro-cid-nj3qel45]{margin:0;padding:0;line-height:1.5}ol[data-astro-cid-nj3qel45] .toc-item[data-astro-cid-nj3qel45]{list-style:none}ol[data-astro-cid-nj3qel45] .toc-child[data-astro-cid-nj3qel45],ol[data-astro-cid-nj3qel45] .toc[data-astro-cid-nj3qel45]{padding:0}ol[data-astro-cid-nj3qel45] .toc-link[data-astro-cid-nj3qel45]{display:block;margin-left:1em;padding:.25em 0}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:1em;padding:.25em 0;float:left;font-style:normal;font-variant:normal;font-weight:900;font-family:Font Awesome\ 6 Free;font-feature-settings:normal;text-align:center}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before{content:""}ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{content:""}.post-info-wrap[data-astro-cid-dckccua4]{-ms-flex:0 0 2.5em;flex:0 0 2.5em;background-color:var(--lt-component-bg-emphasis)}@media(min-width:768px){.post-info[data-astro-cid-dckccua4]{position:sticky;top:0}}@media(max-width:767.98px){.post-info[data-astro-cid-dckccua4]{position:absolute}}
</style><script type="module" src="/assets/PageLayout.astro_astro_type_script_index_0_lang.C1wfUPs6.js"></script><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="imagemode" content="force"><meta name="nightmode" content="disable"><meta name="wap-font-scale" content="no"><meta name="title" content="笔记本 Optimus MUXless 下的 Intel 和 NVIDIA 虚拟机显卡直通 - Lan Tian @ Blog"><meta name="keywords" content=""><meta name="author" content="Lan Tian"><link rel="canonical" href="https://lantian.pub/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/"><link rel="alternate" type="application/rss+xml" title="Lan Tian @ Blog" href="https://lantian.pub/rss2.xml"><link rel="alternate" type="application/atom+xml" title="Lan Tian @ Blog" href="https://lantian.pub/feed.xml"><link rel="alternate" href="https://lantian.pub/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" hreflang="zh"><link rel="alternate" href="https://lantian.pub/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" hreflang="en"><meta name="copyright" content="Copyright 2012-2025 Lan Tian @ Blog"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="manifest" href="/manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#03a9f4"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#212121"><meta name="application-name" content="Lan Tian @ Blog"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-precomposed.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#03a9f4"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lan Tian @ Blog"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1170x2532.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2532x1170.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1179x2556.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2556x1179.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1284x2778.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2778x1284.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1290x2796.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2796x1290.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1488x2266.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2266x1488.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1640x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1640.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"><meta name="msapplication-TileColor" content="#bbdefb"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta name="msapplication-config" content="/browserconfig.xml"><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"><meta property="og:url" content="https://lantian.pub/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/"><meta property="og:type" content="website"><meta property="og:title" content="笔记本 Optimus MUXless 下的 Intel 和 NVIDIA 虚拟机显卡直通 - Lan Tian @ Blog"><meta property="og:image" content="https://lantian.pub/usr/uploads/202007/linus-torvalds-nvidia.png"><meta content="更新记录 2022-07-21：补充 GVT-g 开机自启，感谢 Owsmyf 提醒。2022-01-22：根据 NVIDIA 驱动更新、评论区反馈更新内容。 我在新电脑上成功完成了 Optimus MUXed 显卡直通。 摘要（剧透） 我成功在联想 R720 游戏本上把 Intel 核显的 GVT-g 虚拟显卡，以及 NVIDIA 独显本身直通进了虚拟机。 但是由于受到架构本身的限制，这套方案有非常大的局限，例如很多游戏无法调用独显、操作麻烦、显示性能仍然较低等。 因此，现阶段可以为了折腾而尝试，但不建议用于实用用途。 为什么要这么做 我平常浏览网页、写代码等操作都在 Arch Linux 系统下完成，很少使用 Windows 双系统。但是有的时候我想和同学联机游戏，就不得不重启到 Windows 系统。 虽然已经有了 Wine、Proton 兼容层来运行 Windows 应用，还有 DXVK 来转译 DirectX 命令到 Vulkan 来提升性能，但是还是有很多游戏无法在 Wine 环境下正常运行，例如自带 DRM 或者反作弊保护的游戏，..."><meta property="og:site_name" content="Lan Tian @ Blog"><meta property="og:locale" content="zh"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://lantian.pub/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/"><meta name="twitter:title" content="笔记本 Optimus MUXless 下的 Intel 和 NVIDIA 虚拟机显卡直通 - Lan Tian @ Blog"><meta property="twitter:image" content="https://lantian.pub/usr/uploads/202007/linus-torvalds-nvidia.png"><meta content="更新记录 2022-07-21：补充 GVT-g 开机自启，感谢 Owsmyf 提醒。2022-01-22：根据 NVIDIA 驱动更新、评论区反馈更新内容。 我在新电脑上成功完成了 Optimus MUXed 显卡直通。 摘要（剧透） 我成功在联想 R720 游戏本上把 Intel 核显的 GVT-g 虚拟显卡，以及 NVIDIA 独显本身直通进了虚拟机。 但是由于受到架构本身的限制，这套方案有非常大的局限，例如很多游戏无法调用独显、操作麻烦、显示性能仍然较低等。 因此，现阶段可以为了折腾而尝试，但不建议用于实用用途。 为什么要这么做 我平常浏览网页、写代码等操作都在 Arch Linux 系统下完成，很少使用 Windows 双系统。但是有的时候我想和同学联机游戏，就不得不重启到 Windows 系统。 虽然已经有了 Wine、Proton 兼容层来运行 Windows 应用，还有 DXVK 来转译 DirectX 命令到 Vulkan 来提升性能，但是还是有很多游戏无法在 Wine 环境下正常运行，例如自带 DRM 或者反作弊保护的游戏，..."><meta name="twitter:dnt" content="on"><meta itemprop="name" content="笔记本 Optimus MUXless 下的 Intel 和 NVIDIA 虚拟机显卡直通 - Lan Tian @ Blog"><meta property="image" content="https://lantian.pub/usr/uploads/202007/linus-torvalds-nvidia.png"><meta content="更新记录 2022-07-21：补充 GVT-g 开机自启，感谢 Owsmyf 提醒。2022-01-22：根据 NVIDIA 驱动更新、评论区反馈更新内容。 我在新电脑上成功完成了 Optimus MUXed 显卡直通。 摘要（剧透） 我成功在联想 R720 游戏本上把 Intel 核显的 GVT-g 虚拟显卡，以及 NVIDIA 独显本身直通进了虚拟机。 但是由于受到架构本身的限制，这套方案有非常大的局限，例如很多游戏无法调用独显、操作麻烦、显示性能仍然较低等。 因此，现阶段可以为了折腾而尝试，但不建议用于实用用途。 为什么要这么做 我平常浏览网页、写代码等操作都在 Arch Linux 系统下完成，很少使用 Windows 双系统。但是有的时候我想和同学联机游戏，就不得不重启到 Windows 系统。 虽然已经有了 Wine、Proton 兼容层来运行 Windows 应用，还有 DXVK 来转译 DirectX 命令到 Vulkan 来提升性能，但是还是有很多游戏无法在 Wine 环境下正常运行，例如自带 DRM 或者反作弊保护的游戏，..."><meta content="更新记录 2022-07-21：补充 GVT-g 开机自启，感谢 Owsmyf 提醒。2022-01-22：根据 NVIDIA 驱动更新、评论区反馈更新内容。 我在新电脑上成功完成了 Optimus MUXed 显卡直通。 摘要（剧透） 我成功在联想 R720 游戏本上把 Intel 核显的 GVT-g 虚拟显卡，以及 NVIDIA 独显本身直通进了虚拟机。 但是由于受到架构本身的限制，这套方案有非常大的局限，例如很多游戏无法调用独显、操作麻烦、显示性能仍然较低等。 因此，现阶段可以为了折腾而尝试，但不建议用于实用用途。 为什么要这么做 我平常浏览网页、写代码等操作都在 Arch Linux 系统下完成，很少使用 Windows 双系统。但是有的时候我想和同学联机游戏，就不得不重启到 Windows 系统。 虽然已经有了 Wine、Proton 兼容层来运行 Windows 应用，还有 DXVK 来转译 DirectX 命令到 Vulkan 来提升性能，但是还是有很多游戏无法在 Wine 环境下正常运行，例如自带 DRM 或者反作弊保护的游戏，..."><link rel="me" href="https://mastodon.social/@lantian"></head> <body data-astro-cid-porej7z2=""> <div id="bg" data-astro-cid-j6vmxtef=""></div>   <div id="container" class="container" data-astro-cid-porej7z2=""> <nav class="lantian navbar navbar-expand-lg" data-astro-cid-wu5dj4rx=""> <div class="container-fluid" data-astro-cid-wu5dj4rx=""> <a class="navbar-brand" href="/" data-astro-cid-wu5dj4rx="">Lan Tian @ Blog</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#lantian-navbar" aria-controls="lantian-navbar" aria-expanded="false" aria-label="Toggle navigation" data-astro-cid-wu5dj4rx=""> <span class="navbar-toggler-icon" data-astro-cid-wu5dj4rx=""></span> </button> <div class="collapse navbar-collapse" id="lantian-navbar" data-astro-cid-wu5dj4rx=""> <ul class="navbar-nav" data-astro-cid-wu5dj4rx=""> <li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/page/archive/index.html" data-astro-cid-wu5dj4rx=""> 文章们 </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> 俯瞰地球 </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> <li class="nav-item dropdown d-block d-lg-none" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="pages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-file" data-astro-cid-wu5dj4rx=""></i> 页面  <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="pages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/page/archive/index.html" data-astro-cid-wu5dj4rx=""> 文章们 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> 俯瞰地球 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> </ul> </li> </ul> <ul class="navbar-nav ms-auto" data-astro-cid-wu5dj4rx=""> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="languages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-language" data-astro-cid-wu5dj4rx=""></i> Language <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="languages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item active" href="/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-cn" data-astro-cid-wu5dj4rx=""></span> Chinese Simplified / 简体中文 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-us" data-astro-cid-wu5dj4rx=""></span> English </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">Not all pages have translations.</a> </li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">You may see 404 - this is normal.</a> </li> </ul> </li> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="color-scheme-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> 夜间模式 </a> <ul class="dropdown-menu" aria-labelledby="color-scheme-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-auto" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> 自动 </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-light" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-sun" data-astro-cid-wu5dj4rx=""></i> 浅色</a> </li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-dark" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-moon" data-astro-cid-wu5dj4rx=""></i> 深色</a> </li> </ul> </li> </ul> </div> </div> </nav> <script type="module">const m="user-color-scheme",s="data-user-color-scheme",u=(e,t)=>{try{localStorage.setItem(e,t)}catch{}},i=e=>{try{return localStorage.getItem(e)}catch{return null}},c=e=>{const t={dark:!0,light:!0,auto:!0},o=e===null||!Object.keys(t).includes(e)?"auto":e;u(m,o);for(const l in t){const n=document.getElementById("color-scheme-"+l);n&&(l==o?n.classList.add("active"):n.classList.remove("active"))}o!="auto"?document.documentElement.setAttribute(s,o):document.documentElement.removeAttribute(s)};c(i(m));const r=document.getElementById("color-scheme-auto");r&&r.addEventListener("click",()=>c("auto"));const a=document.getElementById("color-scheme-light");a&&a.addEventListener("click",()=>c("light"));const d=document.getElementById("color-scheme-dark");d&&d.addEventListener("click",()=>c("dark"));</script>  <div class="d-flex" data-astro-cid-porej7z2=""> <div id="content" data-astro-cid-porej7z2="">  <article> <div class="d-flex"> <div class="post-info-wrap" data-astro-cid-dckccua4=""> <div class="post-info" data-astro-cid-dckccua4=""> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-clock"></span> <br> <small>06-25</small> </p> <div class="post-meta-value"> 发布于<span class="badge badge-tag" data-astro-cid-dckccua4=""> 2020-06-25 23:59 </span>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-file-alt"></span> <br> <small>计算机与客户端</small> </p> <div class="post-meta-value"> 分类 <a class="badge badge-tag" href="/category/modify-computer" data-astro-cid-dckccua4=""> 计算机与客户端 </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-tag"></span> <br> <small>5 标签</small> </p> <div class="post-meta-value"> 标签  <a class="badge badge-tag" href="/tag/显卡" data-astro-cid-dckccua4=""> 显卡 </a>  <a class="badge badge-tag" href="/tag/虚拟机" data-astro-cid-dckccua4=""> 虚拟机 </a>  <a class="badge badge-tag" href="/tag/Intel" data-astro-cid-dckccua4=""> Intel </a>  <a class="badge badge-tag" href="/tag/NVIDIA" data-astro-cid-dckccua4=""> NVIDIA </a>  <a class="badge badge-tag" href="/tag/MUXless" data-astro-cid-dckccua4=""> MUXless </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-list"></span> <br> <small>目录</small> </p> <div class="post-meta-value">  <ol data-astro-cid-nj3qel45=""> <li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#更新记录" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">更新记录</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#摘要剧透" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">摘要（剧透）</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#为什么要这么做" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">为什么要这么做</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#我的系统环境" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">我的系统环境</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#禁止宿主系统管理-nvidia-独显" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">禁止宿主系统管理 NVIDIA 独显</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#配置-intel-gvt-g-虚拟核显" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">配置 Intel GVT-g 虚拟核显</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#配置-nvidia-独显直通" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">配置 NVIDIA 独显直通</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#下一步呢" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">下一步呢？</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#资料来源" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">资料来源</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#附录最终-libvirt-xml-文件" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">附录：最终 Libvirt XML 文件</span> </a> </li> </ol>   </div> </div> </div> </div>  </div>  <div class="post-wrap"> <div class="post-image-wrap"> <picture> <source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.thumb.png.webp" type="image/webp"> <source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.thumb.png.avif" type="image/avif"> <source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.thumb.png.jxl" type="image/jxl"> <img src="/usr/uploads/202007/linus-torvalds-nvidia.png.thumb.png" alt="笔记本 Optimus MUXless 下的 Intel 和 NVIDIA 虚拟机显卡直通 的插图" width="200" height="150"> </picture> </div> <h1 class="post-title"> <a href="/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" rel="bookmark" title="笔记本 Optimus MUXless 下的 Intel 和 NVIDIA 虚拟机显卡直通">笔记本 Optimus MUXless 下的 Intel 和 NVIDIA 虚拟机显卡直通</a> </h1> <div class="post-text">   <h2 id="更新记录">更新记录</h2>
<p>2022-07-21：补充 GVT-g 开机自启，感谢 Owsmyf 提醒。2022-01-22：根据 NVIDIA 驱动更新、评论区反馈更新内容。</p>
<blockquote>
<p><a href="/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian">我在新电脑上成功完成了 Optimus MUXed 显卡直通。</a></p>
</blockquote>
<h2 id="摘要剧透">摘要（剧透）</h2>
<p>我成功在联想 R720 游戏本上把 Intel 核显的 GVT-g 虚拟显卡，以及 NVIDIA 独显本身直通进了虚拟机。</p>
<p>但是由于受到架构本身的限制，这套方案有非常大的局限，例如很多游戏无法调用独显、操作麻烦、显示性能仍然较低等。</p>
<p>因此，现阶段可以为了折腾而尝试，但不建议用于实用用途。</p>
<h2 id="为什么要这么做">为什么要这么做</h2>
<p>我平常浏览网页、写代码等操作都在 Arch Linux 系统下完成，很少使用 Windows 双系统。但是有的时候我想和同学联机游戏，就不得不重启到 Windows 系统。</p>
<blockquote>
<p>虽然已经有了 Wine、Proton 兼容层来运行 Windows 应用，还有 DXVK 来转译 DirectX
命令到 Vulkan 来提升性能，但是还是有很多游戏无法在 Wine 环境下正常运行，例如自带 DRM 或者反作弊保护的游戏，以及调用了奇怪 API 的游戏。</p>
</blockquote>
<p>但双系统意味着需要维护两套系统，包括分别的系统更新、数据的共享和同步等等。例如我为了在 Windows 下正常访问自己的文件，不得不开了台 Hyper-V 虚拟机装上 Linux，然后把 Linux ZFS 分区所在的硬盘直通进去，再用 Samba 共享出来。</p>
<blockquote>
<p>内存立减 1G，而且启动还慢，进桌面后过两三分钟网络驱动器才连接上。</p>
</blockquote>
<p>而传统的虚拟机软件（QEMU，VirtualBox，VMware）等的 3D 图形性能都很差。</p>
<ul>
<li>QEMU：3D 加速是什么？能吃吗？
<ul>
<li>指只支持 2D 加速的 QXL</li>
<li>有 Virtio-GPU 这个支持 3D 的尝试，但功能不完整且不支持 Windows</li>
</ul>
</li>
<li>VirtualBox：3D 加速聊胜于无
<ul>
<li>支持一点 DirectX，但是还是不完整</li>
<li>而且在我的电脑上 VirtualBox 的 2D 图形绘制也会时常出错</li>
<li>而且在我的电脑上 VirtualBox 有时会卡死（与 ZFS 的兼容性问题？）</li>
</ul>
</li>
<li>VMware：3D 加速（相对）最好的一个
<ul>
<li>但还是不够用</li>
<li>而且闭源+收费</li>
</ul>
</li>
</ul>
<p>另一种常用的方法是使用虚拟机软件的 PCIe 直通功能，让虚拟机独占高性能显卡，直接加载显卡对应的驱动，和显卡直接通信。</p>
<ul>
<li>这种方法需要 CPU 支持 VT-d 技术（Intel）或者 AMD-Vi（AMD），但近几年的 CPU 应该都支持
<ul>
<li>除非你是个垃圾佬</li>
</ul>
</li>
<li>同时需要至少两张显卡（集显/核显也算在内）
<ul>
<li>因为高性能独显被虚拟机占走了，如果没有第二张显卡，宿主系统就没有地方显示信息了</li>
</ul>
</li>
<li>同时需要一个支持 PCIe 直通的虚拟机软件
<ul>
<li>VirtualBox 和 VMware Workstation 据我所知是不行的</li>
<li>VMware ESXi（一个专门用于虚拟化的操作系统）是可以的
<ul>
<li>对于个人用户免费，而且有非常方便的网页界面</li>
<li>缺点是闭源，挑网卡驱动，而且占用资源有点大（比如内存）</li>
</ul>
</li>
<li>Proxmox VE 也支持
<ul>
<li>一个基于 Debian 的、专门针对虚拟化的系统</li>
<li>系统本身免费开源，技术支持收费</li>
<li>基于 QEMU</li>
</ul>
</li>
<li>或者你在自己的 Linux 上装个 QEMU 也可以
<ul>
<li>QEMU：免费，开源，神（</li>
<li>QEMU 启动要输一长串命令，但可以用 Libvirt 及 Virt-Manager 进行方便的管理</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>但是对于 NVIDIA 显卡和笔记本平台来说，事情又要麻烦一些：</p>
<ul>
<li>
<p>NVIDIA 的驱动在虚拟机中会拒绝加载</p>
<ul>
<li>NVIDIA 不想让你买了几千块钱的民用卡就在虚拟机里用，他们希望你去买上万的 GRID
虚拟化专用卡。
<ul>
<li><picture><source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.webp" type="image/webp"><source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.avif" type="image/avif"><source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.jxl" type="image/jxl"><img src="/usr/uploads/202007/linus-torvalds-nvidia.png" alt="Linus Torvalds Fxxk Nvidia"></picture></li>
</ul>
</li>
<li>因此需要用一大堆神奇的操作来隐藏「这是个虚拟机」的事实，让 NVIDIA 驱动乖乖启动。
<ul>
<li>后续部分中会详细介绍。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>笔记本电脑上的 NVIDIA 显卡和台式机上的是不一样的</p>
<ul>
<li>
<p>不止是指性能，在整体架构上也有区别。</p>
</li>
<li>
<p>在台式机上，显卡的连接方式是这样的：</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!-- Generated by graphviz version 14.0.2 (0)
 --><!-- Pages: 1 -->
<svg width="254pt" height="98pt" viewBox="0.00 0.00 254.00 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<polygon fill="white" stroke="none" points="-4,4 -4,-94 249.77,-94 249.77,4 -4,4"></polygon><!-- CPU -->
<g id="node1" class="node">
<title>CPU</title>
<polygon fill="none" stroke="black" points="54,-63 0,-63 0,-27 54,-27 54,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="27" y="-40.8" font-family="Times,serif" font-size="14.00">CPU</text>
</g><!-- NVIDIA -->
<g id="node2" class="node">
<title>NVIDIA</title>
<polygon fill="none" stroke="black" points="155.77,-63 90,-63 90,-27 155.77,-27 155.77,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="122.88" y="-40.8" font-family="Times,serif" font-size="14.00">NVIDIA</text>
</g><!-- CPU&#45;&gt;NVIDIA -->
<g id="edge1" class="edge">
<title>CPU->NVIDIA</title>
<path fill="none" stroke="black" d="M54.4,-45C61.85,-45 70.15,-45 78.32,-45"></path>
<polygon fill="black" stroke="black" points="78.16,-48.5 88.16,-45 78.16,-41.5 78.16,-48.5"></polygon>
</g><!-- HDMI -->
<g id="node3" class="node">
<title>HDMI</title>
<polygon fill="none" stroke="black" points="245.77,-90 191.77,-90 191.77,-54 245.77,-54 245.77,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="218.77" y="-67.8" font-family="Times,serif" font-size="14.00">HDMI</text>
</g><!-- NVIDIA&#45;&gt;HDMI -->
<g id="edge2" class="edge">
<title>NVIDIA->HDMI</title>
<path fill="none" stroke="black" d="M156.19,-54.29C163.98,-56.53 172.36,-58.94 180.36,-61.24"></path>
<polygon fill="black" stroke="black" points="179.28,-64.57 189.85,-63.97 181.21,-57.85 179.28,-64.57"></polygon>
</g><!-- 显示器 -->
<g id="node4" class="node">
<title>显示器</title>
<polygon fill="none" stroke="black" points="245.77,-36 191.77,-36 191.77,0 245.77,0 245.77,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="218.77" y="-13.8" font-family="Times,serif" font-size="14.00">显示器</text>
</g><!-- NVIDIA&#45;&gt;显示器 -->
<g id="edge3" class="edge">
<title>NVIDIA->显示器</title>
<path fill="none" stroke="black" d="M156.19,-35.71C163.98,-33.47 172.36,-31.06 180.36,-28.76"></path>
<polygon fill="black" stroke="black" points="181.21,-32.15 189.85,-26.03 179.28,-25.43 181.21,-32.15"></polygon>
</g>
</g>
</svg>
</p>
<p>也就是显卡只连接 CPU 和显示器，不关心其它的东西。</p>
</li>
<li>
<p>但在笔记本上又有不同，而且不同的笔记本电脑也是有区别的。</p>
<ul>
<li>
<p>如果你买的是几千元的中低端游戏本，连接方式可能是这样的：</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!-- Generated by graphviz version 14.0.2 (0)
 --><!-- Pages: 1 -->
<svg width="254pt" height="125pt" viewBox="0.00 0.00 254.00 125.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 121)">
<polygon fill="white" stroke="none" points="-4,4 -4,-121 250.16,-121 250.16,4 -4,4"></polygon><!-- CPU -->
<g id="node1" class="node">
<title>CPU</title>
<polygon fill="none" stroke="black" points="54,-90 0,-90 0,-54 54,-54 54,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="27" y="-67.8" font-family="Times,serif" font-size="14.00">CPU</text>
</g><!-- NVIDIA -->
<g id="node2" class="node">
<title>NVIDIA</title>
<polygon fill="none" stroke="black" points="155.96,-117 90.19,-117 90.19,-81 155.96,-81 155.96,-117"></polygon>
<text xml:space="preserve" text-anchor="middle" x="123.08" y="-94.8" font-family="Times,serif" font-size="14.00">NVIDIA</text>
</g><!-- CPU&#45;&gt;NVIDIA -->
<g id="edge1" class="edge">
<title>CPU->NVIDIA</title>
<path fill="none" stroke="black" d="M54.46,-79.59C62.09,-81.78 70.62,-84.23 78.99,-86.63"></path>
<polygon fill="black" stroke="black" points="77.77,-89.92 88.35,-89.32 79.7,-83.2 77.77,-89.92"></polygon>
</g><!-- Intel 核显 -->
<g id="node3" class="node">
<title>Intel 核显</title>
<polygon fill="none" stroke="black" points="156.16,-63 90,-63 90,-27 156.16,-27 156.16,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="123.08" y="-40.8" font-family="Times,serif" font-size="14.00">Intel 核显</text>
</g><!-- CPU&#45;&gt;Intel 核显 -->
<g id="edge2" class="edge">
<title>CPU->Intel 核显</title>
<path fill="none" stroke="black" d="M54.46,-64.41C62.09,-62.22 70.62,-59.77 78.99,-57.37"></path>
<polygon fill="black" stroke="black" points="79.7,-60.8 88.35,-54.68 77.77,-54.08 79.7,-60.8"></polygon>
</g><!-- NVIDIA&#45;&gt;Intel 核显 -->
<g id="edge3" class="edge">
<title>NVIDIA->Intel 核显</title>
<path fill="none" stroke="black" d="M123.08,-80.51C123.08,-78.52 123.08,-76.53 123.08,-74.54"></path>
<polygon fill="black" stroke="black" points="126.58,-74.65 123.08,-64.65 119.58,-74.65 126.58,-74.65"></polygon>
</g><!-- HDMI -->
<g id="node4" class="node">
<title>HDMI</title>
<polygon fill="none" stroke="black" points="246.16,-90 192.16,-90 192.16,-54 246.16,-54 246.16,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="219.16" y="-67.8" font-family="Times,serif" font-size="14.00">HDMI</text>
</g><!-- Intel 核显&#45;&gt;HDMI -->
<g id="edge4" class="edge">
<title>Intel 核显->HDMI</title>
<path fill="none" stroke="black" d="M156.45,-54.29C164.33,-56.55 172.81,-58.99 180.9,-61.31"></path>
<polygon fill="black" stroke="black" points="179.92,-64.67 190.49,-64.06 181.85,-57.94 179.92,-64.67"></polygon>
</g><!-- 显示器 -->
<g id="node5" class="node">
<title>显示器</title>
<polygon fill="none" stroke="black" points="246.16,-36 192.16,-36 192.16,0 246.16,0 246.16,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="219.16" y="-13.8" font-family="Times,serif" font-size="14.00">显示器</text>
</g><!-- Intel 核显&#45;&gt;显示器 -->
<g id="edge5" class="edge">
<title>Intel 核显->显示器</title>
<path fill="none" stroke="black" d="M156.45,-35.71C164.33,-33.45 172.81,-31.01 180.9,-28.69"></path>
<polygon fill="black" stroke="black" points="181.85,-32.06 190.49,-25.94 179.92,-25.33 181.85,-32.06"></polygon>
</g>
</g>
</svg>
</p>
<p>区别在于，独显不直连显示器，而是将渲染好的画面传输给核显，让核显发给显示器。</p>
<p>这种方案称为 NVIDIA Optimus 的 MUXless 结构。</p>
<ul>
<li>优点：
<ul>
<li>省电（独显不用时可以直接关闭）</li>
<li>省钱（相比另外几种方案）</li>
</ul>
</li>
<li>缺点：
<ul>
<li>游戏画面渲染延迟大（因为独显需要额外一步传输画面到核显）</li>
<li>显卡直通时会遇到严重的技术难题：
<ul>
<li>Windows 优先把游戏放在当前显示器对应的显卡上运行。
<ul>
<li>由于独显没有连接显示器，因此游戏不会优先使用独显，而是根据你的虚拟机配置，使用低性能虚拟显卡（例如 QXL）或者使用 Intel 的 GVT-g 虚拟显卡（核显级性能）。</li>
</ul>
</li>
<li>在 Intel + NVIDIA Optimus 的组合中，NVIDIA 的驱动会负责把游戏调到独显上渲染。
<ul>
<li>但是 NVIDIA 驱动不承认 Intel GVT-g 虚拟显卡可以加入这个组合，就不会启动 Optimus。</li>
</ul>
</li>
<li>也就是，除非游戏主动检测并调用独显，否则游戏会在核显上运行。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>如果你买的是一万元左右的中高端游戏本，连接方式可能是这样的：</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!-- Generated by graphviz version 14.0.2 (0)
 --><!-- Pages: 1 -->
<svg width="254pt" height="98pt" viewBox="0.00 0.00 254.00 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<polygon fill="white" stroke="none" points="-4,4 -4,-94 250.16,-94 250.16,4 -4,4"></polygon><!-- CPU -->
<g id="node1" class="node">
<title>CPU</title>
<polygon fill="none" stroke="black" points="54,-63 0,-63 0,-27 54,-27 54,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="27" y="-40.8" font-family="Times,serif" font-size="14.00">CPU</text>
</g><!-- NVIDIA -->
<g id="node2" class="node">
<title>NVIDIA</title>
<polygon fill="none" stroke="black" points="155.96,-90 90.19,-90 90.19,-54 155.96,-54 155.96,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="123.08" y="-67.8" font-family="Times,serif" font-size="14.00">NVIDIA</text>
</g><!-- CPU&#45;&gt;NVIDIA -->
<g id="edge1" class="edge">
<title>CPU->NVIDIA</title>
<path fill="none" stroke="black" d="M54.46,-52.59C62.09,-54.78 70.62,-57.23 78.99,-59.63"></path>
<polygon fill="black" stroke="black" points="77.77,-62.92 88.35,-62.32 79.7,-56.2 77.77,-62.92"></polygon>
</g><!-- Intel 核显 -->
<g id="node3" class="node">
<title>Intel 核显</title>
<polygon fill="none" stroke="black" points="156.16,-36 90,-36 90,0 156.16,0 156.16,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="123.08" y="-13.8" font-family="Times,serif" font-size="14.00">Intel 核显</text>
</g><!-- CPU&#45;&gt;Intel 核显 -->
<g id="edge2" class="edge">
<title>CPU->Intel 核显</title>
<path fill="none" stroke="black" d="M54.46,-37.41C62.09,-35.22 70.62,-32.77 78.99,-30.37"></path>
<polygon fill="black" stroke="black" points="79.7,-33.8 88.35,-27.68 77.77,-27.08 79.7,-33.8"></polygon>
</g><!-- NVIDIA&#45;&gt;Intel 核显 -->
<g id="edge3" class="edge">
<title>NVIDIA->Intel 核显</title>
<path fill="none" stroke="black" d="M123.08,-53.51C123.08,-47.72 123.08,-41.93 123.08,-36.14"></path>
</g><!-- HDMI -->
<g id="node4" class="node">
<title>HDMI</title>
<polygon fill="none" stroke="black" points="246.16,-90 192.16,-90 192.16,-54 246.16,-54 246.16,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="219.16" y="-67.8" font-family="Times,serif" font-size="14.00">HDMI</text>
</g><!-- NVIDIA&#45;&gt;HDMI -->
<g id="edge6" class="edge">
<title>NVIDIA->HDMI</title>
<path fill="none" stroke="black" d="M156.45,-72C164.24,-72 172.62,-72 180.62,-72"></path>
<polygon fill="black" stroke="black" points="180.43,-75.5 190.43,-72 180.43,-68.5 180.43,-75.5"></polygon>
</g><!-- 显示器 -->
<g id="node5" class="node">
<title>显示器</title>
<polygon fill="none" stroke="black" points="246.16,-36 192.16,-36 192.16,0 246.16,0 246.16,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="219.16" y="-13.8" font-family="Times,serif" font-size="14.00">显示器</text>
</g><!-- NVIDIA&#45;&gt;显示器 -->
<g id="edge7" class="edge">
<title>NVIDIA->显示器</title>
<path fill="none" stroke="black" d="M156.19,-53.57C164.44,-48.83 173.37,-43.7 181.82,-38.86"></path>
<polygon fill="black" stroke="black" points="183.56,-41.89 190.49,-33.88 180.08,-35.82 183.56,-41.89"></polygon>
</g><!-- Intel 核显&#45;&gt;HDMI -->
<g id="edge4" class="edge">
<title>Intel 核显->HDMI</title>
<path fill="none" stroke="black" d="M156.19,-36.43C164.44,-41.17 173.37,-46.3 181.82,-51.14"></path>
<polygon fill="black" stroke="black" points="180.08,-54.18 190.49,-56.12 183.56,-48.11 180.08,-54.18"></polygon>
</g><!-- Intel 核显&#45;&gt;显示器 -->
<g id="edge5" class="edge">
<title>Intel 核显->显示器</title>
<path fill="none" stroke="black" d="M156.45,-18C164.24,-18 172.62,-18 180.62,-18"></path>
<polygon fill="black" stroke="black" points="180.43,-21.5 190.43,-18 180.43,-14.5 180.43,-21.5"></polygon>
</g>
</g>
</svg>
</p>
<p>与上一种方案的区别在于，电脑主板的电路上加入了开关，可以设置 HDMI 接口及显示器分别由核显或独显进行管理。</p>
<p>这种方案也是 NVIDIA Optimus 的一种，称为 MUXed 结构。</p>
<ul>
<li>优点：
<ul>
<li>省电（独显不用时可以关闭）</li>
<li>游戏渲染延迟小（只要将显示器切到独显上即可）</li>
<li>显卡直通更方便
<ul>
<li>例如，可以把独显切给 HDMI 接口，再在淘宝上 5 块钱买一个 HDMI 欺骗器（假显示器），这样虚拟机里的游戏就都会调用独显了；再用远程桌面等软件查看独显画面。</li>
</ul>
</li>
</ul>
</li>
<li>缺点：
<ul>
<li>贵（电路复杂）</li>
</ul>
</li>
</ul>
</li>
<li>
<p>如果你买的是几万块钱的「后浪专用」厚砖游戏本，连接方式可能是这样的：</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!-- Generated by graphviz version 14.0.2 (0)
 --><!-- Pages: 1 -->
<svg width="254pt" height="98pt" viewBox="0.00 0.00 254.00 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<polygon fill="white" stroke="none" points="-4,4 -4,-94 249.77,-94 249.77,4 -4,4"></polygon><!-- CPU -->
<g id="node1" class="node">
<title>CPU</title>
<polygon fill="none" stroke="black" points="54,-63 0,-63 0,-27 54,-27 54,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="27" y="-40.8" font-family="Times,serif" font-size="14.00">CPU</text>
</g><!-- NVIDIA -->
<g id="node2" class="node">
<title>NVIDIA</title>
<polygon fill="none" stroke="black" points="155.77,-63 90,-63 90,-27 155.77,-27 155.77,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="122.88" y="-40.8" font-family="Times,serif" font-size="14.00">NVIDIA</text>
</g><!-- CPU&#45;&gt;NVIDIA -->
<g id="edge1" class="edge">
<title>CPU->NVIDIA</title>
<path fill="none" stroke="black" d="M54.4,-45C61.85,-45 70.15,-45 78.32,-45"></path>
<polygon fill="black" stroke="black" points="78.16,-48.5 88.16,-45 78.16,-41.5 78.16,-48.5"></polygon>
</g><!-- HDMI -->
<g id="node3" class="node">
<title>HDMI</title>
<polygon fill="none" stroke="black" points="245.77,-90 191.77,-90 191.77,-54 245.77,-54 245.77,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="218.77" y="-67.8" font-family="Times,serif" font-size="14.00">HDMI</text>
</g><!-- NVIDIA&#45;&gt;HDMI -->
<g id="edge2" class="edge">
<title>NVIDIA->HDMI</title>
<path fill="none" stroke="black" d="M156.19,-54.29C163.98,-56.53 172.36,-58.94 180.36,-61.24"></path>
<polygon fill="black" stroke="black" points="179.28,-64.57 189.85,-63.97 181.21,-57.85 179.28,-64.57"></polygon>
</g><!-- 显示器 -->
<g id="node4" class="node">
<title>显示器</title>
<polygon fill="none" stroke="black" points="245.77,-36 191.77,-36 191.77,0 245.77,0 245.77,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="218.77" y="-13.8" font-family="Times,serif" font-size="14.00">显示器</text>
</g><!-- NVIDIA&#45;&gt;显示器 -->
<g id="edge3" class="edge">
<title>NVIDIA->显示器</title>
<path fill="none" stroke="black" d="M156.19,-35.71C163.98,-33.47 172.36,-31.06 180.36,-28.76"></path>
<polygon fill="black" stroke="black" points="181.21,-32.15 189.85,-26.03 179.28,-25.43 181.21,-32.15"></polygon>
</g>
</g>
</svg>
</p>
<p>你问核显哪去了？你都买几万块钱的电脑玩游戏，还要核显有什么用？</p>
<p>这种方案下，厂商直接硬件切断了核显的供电，以将供电全部分配给 CPU 和独显，取得更好的性能。实际上和台式机的架构没什么区别。</p>
<ul>
<li>优点：
<ul>
<li>高性能，游戏渲染延迟小（独显直通显示器，核显不会和 CPU 和独显抢电）</li>
<li>省钱（没有复杂的切换电路）</li>
</ul>
</li>
<li>缺点：
<ul>
<li>费电（独显需要一直开着）
<ul>
<li>但你买几万块钱的游戏本估计也不关心续航了。</li>
</ul>
</li>
<li>对显卡直通的毁灭性打击
<ul>
<li>因为你只有一块显卡，一旦直通进虚拟机，你的主系统就没有显卡可用了。</li>
<li>如果你要坚持进行直通，你需要自己编写显卡在虚拟机和主机之间切换的脚本，并且需要准备一种方法在失去显示的时候进行调试。</li>
<li>艺高人胆大的可以上。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>如何判断我的电脑是哪一种结构：</p>
<p>在你电脑的 Linux 系统中运行 <code>lspci</code>，查找有关 Intel HD Graphics 和 NVIDIA
的设备。</p>
<ul>
<li>如果独显设备名以 <code>3D Controller</code> 开头，那你的电脑就是第一种 Optimus 架构（核显直连显示器）。</li>
<li>如果独显设备名以 <code>VGA Controller</code> 开头，并且有一个 <code>HD Graphics</code> 核显，那你的电脑是第二种 Optimus 架构（核显、独显切换）。</li>
<li>如果独显设备名以 <code>VGA Controller</code> 开头，并且没有 <code>HD Graphics</code> 核显，那你的电脑是第三种屏蔽核显的架构。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="我的系统环境">我的系统环境</h2>
<p>本文中我使用的电脑及系统环境如下：</p>
<ul>
<li>联想拯救者 R720-15IKBN 笔记本电脑（i7-7700HQ，GTX 1050）
<ul>
<li>属于第一种的 Optimus MUXless 架构，核显直连显示器</li>
</ul>
</li>
<li>宿主系统使用 Arch Linux，并更新到写本文时的最新版本</li>
<li>虚拟机软件使用 QEMU，并且安装 Libvirt 及 Virt-Manager 进行图形化管理</li>
<li>虚拟机内使用 Windows 10 LTSC 2019</li>
</ul>
<p>目标如下：</p>
<ul>
<li>创建一个 Intel 的 GVT-g 虚拟核显，将其直通进虚拟机
<ul>
<li>因为是虚拟显卡，宿主系统仍可正常显示图像</li>
</ul>
</li>
<li>在宿主系统上禁用 NVIDIA 独显，将其完全交由虚拟机管理</li>
</ul>
<p>开始以下步骤前，你需要准备这些东西：</p>
<ul>
<li>一个装好 Windows 10 系统的 QEMU（Libvirt）虚拟机
<ul>
<li>使用 UEFI（OVMF）启动，用 BIOS 方式（SeaBIOS）不一定能成功</li>
<li>配置有 QXL 虚拟显卡</li>
</ul>
</li>
<li>一个能在宿主机上启动的 Windows 系统
<ul>
<li>可以是双系统，Windows To Go 等</li>
<li>Windows PE 或许也可以，只要能打开设备管理器即可</li>
</ul>
</li>
<li>宿主机使用 Intel 核显显示内容，独显要么被禁用，要么驱动被卸载
<ul>
<li>否则无法完成直通 GVT-g 虚拟显卡（Virt-Manager 会闪退）</li>
<li>也无法完成直通独显（因为独显被宿主系统占用了）</li>
</ul>
</li>
</ul>
<p>重要的提示：</p>
<ul>
<li>整个步骤中会多次重启宿主系统，同时一些操作可能导致宿主系统崩溃，请保存好你的数据</li>
<li>整个步骤中你不需要手动下载任何显卡驱动，交给 Windows 自动下载就好
<ul>
<li>如果 Windows 自动下载失败，手动安装驱动的底线是下载驱动 EXE 然后双击安装</li>
<li>千万不要在设备管理器中手动指定设备安装</li>
<li>手动安装显卡驱动有时反而会干扰判断</li>
</ul>
</li>
</ul>
<h2 id="禁止宿主系统管理-nvidia-独显">禁止宿主系统管理 NVIDIA 独显</h2>
<p>宿主系统上的 NVIDIA 的驱动会占用独显，阻止虚拟机调用它，因此需要先用 PCIe 直通用的 <code>vfio-pci</code> 驱动替换掉它。</p>
<p>即使你不需要直通独显，你仍然需要一种方法把宿主系统的图形显示调整到核显上，否则后续直通核显时 Virt-Manager 会崩溃。你可以用这里的方法禁用 NVIDIA 驱动，或者使用
<code>optimus-manager</code> 等软件进行管理。</p>
<p>禁用 NVIDIA 驱动，把独显交给处理虚拟机 PCIe 直通的内核模块管理的步骤如下：</p>
<ol>
<li>
<p>运行 <code>lspci -nn | grep NVIDIA</code>，获得类似如下输出：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">01:00.0</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 3D</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> controller</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> [0302]: NVIDIA Corporation GP107M [GeForce GTX </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">1050</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> Mobile] [10de:1c8d] (</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">rev</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> a1</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span></code></pre>
<p>这里的 <code>[10de:1c8d]</code> 就是独显的制造商 ID 和设备 ID，其中 <code>10de</code> 代表这个 PCIe
设备由 NVIDIA 生产，而 <code>1c8d</code> 代表这是张 1050。</p>
</li>
<li>
<p>创建 <code>/etc/modprobe.d/lantian.conf</code>，添加如下内容：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">options</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio-pci</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ids=10de:1c8d</span></span></code></pre>
<p>给 <code>vfio-pci</code> 这个负责 PCIe 直通的内核驱动一个配置，让它去管理独显。<code>ids</code> 参数就是要直通的独显的制造商 ID 和设备 ID。</p>
</li>
<li>
<p>修改 <code>/etc/mkinitcpio.conf</code>，在 <code>MODULES</code> 中添加以下内容：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">MODULES</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=(</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">vfio_pci</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio_iommu_type1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio_virqfd</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span></code></pre>
<p>并且删除 <code>nvidia</code> 等与 NVIDIA 驱动相关的内核模块。</p>
<p>这样 PCIe 直通模块就会在系统启动的早期抢占独显，阻止 NVIDIA 驱动后续占用。</p>
</li>
<li>
<p>运行 <code>mkinitcpio -P</code> 更新 initramfs。</p>
</li>
<li>
<p>重启电脑。</p>
<ul>
<li>你也可以等到配置完核显直通的第一步后再重启。</li>
</ul>
</li>
</ol>
<h2 id="配置-intel-gvt-g-虚拟核显">配置 Intel GVT-g 虚拟核显</h2>
<p>还记得前面提到的上万的 NVIDIA GRID 显卡吗？在使用那些显卡时，显卡驱动本身支持虚拟出多个显卡分别分配给不同虚拟机，就像 CPU 的虚拟化技术一样。</p>
<p>与 NVIDIA 不同，Intel 的 5 代及之后的 CPU 自带的核显都直接支持了这个功能，不需要额外花钱去购买昂贵的计算卡了。虽然核显本身性能非常弱鸡，但是相比 QXL 等方案，它至少能让虚拟机内可以流畅的完成浏览网页等工作。</p>
<p>同时 Intel 核显直通配置相对简单，可以作为练习。</p>
<ol>
<li>
<p>启用 GVT-g 所需的内核配置，加载对应的内核模块</p>
<ul>
<li>
<p>编辑你的内核参数（如果你使用 Systemd-boot，在类似
<code>/boot/loader/entries/arch.conf</code> 的位置），添加如下内容：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">i915.enable_gvt</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">=1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> kvm.ignore_msrs=</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> intel_iommu=on</span></span></code></pre>
</li>
<li>
<p>编辑 <code>/etc/modules-load.d/lantian.conf</code>，添加如下三行内容：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">kvmgt</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">vfio-iommu-type1</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">vfio-mdev</span></span></code></pre>
<p>这三行对应了需要加载的内核模块。</p>
</li>
<li>
<p>重启。</p>
</li>
</ul>
</li>
<li>
<p>创建虚拟显卡</p>
<ul>
<li>
<p>运行 <code>lspci | grep "HD Graphics"</code> 查找核显的 PCIe 总线位置编号，例如我的电脑上输出如下：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">00:02.0</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> VGA</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> compatible</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> controller:</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Intel</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Corporation</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> HD</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Graphics</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 630</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> (rev </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">04</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span></code></pre>
<p>代表核显的总线位置是 <code>00:02.0</code>。</p>
</li>
<li>
<p>运行以下命令创建虚拟显卡：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 需要以 root 身份执行</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">sudo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> su</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">echo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "af5972fb-5530-41a7-0000-fd836204445b"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> > </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"/sys/devices/pci0000:00/0000:00:02.0/mdev_supported_types/i915-GVTg_V5_4/create"</span></span></code></pre>
<p>其中注意替换核显的 PCIe 编号，以及可以替换传入的 UUID。</p>
<p>另外，每次系统重启后，你都需要在启动虚拟机之前手动运行这条命令。你也可以把这条命令加入 <code>/etc/rc.local</code>，在开机时自动添加虚拟显卡。虚拟机不运行时，虚拟显卡是不影响性能的。</p>
</li>
</ul>
</li>
<li>
<p>修改虚拟机配置，让虚拟显卡对虚拟机可见</p>
<ul>
<li>
<p>运行 <code>virsh edit Win10</code>，其中 <code>Win10</code> 是你的虚拟机名，在 <code>&#x3C;/devices></code> 前加入以下内容：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'subsystem'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'mdev'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'vfio-pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> display</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> uuid</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'af5972fb-5530-41a7-0000-fd836204445b'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span></code></pre>
<p>注意替换里面的 UUID，和上一步的一致。同时这里的 <code>display</code> 的值是 <code>off</code>，目前是正常的。</p>
</li>
<li>
<p>注意先不要删掉 QXL 显卡。</p>
</li>
<li>
<p>启动虚拟机，打开设备管理器，应该会多出一个 <code>Microsoft 基本显示适配器</code>。</p>
</li>
<li>
<p>把虚拟机连上网，等一会，系统会自动装好 Intel 的核显驱动，开始菜单里会出现
Intel 控制面板。</p>
<ul>
<li>如果等了很长时间系统还没有装好驱动，可以去 Intel 官网下载核心显卡的驱动（就是普通那个），然后拷进虚拟机尝试安装。</li>
<li>如果安装失败，代表你操作出了问题，或者虚拟机软件有 Bug。</li>
</ul>
</li>
<li>
<p>驱动安装成功后，虚拟机已经看到了 Intel 显卡，但是因为当前的显示器显示的是
QXL 显卡的图像，Intel 显卡不是主显卡，因此 Windows 还没有把任何程序放到上面运行。</p>
<ul>
<li>下一步就要禁用 QXL 显卡了。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>关闭虚拟机，再次修改虚拟机配置：</p>
<ul>
<li>
<p>在上面添加的这个 <code>&#x3C;hostdev></code> 中，把 <code>display='off'</code> 改成 <code>display='on'</code></p>
</li>
<li>
<p>删除 <code>&#x3C;graphics>...&#x3C;/graphics></code> 和 <code>&#x3C;video>...&#x3C;/video></code> 的所有内容，用如下内容替换：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spice'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">listen</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'none'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">image</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> compression</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">gl</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enable</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'none'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span></code></pre>
</li>
<li>
<p>在 <code>&#x3C;/domain></code> 之前添加如下内容：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.ramfb=on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.driver=vfio-pci-nohotplug'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.x-igd-opregion=on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.xres=1920'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.yres=1080'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.romfile=/vbios_gvt_uefi.rom'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:env</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'MESA_LOADER_DRIVER_OVERRIDE'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'i965'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span></code></pre>
<p>其中 <code>vbios_gvt_uefi.rom</code> 从
<a href="http://120.25.59.132:3000/vbios_gvt_uefi.rom" rel="noopener noreferrer" target="_blank">http://120.25.59.132:3000/vbios_gvt_uefi.rom</a>
下载，或者<a href="/usr/uploads/202007/vbios_gvt_uefi.rom">从本站下载</a>，放在根目录下。如果移动了位置，也要对应修改 <code>romfile</code> 参数。</p>
</li>
<li>
<p>把整个文件第一行的 <code>&#x3C;domain type='kvm'></code> 改成
<code>&#x3C;domain type='kvm' xmlns:qemu='http://libvirt.org/schemas/domain/qemu/1.0'></code>。</p>
</li>
</ul>
</li>
<li>
<p>重新启动虚拟机，应该有正常的图像显示，此时虚拟机就开始使用 GVT-g 虚拟显卡了。</p>
</li>
</ol>
<h2 id="配置-nvidia-独显直通">配置 NVIDIA 独显直通</h2>
<p>在前面的步骤中，宿主系统的 NVIDIA 官方驱动已经被禁用，独显现在由主管 PCIe 直通的
<code>vfio-pci</code> 驱动管理。</p>
<p>将显卡直通进虚拟机本身是个简单的操作，但是丧心病狂的 NVIDIA 为了收钱，在驱动程序上做了很多限制：</p>
<ul>
<li>显卡必须连接在正确的 PCIe 总线位置上。</li>
<li>系统不能有明显的虚拟机特征。</li>
<li>系统必须有电池。</li>
<li>系统的 ACPI 表中必须能找得到显卡 BIOS。</li>
<li>等等……</li>
</ul>
<p>因此我们必须一步步绕过这些坑。</p>
<blockquote>
<p>2022-01-22 更新：</p>
<p><a href="https://nvidia.custhelp.com/app/answers/detail/a_id/5173" rel="noopener noreferrer" target="_blank">从 465 版本开始，NVIDIA 解除了大部分的限制</a>，理论上来说现在直接把显卡直通进虚拟机就能用。</p>
<p>但也只是理论上而已。</p>
<p>我依然建议大家做完所有的隐藏虚拟机的步骤，因为：</p>
<ol>
<li>
<p>对于笔记本电脑来说，NVIDIA 并没有解除所有的限制。</p>
<ul>
<li>至少在我测试时，显卡的 PCIe 总线位置和系统是否存在电池依然会导致直通失败、驱动报错代码 43。</li>
</ul>
</li>
<li>
<p>即使 NVIDIA 驱动不检测虚拟机，你运行的程序也会检测虚拟机，隐藏虚拟机特征可以提高成功运行这些程序的概率。</p>
<ul>
<li>典型例子包括带有反作弊系统的网游，或者部分需要联网激活的商业软件。</li>
</ul>
</li>
<li>
<p>由于 Optimus MUXless 的架构限制，你仍然需要修改 UEFI 固件，以让虚拟机内的显卡驱动能够读取 GPU vBIOS.</p>
</li>
</ol>
</blockquote>
<ol>
<li>
<p>首先把宿主机重启到 Windows 系统，做如下事情：</p>
<ul>
<li>（可选）下载一个 GPU-Z，导出显卡的 BIOS 备用。</li>
<li>进入设备管理器，找到你的显卡，查看它的硬件 ID，类似
<code>PCI\VEN_10DE&#x26;DEV_1C8D&#x26;SUBSYS_39D117AA&#x26;REV_A1</code>，记录下来备用。</li>
</ul>
</li>
<li>
<p>然后重启回 Linux。如果你上面一步没有导出显卡的 BIOS，这里你也可以使用
<code>VBiosFinder</code> 软件，从电脑的 BIOS 更新中提取显卡 BIOS 内容。</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 下载 VBiosFinder</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> clone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/coderobe/VBiosFinder.git</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 去你电脑的技术支持网站下载 BIOS 更新，一般是一个 EXE 程序。</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 我的 BIOS 更新名为 BIOS-4KCN45WW.exe，如果有不同注意替换</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">mv</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> BIOS-4KCN45WW.exe</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> VBiosFinder/</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 安装依赖</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pikaur</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -S</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ruby</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ruby-bundler</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> innoextract</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> p7zip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> upx</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 安装 rom-parser</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> clone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/awilliam/rom-parser.git</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> rom-parser</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">make</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">mv</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> rom-parser</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ../VBiosFinder/3rdparty</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ..</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 安装 UEFIExtract</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> clone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/LongSoft/UEFITool.git</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -b</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> new_engine</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> UEFITool</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">./unixbuild.sh</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">mv</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> UEFIExtract/UEFIExtract</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ../VBiosFinder/3rdparty</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ..</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 开始提取显卡 BIOS</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> VBiosFinder</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">bundle</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> update</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> --bundler</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">bundle</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> install</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> --path=vendor/bundle</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">./vbiosfinder</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> extract</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> BIOS-4KCN45WW.exe</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">ls</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> output</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># output 文件夹内有几个命名类似如下的文件：</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - vbios_10de_1c8c.rom</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - vbios_10de_1c8d.rom</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - vbios_10de_1c8e.rom</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - ...</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 找到对应显卡制造商 ID 和设备 ID 的文件，就是你的显卡 BIOS。</span></span></code></pre>
</li>
<li>
<p>然后把显卡 BIOS 添加到虚拟机的 UEFI 固件（即 OVMF）中。</p>
<p>在 Optimus 笔记本电脑上，NVIDIA 的驱动会去系统的 ACPI 表中查找显卡的 BIOS，并将其加载到显卡上，而 ACPI 表由 UEFI 固件管理。因此需要修改 UEFI 固件添加显卡
BIOS。</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 根据 GitHub 上用户反馈，UEFI 固件编译完成后不能移动位置</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 所以要先找好存放的地方</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /opt</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> clone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/tianocore/edk2.git</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 安装编译过程中需要的依赖</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pikaur</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -S</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> python2</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> iasl</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> nasm</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> subversion</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> perl-libwww</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vim</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> dos2unix</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> gcc5</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 假设你导出的显卡 BIOS 存放在 /vbios.rom</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> edk2/OvmfPkg/AcpiPlatformDxe</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">xxd</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /vbios.rom</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vrom.h</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 编辑 vrom.h，把 unsigned char 数组的名字修改成 VROM_BIN</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 把文件末尾的长度变量改名为 VROM_BIN_LEN，并记录下长度值，我的是 167936</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">wget</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/jscinoz/optimus-vfio-docs/files/1842788/ssdt.txt</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -O</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ssdt.asl</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 编辑 ssdt.asl，修改第 37 行为 VROM_BIN_LEN 的值</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 然后执行下面这行命令，会报错但是没关系，只要 Ssdt.aml 有了就行</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">iasl</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -f</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ssdt.asl</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">xxd</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -c1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Ssdt.aml</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">tail</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -n</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> +37</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cut</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -f2</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -d</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">' '</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">paste</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -sd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">' '</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">sed</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 's/ //g'</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">xxd</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -r</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -p</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> > </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">vrom_table.aml</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">xxd</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vrom_table.aml</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">sed</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 's/vrom_table_aml/vrom_table/g'</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> > </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">vrom_table.h</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 返回 edk2 的目录下打补丁</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ../..</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">wget</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://gist.github.com/jscinoz/c43a81882929ceaf7ec90afd820cd470/raw/139799c87fc806a966250e5686e15a28676fc84e/nvidia-hack.diff</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">patch</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -p1</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> &#x3C; </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">nvidia-hack.diff</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 开始编译 OVMF</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">make</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -C</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> BaseTools</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">.</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ./edksetup.sh</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> BaseTools</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 修改 Conf/target.txt 中如下变量的值：</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - ACTIVE_PLATFORM       = OvmfPkg/OvmfPkgX64.dsc</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - TARGET_ARCH           = X64</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - TOOL_CHAIN_TAG        = GCC5</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">build</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 等待编译完成，确认 Build/OvmfX64/DEBUG_GCC5/FV 文件夹下有这两个文件：</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - OVMF_CODE.fd</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - OVMF_VARS.fd</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 然后替换你的虚拟机的 UEFI 参数，注意修改虚拟机名</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cp</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Build/OvmfX64/DEBUG_GCC5/FV/OVMF_VARS.fd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /var/lib/libvirt/qemu/nvram/Win10_VARS.fd</span></span></code></pre>
</li>
<li>
<p>编辑你的虚拟机配置，<code>virsh edit Win10</code>，做如下修改：</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&#x3C;!-- 把 os 一段改成这样，注意对应你的 OVMF_CODE.fd 路径 --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> arch</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'x86_64'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> machine</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pc-q35-4.2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">hvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> readonly</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pflash'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/opt/edk2/Build/OvmfX64/DEBUG_GCC5/FV/OVMF_CODE.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/var/lib/libvirt/qemu/nvram/Win10_VARS.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&#x3C;!-- 把 features 一段改成这样，就是让 QEMU 隐藏虚拟机的特征 --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">acpi</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">apic</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">relaxed</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vapic</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">spinlocks</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> retries</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'8191'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vendor_id</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'GenuineIntel'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hidden</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vmport</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&#x3C;!-- 添加显卡直通的 PCIe 设备，必须放在核显 hostdev 的后面 --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'subsystem'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">rom</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bar</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &#x3C;!-- 注意这里的 PCIe 总线地址必须是 01:00.0，一点都不能差 --></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &#x3C;!-- 如果保存时提示 PCIe 总线地址冲突，就把其它设备的 &#x3C;address> 全部删掉 --></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &#x3C;!-- 这样 Libvirt 会重新分配一遍 PCIe 地址 --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&#x3C;!-- 在 &#x3C;/qemu:commandline> 之前添加这些参数 --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-vendor-id=0x10de'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-device-id=0x1c8d'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-sub-vendor-id=0x17aa'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-sub-device-id=0x39d1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-acpitable'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'file=/ssdt1.dat'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span></code></pre>
<p>此处的 ID 对应之前从设备管理器里查出的硬件
ID，<code>PCI\VEN_10DE&#x26;DEV_1C8D&#x26;SUBSYS_39D117AA&#x26;REV_A1</code>，请注意对应替换。</p>
<p>此处的 ssdt1.dat 对应如下 Base64，可以用
<a href="https://base64.guru/converter/decode/file" rel="noopener noreferrer" target="_blank">Base64 解码网站</a>转换成二进制文件，放在根目录，或者<a href="/usr/uploads/202007/ssdt1.dat">从本站下载</a>。如果移动了，需要对应修改上面的 file 参数。这也是一个修改后的 ACPI 表，用来模拟一块满电的电池，只不过不需要合并到 OVMF 里，而是直接用参数加载就可以。</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">U1NEVKEAAAAB9EJPQ0hTAEJYUENTU0RUAQAAAElOVEwYEBkgoA8AFVwuX1NCX1BDSTAGABBMBi5f</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">U0JfUENJMFuCTwVCQVQwCF9ISUQMQdAMCghfVUlEABQJX1NUQQCkCh8UK19CSUYApBIjDQELcBcL</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">cBcBC9A5C1gCCywBCjwKPA0ADQANTElPTgANABQSX0JTVACkEgoEAAALcBcL0Dk</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span></span></code></pre>
<p><strong>以上步骤，缺一不可，否则代码 43（驱动程序加载失败）欢迎你。</strong></p>
</li>
<li>
<p>启动虚拟机，等一会，Windows 10 会自动装好 NVIDIA 驱动。</p>
<ul>
<li>如果设备管理器里显卡打感叹号，显示代码 43，即驱动程序加载失败，你需要 <del>干南桥</del> <del>干显存</del> <del>干核心</del> 检查上面的步骤有没有遗漏，所有配置是否正确。
<ul>
<li>将设备管理器切换到 <code>Device by Connection</code>（按照连接方式显示设备），确认显卡的地址是总线 Bus 1，接口 Slot 0，功能 Function 0，并且确认显卡上级的
PCIe 接口是总线 Bus 0，接口 Slot 1，功能 Function 0。</li>
<li>是的，NVIDIA 驱动的检查就是这么严格。</li>
<li>如果对不上，你需要按上面的方法重新分配一遍设备的 PCIe 地址。</li>
</ul>
</li>
<li>如果系统没有自动安装 NVIDIA 驱动，并且你手动下载的也显示系统不兼容/找不到显卡，那么你需要查看显卡的属性，其硬件 ID 是否与宿主机上查看到的一致。</li>
<li>即使显卡正常工作了，你依然打不开 NVIDIA 控制面板（显示未连接显示器），这是正常现象。</li>
</ul>
</li>
</ol>
<h2 id="下一步呢">下一步呢？</h2>
<p>即使你配置完了上面的所有步骤，核显和独显都在虚拟机里正常工作了，对玩游戏的帮助也不大：</p>
<ul>
<li>由于 Windows 认为主显示器连接在 GVT-g 虚拟核显上，系统会把所有 3D 应用交给性能孱弱的核显来渲染。
<ul>
<li>如果你没直通 GVT-g 虚拟核显，那就是主显示器连接在 QXL 上。</li>
<li>例外：根据反馈部分虚幻引擎游戏会自动检测并主动调用独显。</li>
</ul>
</li>
<li>由于 MUXless Optimus 独显没有直连显示器，因此无法以任意方式指定独显为主显示卡。</li>
<li>Intel GVT-g 虚拟核显与 NVIDIA 独显无法正常组成 Optimus，因此 NVIDIA 驱动也不会主动把游戏调到独显上渲染。</li>
<li>如果你只留 NVIDIA 一块显卡，虽然 Windows 会把渲染放在独显上（没得选了），但分辨率会被限制到 640x480，同时你就必须依赖远程桌面玩游戏了。</li>
</ul>
<p>因此目前 Optimus 显卡直通的炫技成分更大于实用。如果你是驱动开发大佬，可以从以下几个方向进行研究：</p>
<ol>
<li>让 Intel GVT-g 虚拟核显和 NVIDIA 独显正常组成 Optimus</li>
<li>让 QXL 和 NVIDIA 独显组成 Optimus</li>
<li>魔改 NVIDIA 驱动加一个虚拟显示器</li>
</ol>
<h2 id="资料来源">资料来源</h2>
<p>感谢前人在显卡直通上做出的努力，没有他们的努力本文不可能存在。</p>
<p>以下是我配置时参考的资料：</p>
<ul>
<li>Intel GVT-g 虚拟显卡
<ul>
<li>Arch Linux Wiki
<a href="https://wiki.archlinux.org/index.php/Intel_GVT-g" rel="noopener noreferrer" target="_blank">https://wiki.archlinux.org/index.php/Intel_GVT-g</a></li>
<li>Gentoo Wiki / Shunlir 的虚拟机配置
<a href="https://wiki.gentoo.org/wiki/User:Shunlir/Intel_GVT-g#Install_Intel_driver_in_Guest" rel="noopener noreferrer" target="_blank">https://wiki.gentoo.org/wiki/User:Shunlir/Intel_GVT-g#Install_Intel_driver_in_Guest</a></li>
</ul>
</li>
<li>NVIDIA 独显直通
<ul>
<li>GitHub Misairu-G 的 NVIDIA Optimus MUXed 直通教程
<a href="https://gist.github.com/Misairu-G/616f7b2756c488148b7309addc940b28" rel="noopener noreferrer" target="_blank">https://gist.github.com/Misairu-G/616f7b2756c488148b7309addc940b28</a></li>
<li>GitHub jscinoz 的 Optimus MUXless 直通研究
<a href="https://github.com/jscinoz/optimus-vfio-docs" rel="noopener noreferrer" target="_blank">https://github.com/jscinoz/optimus-vfio-docs</a></li>
<li>GitHub arne-claeys 的 OVMF 补丁和相关讨论
<a href="https://github.com/jscinoz/optimus-vfio-docs/issues/2" rel="noopener noreferrer" target="_blank">https://github.com/jscinoz/optimus-vfio-docs/issues/2</a></li>
<li>Reddit VFIO 版块的资料整理
<a href="https://www.reddit.com/r/VFIO/comments/8gv60l/current_state_of_optimus_muxless_laptop_gpu/" rel="noopener noreferrer" target="_blank">https://www.reddit.com/r/VFIO/comments/8gv60l/current_state_of_optimus_muxless_laptop_gpu/</a></li>
<li>Reddit VFIO 版块的虚拟电池补丁
<a href="https://www.reddit.com/r/VFIO/comments/ebo2uk/nvidia_geforce_rtx_2060_mobile_success_qemu_ovmf/" rel="noopener noreferrer" target="_blank">https://www.reddit.com/r/VFIO/comments/ebo2uk/nvidia_geforce_rtx_2060_mobile_success_qemu_ovmf/</a></li>
</ul>
</li>
</ul>
<h2 id="附录最终-libvirt-xml-文件">附录：最终 Libvirt XML 文件</h2>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">domain</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'kvm'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:qemu</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'http://libvirt.org/schemas/domain/qemu/1.0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">name</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">Win10</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">name</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">uuid</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">6f0e09e1-a7d4-4d33-b4f8-0dc69eaaed9b</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">uuid</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">metadata</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">libosinfo:libosinfo</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:libosinfo</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"http://libosinfo.org/xmlns/libvirt/domain/1.0"</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">libosinfo:os</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> id</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"http://microsoft.com/win/10"</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">libosinfo:libosinfo</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">metadata</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memory</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'KiB'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">4194304</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memory</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">currentMemory</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'KiB'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">4194304</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">currentMemory</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vcpu</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> placement</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'static'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">8</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vcpu</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> arch</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'x86_64'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> machine</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pc-q35-4.2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">hvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> readonly</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pflash'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/opt/edk2/Build/OvmfX64/DEBUG_GCC5/FV/OVMF_CODE.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/var/lib/libvirt/qemu/nvram/Win10_VARS.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">acpi</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">apic</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">relaxed</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vapic</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">spinlocks</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> retries</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'8191'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vendor_id</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'GenuineIntel'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hidden</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vmport</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cpu</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'host-model'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> check</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'partial'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">topology</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> sockets</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dies</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> cores</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'4'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> threads</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cpu</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">clock</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> offset</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'localtime'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'rtc'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> tickpolicy</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'catchup'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pit'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> tickpolicy</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'delay'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'hpet'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> present</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'hypervclock'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> present</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">clock</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_poweroff</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">destroy</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_poweroff</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_reboot</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">restart</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_reboot</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_crash</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">destroy</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_crash</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">pm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">suspend-to-mem</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enabled</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">suspend-to-disk</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enabled</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">pm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">devices</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">emulator</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/usr/bin/qemu-system-x86_64</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">emulator</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'file'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> device</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'disk'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">driver</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'qemu'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'raw'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> file</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/var/lib/libvirt/images/Win10.img'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dev</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'vda'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">boot</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> order</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x07'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'file'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> device</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'cdrom'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">driver</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'qemu'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'raw'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> file</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/mnt/files/LegacyOS/Common/virtio-win-0.1.141.iso'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dev</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'sda'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'sata'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">readonly</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">boot</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> order</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'drive'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> controller</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> target</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'qemu-xhci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> ports</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'15'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x04'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'sata'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x1f'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x10'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x11'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'3'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'3'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x12'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'4'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'4'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x13'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x3'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'5'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'5'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x14'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x4'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'6'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'6'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x15'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x5'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'7'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'7'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x8'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x6'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'8'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'8'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x9'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x7'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'9'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-to-pci-bridge'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-pci-bridge'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x02'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'10'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'10'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0xa'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x03'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'11'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'11'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0xb'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x03'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio-serial'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x05'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'scsi'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio-scsi'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x06'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">interface</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'bridge'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">mac</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> address</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'52:54:00:b0:65:5a'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bridge</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'br0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x03'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">interface</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">serial</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pty'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'isa-serial'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">        &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'isa-serial'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">serial</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">console</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pty'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'serial'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">console</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">channel</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spicevmc'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'com.redhat.spice.0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio-serial'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> controller</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">channel</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'tablet'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'mouse'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'ps2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'keyboard'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'ps2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spice'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">listen</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'none'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">image</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> compression</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">gl</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enable</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">sound</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'ich9'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x1b'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">sound</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'none'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'subsystem'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'mdev'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'vfio-pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> display</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">        &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> uuid</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'af5972fb-5530-41a7-0000-fd836204445b'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0a'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'subsystem'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">        &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">rom</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bar</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spicevmc'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spicevmc'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'3'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memballoon</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x08'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memballoon</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">devices</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.ramfb=on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.driver=vfio-pci-nohotplug'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.x-igd-opregion=on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.xres=1920'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.yres=1080'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.romfile=/vbios_gvt_uefi.rom'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-vendor-id=0x10de'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-device-id=0x1c8d'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-sub-vendor-id=0x17aa'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-sub-device-id=0x39d1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-acpitable'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'file=/ssdt1.dat'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:env</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'MESA_LOADER_DRIVER_OVERRIDE'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'i965'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">domain</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span></code></pre>  </div>  <div class="clearfix" id="post-navi" data-astro-cid-gfbmwgei=""> <div class="float-end text-end" data-astro-cid-gfbmwgei=""> <a href="/article/one-pic/if-you-wanna-take-the-bite.lantian/" title="愿者上钩（指美国签证）" data-astro-cid-gfbmwgei=""> 愿者上钩（指美国签证） </a> <br data-astro-cid-gfbmwgei=""> 下一篇文章 »
</div> <div class="float-start text-start position-absolute" data-astro-cid-gfbmwgei="">
« 上一篇文章 <br data-astro-cid-gfbmwgei=""> <a href="/article/modify-website/an-elegant-scripture-of-safety-generator.lantian/" title="制作一个优雅的平安经生成器" data-astro-cid-gfbmwgei=""> 制作一个优雅的平安经生成器 </a> </div> </div>  <div id="waline" data-waline-language="zh-CN" data-waline-path="/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian"></div> <script type="module" src="/assets/WalineComment.astro_astro_type_script_index_0_lang.Dqib3X1E.js"></script>  </div> </div> </article>  </div> <aside class="d-none d-xl-block"> <section class="widget"> <h3>最新文章</h3> <ul class="list-unstyled"> <li> 07-20  <a href="/article/modify-computer/legal-lte-network-at-home-with-open5gs.lantian/">用 Open5GS 搭建合法的 LTE 网络</a> </li><li> 06-27  <a href="/article/modify-computer/sidestore-without-stosvpn-across-lan.lantian/">在内网中免 StosVPN 使用 SideStore</a> </li><li> 05-19  <a href="/article/modify-computer/nix-logarithmetic-math-library-from-zero.lantian/">从零开始实现 Nix 对数函数库</a> </li><li> 04-06  <a href="/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/">$100，DIY 搭建合法的 LTE 网络</a> </li><li> 02-10  <a href="/article/modify-computer/build-custom-android-kernel-with-nix.lantian/">用 Nix 编译自定义 Android 内核</a> </li><li> 04-20  <a href="/article/modify-website/migrate-blog-to-astro-js.lantian/">使用 Astro.js 重构我的博客</a> </li><li> 12-16  <a href="/article/modify-computer/nixos-low-ram-vps.lantian/">NixOS 系列（五）：制作小内存 VPS 的 DD 磁盘镜像</a> </li><li> 09-20  <a href="/article/modify-computer/nix-trigonometric-math-library-from-zero.lantian/">从零开始实现 Nix 三角函数库</a> </li><li> 05-29  <a href="/article/random-notes/pipewire-sigkill-fix.lantian/">解决 Pipewire 被 SIGKILL 的问题</a> </li><li> 05-12  <a href="/article/modify-website/how-to-kill-the-dn42-network.lantian/">如何引爆 DN42 网络（2023-05-12 更新）</a> </li><li> 05-08  <a href="/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/">Optimus MUXed 笔记本上的 NVIDIA 虚拟机显卡直通（2023-05 更新）</a> </li><li> 04-17  <a href="/article/random-notes/fix-china-telecom-roaming-no-4g-on-aosp-rom.lantian/">修改 APN 解决 AOSP ROM 上中国电信无法 4G 漫游问题</a> </li><li> 03-26  <a href="/article/random-notes/old-hp-workstation-as-all-in-one.lantian/">老款 HP 工作站配置 NAS+软路由笔记</a> </li><li> 01-14  <a href="/article/modify-computer/nixos-impermanence.lantian/">NixOS 系列（四）：“无状态”操作系统</a> </li><li> 06-21  <a href="/article/modify-computer/nixos-packaging.lantian/">NixOS 系列（三）：软件打包，从入门到放弃</a> </li> </ul> </section> <section class="widget"> <h3>最新评论</h3> <ul class="list-unstyled" id="recent-comments">  <li><a href="#">Loading...</a></li>  </ul> </section> <script type="module">const i=window.location.hostname=="localhost"?"https://comments.lantian.pub":window.location.origin;fetch(`${i}/api/comment?type=recent&count=10`).then(t=>{if(t.status!==200)throw new Error(`Server returned bad HTTP status ${t.status}`);return t.json()}).then(t=>{const e=document.getElementById("recent-comments");e&&(e.innerHTML=t.data.map(n=>{const o=n.comment.replace(/(<([^>]+)>)/gi,"");return"<li>"+n.nick+' <a href="'+n.url+'">'+o+"</a></li>"}).join(""))});</script> <section class="widget"> <h3>其它功能</h3> <ul class="list-unstyled">  <li> <i class="fas fa-fw fa-rss"></i>  <a href="/rss2.xml" target="_blank">RSS 订阅</a> |  <a href="/feed.xml" target="_blank">Atom</a> |  <a href="/feed.json" target="_blank">JSON</a> </li> <li> <i class="fas fa-fw fa-globe"></i>  <a href="https://stats.uptimerobot.com/BLK6VsRkR" target="_blank"> 服务器状态 </a> </li> <li> <i class="fas fa-fw fa-sitemap"></i>  <a href="https://lg.lantian.pub" target="_blank">DN42 节点状态</a> </li> <li> <i class="fas fa-fw fa-link"></i>  <a href="gopher://lantian.pub" target="_blank">使用 Gopher 协议访问</a> </li>  </ul> </section> <section class="widget"> <h3>友情链接</h3> <ul class="list-unstyled"> <li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://0x7f.cc"> 0x7f Blog 🐑 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://alanyhq.com"> Alanyhq </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.cas7.moe"> Blog of Moecast </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://jerryxiao.cc"> JerryXiao </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://snli.org"> Shucheng Li </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://sangsir.com"> SangSir | 艺术界的一朵奇葩 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://yuetau.net"> YuetAu&#39;s Spot </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.baoshuo.ren/?utm_source=friends"> 宝硕博客 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="http://foreverblog.cn"> 十年之约 </a> </li> </ul> </section> </aside> </div> <footer class="lantian clearfix" data-astro-cid-w3csb3e3="">  <div id="copyright" class="float-end text-end" data-astro-cid-w3csb3e3=""> <i class="fas fa-copyright" data-astro-cid-w3csb3e3=""></i> 2012-2025 Lan Tian @ Blog<br data-astro-cid-w3csb3e3=""> <small data-astro-cid-w3csb3e3=""> 基于 Astro v5.15.1 构建 @ 2025-10-25 23:46:33 </small> </div> <script type="module">function v(c,o,r){const h=/^localhost$|^127(?:\.[0-9]+){0,2}\.[0-9]+$|^(?:0*:)*?:?0*1$/.test(location.hostname)||location.protocol==="file:";if(!o.trackLocalhost&&h)return console.warn("[Plausible] Ignoring event because website is running locally");try{if(window.localStorage.plausible_ignore==="true")return console.warn('[Plausible] Ignoring event because "plausible_ignore" is set to "true" in localStorage')}catch{}const p={n:c,u:o.url,d:o.domain,r:o.referrer,w:o.deviceWidth,h:o.hashMode?1:0,p:r&&r.props?JSON.stringify(r.props):void 0},s=new XMLHttpRequest;s.open("POST",`${o.apiHost}/api/event`,!0),s.setRequestHeader("Content-Type","text/plain"),s.send(JSON.stringify(p)),s.onreadystatechange=()=>{s.readyState===4&&r&&r.callback&&r.callback()}}function b(c){const o=()=>({hashMode:!1,trackLocalhost:!1,url:location.href,domain:location.hostname,referrer:document.referrer||null,deviceWidth:window.innerWidth,apiHost:"https://plausible.io",...c}),r=(t,n,i)=>{v(t,{...o(),...i},n)},h=(t,n)=>{r("pageview",n,t)};return{trackEvent:r,trackPageview:h,enableAutoPageviews:()=>{const t=()=>h(),n=history.pushState;return n&&(history.pushState=function(i,l,u){n.apply(this,[i,l,u]),t()},addEventListener("popstate",t)),c&&c.hashMode&&addEventListener("hashchange",t),h(),function(){n&&(history.pushState=n,removeEventListener("popstate",t)),c&&c.hashMode&&removeEventListener("hashchange",t)}},enableAutoOutboundTracking:(t=document,n={subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]})=>{function i(e){r("Outbound Link: Click",{props:{url:this.href}}),typeof process<"u"&&process,setTimeout(()=>{location.href=this.href},150),e.preventDefault()}const l=new Set;function u(e){e instanceof HTMLAnchorElement?e.host!==location.host&&(e.addEventListener("click",i),l.add(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(u)}function f(e){e instanceof HTMLAnchorElement?(e.removeEventListener("click",i),l.delete(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(f)}const d=new MutationObserver(e=>{e.forEach(a=>{a.type==="attributes"?(f(a.target),u(a.target)):a.type==="childList"&&(a.addedNodes.forEach(u),a.removedNodes.forEach(f))})});return t.querySelectorAll("a").forEach(u),d.observe(t,n),function(){l.forEach(a=>{a.removeEventListener("click",i)}),l.clear(),d.disconnect()}}}}const g=b({domain:"lantian.pub",trackLocalhost:!0,apiHost:""});g.trackPageview();</script> </footer>  </div>  </body> </html>