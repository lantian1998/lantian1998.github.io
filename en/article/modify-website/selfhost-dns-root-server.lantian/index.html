<!DOCTYPE html><html lang="en-US" itemscope="" itemtype="https://schema.org/Article" data-astro-cid-porej7z2=""> <head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Self-hosting a DNS Root Server - Lan Tian @ Blog</title><script>
  ;(() => {
    try {
      const mode = localStorage.getItem('user-color-scheme')
      if (mode == 'dark' || mode == 'light') {
        document.documentElement.setAttribute('data-user-color-scheme', mode)
      }
    } catch {
      // Ignore errors
    }
  })()
</script><link rel="stylesheet" href="/assets/index.CUlf1-Vz.css"><style>#post-navi[data-astro-cid-gfbmwgei]{padding:5px;border-top:1px solid var(--lt-border-weak);border-bottom:1px solid var(--lt-border-weak)}
ol[data-astro-cid-nj3qel45]{margin:0;padding:0;line-height:1.5}ol[data-astro-cid-nj3qel45] .toc-item[data-astro-cid-nj3qel45]{list-style:none}ol[data-astro-cid-nj3qel45] .toc-child[data-astro-cid-nj3qel45],ol[data-astro-cid-nj3qel45] .toc[data-astro-cid-nj3qel45]{padding:0}ol[data-astro-cid-nj3qel45] .toc-link[data-astro-cid-nj3qel45]{display:block;margin-left:1em;padding:.25em 0}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:1em;padding:.25em 0;float:left;font-style:normal;font-variant:normal;font-weight:900;font-family:Font Awesome\ 6 Free;font-feature-settings:normal;text-align:center}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before{content:""}ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{content:""}.post-info-wrap[data-astro-cid-dckccua4]{-ms-flex:0 0 2.5em;flex:0 0 2.5em;background-color:var(--lt-component-bg-emphasis)}@media(min-width:768px){.post-info[data-astro-cid-dckccua4]{position:sticky;top:0}}@media(max-width:767.98px){.post-info[data-astro-cid-dckccua4]{position:absolute}}
</style><script type="module" src="/assets/PageLayout.astro_astro_type_script_index_0_lang.C1wfUPs6.js"></script><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="imagemode" content="force"><meta name="nightmode" content="disable"><meta name="wap-font-scale" content="no"><meta name="title" content="Self-hosting a DNS Root Server - Lan Tian @ Blog"><meta name="keywords" content=""><meta name="author" content="Lan Tian"><link rel="canonical" href="https://lantian.pub/en/article/modify-website/selfhost-dns-root-server.lantian/"><link rel="alternate" type="application/rss+xml" title="Lan Tian @ Blog" href="https://lantian.pub/rss2.xml"><link rel="alternate" type="application/atom+xml" title="Lan Tian @ Blog" href="https://lantian.pub/feed.xml"><link rel="alternate" href="https://lantian.pub/article/modify-website/selfhost-dns-root-server.lantian/" hreflang="zh"><link rel="alternate" href="https://lantian.pub/en/article/modify-website/selfhost-dns-root-server.lantian/" hreflang="en"><meta name="copyright" content="Copyright 2012-2025 Lan Tian @ Blog"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="manifest" href="/manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#03a9f4"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#212121"><meta name="application-name" content="Lan Tian @ Blog"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-precomposed.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#03a9f4"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lan Tian @ Blog"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1170x2532.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2532x1170.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1179x2556.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2556x1179.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1284x2778.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2778x1284.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1290x2796.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2796x1290.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1488x2266.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2266x1488.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1640x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1640.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"><meta name="msapplication-TileColor" content="#bbdefb"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta name="msapplication-config" content="/browserconfig.xml"><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"><meta property="og:url" content="https://lantian.pub/en/article/modify-website/selfhost-dns-root-server.lantian/"><meta property="og:type" content="website"><meta property="og:title" content="Self-hosting a DNS Root Server - Lan Tian @ Blog"><meta property="og:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="With the scale of conflict between China and the United States increasing, on some social media websites in China, some users started expressing concerns for the United States cutting China's access to DNS root servers or removing China's domains in the root servers in order to break China's Internet. By now, there is much analysis on the matter that states that this is unlikely to happen. Most of them focus on the following two points: DNS root servers use Anycast to broadcast their IPs, and there are root servers present in China that won't be affected by the network cut; For the United States, shutting down root servers cause more trouble than benefit, both economically and politically. Yet today, I'm going to present another point:..."><meta property="og:site_name" content="Lan Tian @ Blog"><meta property="og:locale" content="en"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://lantian.pub/en/article/modify-website/selfhost-dns-root-server.lantian/"><meta name="twitter:title" content="Self-hosting a DNS Root Server - Lan Tian @ Blog"><meta property="twitter:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="With the scale of conflict between China and the United States increasing, on some social media websites in China, some users started expressing concerns for the United States cutting China's access to DNS root servers or removing China's domains in the root servers in order to break China's Internet. By now, there is much analysis on the matter that states that this is unlikely to happen. Most of them focus on the following two points: DNS root servers use Anycast to broadcast their IPs, and there are root servers present in China that won't be affected by the network cut; For the United States, shutting down root servers cause more trouble than benefit, both economically and politically. Yet today, I'm going to present another point:..."><meta name="twitter:dnt" content="on"><meta itemprop="name" content="Self-hosting a DNS Root Server - Lan Tian @ Blog"><meta property="image" content="https://lantian.pub/apple-touch-icon.png"><meta content="With the scale of conflict between China and the United States increasing, on some social media websites in China, some users started expressing concerns for the United States cutting China's access to DNS root servers or removing China's domains in the root servers in order to break China's Internet. By now, there is much analysis on the matter that states that this is unlikely to happen. Most of them focus on the following two points: DNS root servers use Anycast to broadcast their IPs, and there are root servers present in China that won't be affected by the network cut; For the United States, shutting down root servers cause more trouble than benefit, both economically and politically. Yet today, I'm going to present another point:..."><meta content="With the scale of conflict between China and the United States increasing, on some social media websites in China, some users started expressing concerns for the United States cutting China's access to DNS root servers or removing China's domains in the root servers in order to break China's Internet. By now, there is much analysis on the matter that states that this is unlikely to happen. Most of them focus on the following two points: DNS root servers use Anycast to broadcast their IPs, and there are root servers present in China that won't be affected by the network cut; For the United States, shutting down root servers cause more trouble than benefit, both economically and politically. Yet today, I'm going to present another point:..."><link rel="me" href="https://mastodon.social/@lantian"></head> <body data-astro-cid-porej7z2=""> <div id="bg" data-astro-cid-j6vmxtef=""></div>   <div id="container" class="container" data-astro-cid-porej7z2=""> <nav class="lantian navbar navbar-expand-lg" data-astro-cid-wu5dj4rx=""> <div class="container-fluid" data-astro-cid-wu5dj4rx=""> <a class="navbar-brand" href="/en/" data-astro-cid-wu5dj4rx="">Lan Tian @ Blog</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#lantian-navbar" aria-controls="lantian-navbar" aria-expanded="false" aria-label="Toggle navigation" data-astro-cid-wu5dj4rx=""> <span class="navbar-toggler-icon" data-astro-cid-wu5dj4rx=""></span> </button> <div class="collapse navbar-collapse" id="lantian-navbar" data-astro-cid-wu5dj4rx=""> <ul class="navbar-nav" data-astro-cid-wu5dj4rx=""> <li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> <li class="nav-item dropdown d-block d-lg-none" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="pages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-file" data-astro-cid-wu5dj4rx=""></i> Page  <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="pages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> </ul> </li> </ul> <ul class="navbar-nav ms-auto" data-astro-cid-wu5dj4rx=""> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="languages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-language" data-astro-cid-wu5dj4rx=""></i> Language <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="languages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/article/modify-website/selfhost-dns-root-server.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-cn" data-astro-cid-wu5dj4rx=""></span> Chinese Simplified / 简体中文 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item active" href="/en/article/modify-website/selfhost-dns-root-server.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-us" data-astro-cid-wu5dj4rx=""></span> English </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">Not all pages have translations.</a> </li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">You may see 404 - this is normal.</a> </li> </ul> </li> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="color-scheme-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Night Mode </a> <ul class="dropdown-menu" aria-labelledby="color-scheme-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-auto" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Auto </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-light" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-sun" data-astro-cid-wu5dj4rx=""></i> Light</a> </li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-dark" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-moon" data-astro-cid-wu5dj4rx=""></i> Dark</a> </li> </ul> </li> </ul> </div> </div> </nav> <script type="module">const m="user-color-scheme",s="data-user-color-scheme",u=(e,t)=>{try{localStorage.setItem(e,t)}catch{}},i=e=>{try{return localStorage.getItem(e)}catch{return null}},c=e=>{const t={dark:!0,light:!0,auto:!0},o=e===null||!Object.keys(t).includes(e)?"auto":e;u(m,o);for(const l in t){const n=document.getElementById("color-scheme-"+l);n&&(l==o?n.classList.add("active"):n.classList.remove("active"))}o!="auto"?document.documentElement.setAttribute(s,o):document.documentElement.removeAttribute(s)};c(i(m));const r=document.getElementById("color-scheme-auto");r&&r.addEventListener("click",()=>c("auto"));const a=document.getElementById("color-scheme-light");a&&a.addEventListener("click",()=>c("light"));const d=document.getElementById("color-scheme-dark");d&&d.addEventListener("click",()=>c("dark"));</script>  <div class="d-flex" data-astro-cid-porej7z2=""> <div id="content" data-astro-cid-porej7z2="">  <article> <div class="d-flex"> <div class="post-info-wrap" data-astro-cid-dckccua4=""> <div class="post-info" data-astro-cid-dckccua4=""> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-clock"></span> <br> <small>09-05</small> </p> <div class="post-meta-value"> Published on<span class="badge badge-tag" data-astro-cid-dckccua4=""> 2020-09-05 21:59 </span>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-file-alt"></span> <br> <small>Website and Servers</small> </p> <div class="post-meta-value"> Category <a class="badge badge-tag" href="/en/category/modify-website" data-astro-cid-dckccua4=""> Website and Servers </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-tag"></span> <br> <small>2 tags</small> </p> <div class="post-meta-value"> Tags  <a class="badge badge-tag" href="/en/tag/DNS" data-astro-cid-dckccua4=""> DNS </a>  <a class="badge badge-tag" href="/en/tag/Root-Server" data-astro-cid-dckccua4=""> Root Server </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-list"></span> <br> <small>ToC</small> </p> <div class="post-meta-value">  <ol data-astro-cid-nj3qel45=""> <li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#changelog" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Changelog</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#dns-resolving-process" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">DNS Resolving Process</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#selfhosting-dns-root-server" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Selfhosting DNS Root Server</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#using-your-roots-for-recursion" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Using Your Roots for Recursion</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#if-the-cut-actually-happened" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">If the Cut Actually Happened</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#but-this-is-just-a-toy-right" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">But This is Just a Toy, Right?</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#conclusion" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Conclusion</span> </a> </li> </ol>   </div> </div> </div> </div>  </div>  <div class="post-wrap">  <h1 class="post-title"> <a href="/en/article/modify-website/selfhost-dns-root-server.lantian/" rel="bookmark" title="Self-hosting a DNS Root Server">Self-hosting a DNS Root Server</a> </h1> <div class="post-text">   <p>With the scale of conflict between China and the United States increasing, on
some social media websites in China, some users started expressing concerns for
the United States cutting China's access to DNS root servers or removing China's
domains in the root servers in order to break China's Internet.</p>
<p>By now, there is much analysis on the matter that states that this is unlikely
to happen. Most of them focus on the following two points:</p>
<ul>
<li>DNS root servers use Anycast to broadcast their IPs, and there are root
servers present in China that won't be affected by the network cut;</li>
<li>For the United States, shutting down root servers cause more trouble than
benefit, both economically and politically.</li>
</ul>
<p>Yet today, I'm going to present another point:</p>
<ul>
<li>You can set up your own DNS root server and make your recursive DNS servers
use it in a short time.</li>
</ul>
<p>Yes. The root server you're going to self-host is functionally equivalent to the
root servers as fundamental Internet infrastructure.</p>
<h2 id="changelog">Changelog</h2>
<ul>
<li>2020-10-01: Also preserve DS records while filtering root zone file to better
support DNSSEC enabled recursive servers.</li>
<li>2020-09-05: Initial version.</li>
</ul>
<h2 id="dns-resolving-process">DNS Resolving Process</h2>
<p>First, let's take a look at the procedures of DNS resolve:</p>
<ol>
<li>You turned on your computer, entered <code>https://www.lantian.pub</code> in order to
visit my blog.
<ul>
<li>Although my blog doesn't have <code>www</code> in its URL, for demonstration purposes,
let's temporarily assume that it has one.</li>
</ul>
</li>
<li>Your browser cannot directly talk to the domain. It needs to know the IP
address associated with the domain. Therefore, your browser sends a DNS
request to a "recursive DNS resolver" configured in your operating system,
like <code>8.8.8.8</code>.
<ul>
<li>The DNS request will contain: request the DNS server to <strong>perform
recursion</strong>, and return the <strong>A record</strong> (or IPv4 address) associated with
<code>www.lantian.pub</code>.</li>
<li>The IP address of the recursive resolver is configured in OS beforehand,
usually obtained from your router via DHCP, or you may have set it
manually.</li>
<li>How do routers obtain DNS servers' IP addresses? They will also use DHCP,
PPPoE, or similar protocols to obtain DNS servers from their upstream. The
process goes through to your ISP (like China Telecom), where it sets up its
own DNS server and configures the IP addresses in its core routers.</li>
</ul>
</li>
<li>The recursive DNS resolver (or the recursor) get the request and starts
<strong>recursion</strong>.
<ul>
<li>Note the <strong>recursion</strong> here. Another type of DNS server is <strong>authoritative
DNS server</strong> that doesn't perform recursion. This means that if you point
the OS resolver address to an authoritative resolver, it's very unlikely
that you can complete the DNS resolving process.</li>
</ul>
</li>
<li>Recursor first asks the <strong>DNS root server</strong> if it knows the IP address of
<code>www.lantian.pub</code>.</li>
<li>The root server looks up its database and finds that it doesn't know about
it. But it does have NS records of the <code>pub</code> domain, which contain the IP
addresses of the authoritative resolver in charge of <code>pub</code>.
<ul>
<li>Then it replies: "You can ask authoritative servers of <code>pub</code>. Here are
their IP addresses."
<ul>
<li>What gets replied is the NS records (or the domain of the authoritative
resolver) of the <code>pub</code> domain, optionally with their A/AAAA records (IP
addresses).</li>
</ul>
</li>
<li>DNS root servers are not in charge of all domains in the universe. They
only handle top-level domains, like the NS records of <code>com</code>, <code>net</code>, <code>org</code>,
etc., and tell recursors to ask another server.</li>
<li>DNS root servers <strong>DO NOT</strong> perform recursion!</li>
</ul>
</li>
<li>Recursor then asks the authoritative server of <code>pub</code> about the IP address of
<code>www.lantian.pub</code>.</li>
<li>The authoritative server of <code>pub</code> looks up its database and replies: "No, but
you can ask this server (along with <code>lantian.pub</code>'s NS records, and
optionally A/AAAA records)"</li>
<li>Recursor then asks <code>lantian.pub</code>'s authoritative server about
<code>www.lantian.pub</code>.</li>
<li>The authoritative server of <code>lantian.pub</code> looks up its database and replies:
"Yes I do! the IP address is this (along with <code>www.lantian.pub</code>'s A record"</li>
<li>Recursor finally gets the IP, and sends a reply to your browser about the
IP.</li>
<li>Your browser got the IP address for the domain and initiated a TCP
connection. What happens later isn't relevant to DNS anymore.</li>
</ol>
<p>In short, DNS root servers are "guides" to recursors, telling them the
authoritative servers they should ask for a domain suffix.</p>
<p>Although it looks like the root servers will be under a lot of pressure, it
isn't the case. DNS servers (including recursors and authoritative servers)
usually send a Time-To-Live (TTL) with their replies that tell browsers
(clients) or recursors to simply use this result for the time period and not
annoy the server again.</p>
<h2 id="selfhosting-dns-root-server">Selfhosting DNS Root Server</h2>
<p>In the previous steps, the DNS root server, the authoritative server of <code>pub</code>,
and that of <code>lantian.pub</code>, do similar things: they receive a request and send
back a NS record or A/AAAA records. It seems that they can be backed by the same
software. This is indeed the case.</p>
<p>Therefore with some general authoritative DNS resolver software, like PowerDNS
or Bind9, you can set up your own root server.</p>
<ol>
<li>
<p>Install PowerDNS.</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">apt</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> install</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> pdns-server</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> pdns-backend-mysql</span></span></code></pre>
</li>
<li>
<p>Modify PowerDNS's config, <code>/etc/powerdns/pdns.conf</code>. The key modifications
are:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Enable Bind Backend, so PowerDNS can recognize DNS record data in Bind format</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Bind is the de-facto standard format for DNS records</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">launch</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">bind</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Tell Bind Backend to load this config</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">bind-config</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">/etc/powerdns/bind.conf</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Check the config for updates every few moments (60 seconds)</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">bind-check-interval</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">60</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Ignore problematic records, so even if you made a mistake,</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># other normal records can still be served</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">bind-ignore-broken-records</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">yes</span></span></code></pre>
</li>
<li>
<p>Go to <a href="https://www.iana.org/domains/root/files" rel="noopener noreferrer" target="_blank">IANA's official website</a>,
click on <code>Root Zone File</code> to download the root server's DNS record file. Save
it to <code>/etc/powerdns/root.zone</code>.</p>
<ul>
<li>Yes, this file of around 2 MB is all that's in charge of DNS root servers.</li>
</ul>
</li>
<li>
<p>Open the downloaded <code>root.zone</code> file. The content within separates into 5
columns. Perform some modifications:</p>
<ul>
<li>
<p>Remove all lines with a dot <code>.</code> in the 1st column and <code>NS</code> in the 4th
column.</p>
<ul>
<li>These lines are at the beginning of the file.</li>
</ul>
</li>
<li>
<p>Remove all lines where the content in the 4th column is not <code>A</code>, <code>AAAA</code>,
<code>SOA</code>, <code>NS</code> or <code>DS</code>. This can be achieved with:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cat</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> root.zone</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">awk</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> '{if ($4=="A" || $4=="AAAA" || $4=="SOA" || $4=="NS" || $4=="DS") print $0}'</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> > </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">root.zone.2</span></span></code></pre>
<p>What's removed is DNSSEC relevant, used to prevent DNS records from being
modified. But since we do need to modify, these records will be invalid, so
we'd better remove them all.</p>
</li>
<li>
<p>Add an IP address of your own server. Assume your server's IP is
<code>192.168.0.1</code> and <code>fd00::1</code>, with a domain <code>server.example.com</code> pointing to
it, add these lines to the end of the file:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Comments in Bind DNS files start with semicolons,</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># so no lines starting with number (hashtag) signs.</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">#</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Remove all these comments while copying contents!</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">#</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Note the extra dot at the end of the line. IT MUST BE THERE.</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 86400</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> NS</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> server.example.com.</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Also note the extra dot in the 1st column. MUST BE THERE, TOO.</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">server.example.com.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 86400</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> A</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 192.168.0.1</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">server.example.com.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 86400</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> AAAA</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> fd00::1</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># 86400 is TTL, the time period that the record is valid in cache.</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Adjust if you need</span></span></code></pre>
<p>These records indicate that your server is "in charge" of the root zone
records of DNS.</p>
<p>If you have multiple servers you plan to set up as root servers, repeat the
step a few times.</p>
</li>
</ul>
</li>
<li>
<p>Create file <code>/etc/powerdns/bind.conf</code> and add these contents, so PowerDNS
knows that the file above is in charge of the root DNS zone:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">zone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "."</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> {</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> type</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> native</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">file</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "/etc/powerdns/root.zone"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; };</span></span></code></pre>
<p>That's correct, only one line.</p>
</li>
<li>
<p><code>systemctl restart pdns</code> to restart the PowerDNS service.</p>
</li>
<li>
<p>Run <code>dig @192.168.0.1</code> to check if your records are properly loaded.
Normally, the lines you added above should be shown. For example, if you run
<code>dig @103.42.215.193</code>, which is querying against my root server, you would
see:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">;; </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">ANSWER</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> SECTION:</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">                       3600</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      NS</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      gigsgigscloud.lantian.pub.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">;; </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">ADDITIONAL</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> SECTION:</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">gigsgigscloud.lantian.pub.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 3600</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      AAAA</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    2001:470:fa1c::1</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">gigsgigscloud.lantian.pub.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 3600</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      A</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">       103.42.215.193</span></span></code></pre>
<p>(Some lines removed for brevity)</p>
</li>
<li>
<p>Then, run <code>dig @192.168.0.1 www.example.com</code>, and you should get an output
similar to:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">;; </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">AUTHORITY</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> SECTION:</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">com.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">                    172800</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      NS</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      m.gtld-servers.net.</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">com.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">                    172800</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      NS</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      l.gtld-servers.net.</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">com.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">                    172800</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      NS</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      k.gtld-servers.net.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">;; </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">ADDITIONAL</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> SECTION:</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">m.gtld-servers.net.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">     172800</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      AAAA</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    2001:501:b1f9::30</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">m.gtld-servers.net.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">     172800</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      A</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">       192.55.83.30</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">l.gtld-servers.net.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">     172800</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      AAAA</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    2001:500:d937::30</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">l.gtld-servers.net.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">     172800</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      A</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">       192.41.162.30</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">k.gtld-servers.net.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">     172800</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      AAAA</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    2001:503:d2d::30</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">k.gtld-servers.net.</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">     172800</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  IN</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      A</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">       192.52.178.30</span></span></code></pre>
<p>This is your root server returning the authoritative server addresses of
<code>com</code> domain, telling the recursor to go and ask these servers.</p>
<p>(Again, some lines removed for brevity)</p>
</li>
<li>
<p>Congratulations! You now have your own root server.</p>
</li>
</ol>
<h2 id="using-your-roots-for-recursion">Using Your Roots for Recursion</h2>
<p>With your root servers available, the next step is to configure your recursors
to use them to complete the recursion process.</p>
<p>First, save all of the content you added above (or equivalent, the content of
<code>dig @192.168.0.1</code>) to a file, ex. <code>root.hint</code>.</p>
<p>For PowerDNS Recursor software, if you haven't enabled DNSSEC validation, simply
add this line in the config file:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">hint-file</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">/etc/powerdns/root.hint</span></span></code></pre>
<p>The restart PowerDNS Recursor, and it will work.</p>
<p>If you enabled DNSSEC, since we removed all DNSSEC records above, you need to
tell PowerDNS Recursor not to validate contents in DNS root zones.</p>
<p>Add another line in the config file:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">lua-config-file</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">/etc/powerdns/script.lua</span></span></code></pre>
<p>And create the file <code>/etc/powerdns/script.lua</code> with this line:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">addNTA</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">(</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"."</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span></code></pre>
<p>Save and restart PowerDNS Recursor, done.</p>
<p>Now test your own resolver, it should be able to resolve any address as you
want, like <code>lantian.pub</code>, <code>bing.com</code>, etc.</p>
<h2 id="if-the-cut-actually-happened">If the Cut Actually Happened</h2>
<p>Assume the United States did use technical means to cut the connection from all
DNS root servers to China.</p>
<p>First, with the existence of caches, China's DNS resolving process won't be
immediately shut down. Take a look at the <code>root.zone</code> file. Most of the TTL
(validity times) are 86400 (24 hours) or even more. This means that China has
approximately 24 hours to respond.</p>
<p>In the 24 hours, with caches expiring, different recursors will gradually start
to fail the recursion resolving process. By then, the resolver administrators
will only need to set up a root server by the above means and modify recursor's
configs to use it. Immediately things will be back to normal.</p>
<h2 id="but-this-is-just-a-toy-right">But This is Just a Toy, Right?</h2>
<p>First, if the root server is for temporary emergency private use by one
recursive DNS server, with the existence of caching, the load on root servers
won't be too high. Open-source DNS resolver software should already provide
sufficient performance.</p>
<p>But if an authoritative DNS provider (Like DNSPod) wants to make the root server
public to help each other through the hard times, the server load will be much
higher. But don't forget that professional DNS providers have professional
solutions to maximize their performance, and building a root server has no
special requirements on the DNS server software itself. This means that they can
quickly reuse their professional solution and set up a high-performance root
server cluster to satisfy the public's needs.</p>
<h2 id="conclusion">Conclusion</h2>
<p>DNS root servers are not technically special. Apart from their special position,
they are no different from other authoritative resolvers. If the currently used
root servers are down, simply quickly configure and "promote" another cluster to
replace them.</p>
<p>The process of configuration and "promotion" is not complicated either, using
existing software to load existing data. Therefore, there's no need to worry
about the large impacts of shutting down DNS root servers.</p>  </div>  <div class="clearfix" id="post-navi" data-astro-cid-gfbmwgei=""> <div class="float-end text-end" data-astro-cid-gfbmwgei=""> <a href="/en/article/random-notes/youhua-pt926g-fiber-modem-crack.lantian/" title="Hacking a Youhua PT926G Fiber Optic Modem" data-astro-cid-gfbmwgei=""> Hacking a Youhua PT926G Fiber Optic Modem </a> <br data-astro-cid-gfbmwgei=""> Next post »
</div> <div class="float-start text-start position-absolute" data-astro-cid-gfbmwgei="">
« Previous post <br data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-website/post-quantum-encryption.lantian/" title="Planning Ahead: Using Post-Quantum Cryptography" data-astro-cid-gfbmwgei=""> Planning Ahead: Using Post-Quantum Cryptography </a> </div> </div>  <div id="waline" data-waline-language="en-US" data-waline-path="/en/article/modify-website/selfhost-dns-root-server.lantian"></div> <script type="module" src="/assets/WalineComment.astro_astro_type_script_index_0_lang.Dqib3X1E.js"></script>  </div> </div> </article>  </div> <aside class="d-none d-xl-block"> <section class="widget"> <h3>Latest posts</h3> <ul class="list-unstyled"> <li> 07-20  <a href="/en/article/modify-computer/legal-lte-network-at-home-with-open5gs.lantian/">Legal LTE Network at Home with Open5GS</a> </li><li> 06-27  <a href="/en/article/modify-computer/sidestore-without-stosvpn-across-lan.lantian/">Using SideStore without StosVPN across your LAN</a> </li><li> 05-19  <a href="/en/article/modify-computer/nix-logarithmetic-math-library-from-zero.lantian/">Nix Logarithmic Math Library from Ground Zero</a> </li><li> 04-06  <a href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/">Legal LTE Network at Home for $100</a> </li><li> 02-10  <a href="/en/article/modify-computer/build-custom-android-kernel-with-nix.lantian/">Building Custom Android Kernel with Nix</a> </li><li> 04-20  <a href="/en/article/modify-website/migrate-blog-to-astro-js.lantian/">Migrating My Blog to Astro.js</a> </li><li> 12-16  <a href="/en/article/modify-computer/nixos-low-ram-vps.lantian/">NixOS Series 5: Creating Disk Image for Low RAM VPS</a> </li><li> 09-20  <a href="/en/article/modify-computer/nix-trigonometric-math-library-from-zero.lantian/">Nix Trigonometric Math Library from Ground Zero</a> </li><li> 05-29  <a href="/en/article/random-notes/pipewire-sigkill-fix.lantian/">Preventing Pipewire from being SIGKILLed</a> </li><li> 05-12  <a href="/en/article/modify-website/how-to-kill-the-dn42-network.lantian/">How to Kill the DN42 Network (Updated 2023-05-12)</a> </li><li> 05-08  <a href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/">NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05)</a> </li><li> 04-17  <a href="/en/article/random-notes/fix-china-telecom-roaming-no-4g-on-aosp-rom.lantian/">Fix China Telecom 4G Roaming on AOSP ROM by Changing APN</a> </li><li> 03-26  <a href="/en/article/random-notes/old-hp-workstation-as-all-in-one.lantian/">Notes on Setting Up NAS+Router on Old HP Workstation</a> </li><li> 01-14  <a href="/en/article/modify-computer/nixos-impermanence.lantian/">NixOS Series 4: &quot;Stateless&quot; Operating System</a> </li><li> 06-21  <a href="/en/article/modify-computer/nixos-packaging.lantian/">NixOS Series 3: Software Packaging 101</a> </li> </ul> </section> <section class="widget"> <h3>Latest comments</h3> <ul class="list-unstyled" id="recent-comments">  <li><a href="#">Loading...</a></li>  </ul> </section> <script type="module">const i=window.location.hostname=="localhost"?"https://comments.lantian.pub":window.location.origin;fetch(`${i}/api/comment?type=recent&count=10`).then(t=>{if(t.status!==200)throw new Error(`Server returned bad HTTP status ${t.status}`);return t.json()}).then(t=>{const e=document.getElementById("recent-comments");e&&(e.innerHTML=t.data.map(n=>{const o=n.comment.replace(/(<([^>]+)>)/gi,"");return"<li>"+n.nick+' <a href="'+n.url+'">'+o+"</a></li>"}).join(""))});</script> <section class="widget"> <h3>Others</h3> <ul class="list-unstyled">  <li> <i class="fas fa-fw fa-rss"></i>  <a href="/rss2.xml" target="_blank">RSS Feed</a> |  <a href="/feed.xml" target="_blank">Atom</a> |  <a href="/feed.json" target="_blank">JSON</a> </li> <li> <i class="fas fa-fw fa-globe"></i>  <a href="https://stats.uptimerobot.com/BLK6VsRkR" target="_blank"> Sever Status </a> </li> <li> <i class="fas fa-fw fa-sitemap"></i>  <a href="https://lg.lantian.pub" target="_blank">DN42 Looking Glass</a> </li> <li> <i class="fas fa-fw fa-link"></i>  <a href="gopher://lantian.pub" target="_blank">Access with Gopher protocol</a> </li>  </ul> </section> <section class="widget"> <h3>Links</h3> <ul class="list-unstyled"> <li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://0x7f.cc"> 0x7f Blog 🐑 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="http://foreverblog.cn"> 10 Year&#39;s Promise (Forever Blog) </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://alanyhq.com"> Alanyhq </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.baoshuo.ren/?utm_source=friends"> Baoshuo&#39;s Blog </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.cas7.moe"> Blog of Moecast </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://jerryxiao.cc"> JerryXiao </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://sangsir.com"> SangSir </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://snli.org"> Shucheng Li </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://yuetau.net"> YuetAu&#39;s Spot </a> </li> </ul> </section> </aside> </div> <footer class="lantian clearfix" data-astro-cid-w3csb3e3="">  <div id="copyright" class="float-end text-end" data-astro-cid-w3csb3e3=""> <i class="fas fa-copyright" data-astro-cid-w3csb3e3=""></i> 2012-2025 Lan Tian @ Blog<br data-astro-cid-w3csb3e3=""> <small data-astro-cid-w3csb3e3=""> Powered by Astro v5.15.1 @ 2025-10-25 23:46:38 </small> </div> <script type="module">function v(c,o,r){const h=/^localhost$|^127(?:\.[0-9]+){0,2}\.[0-9]+$|^(?:0*:)*?:?0*1$/.test(location.hostname)||location.protocol==="file:";if(!o.trackLocalhost&&h)return console.warn("[Plausible] Ignoring event because website is running locally");try{if(window.localStorage.plausible_ignore==="true")return console.warn('[Plausible] Ignoring event because "plausible_ignore" is set to "true" in localStorage')}catch{}const p={n:c,u:o.url,d:o.domain,r:o.referrer,w:o.deviceWidth,h:o.hashMode?1:0,p:r&&r.props?JSON.stringify(r.props):void 0},s=new XMLHttpRequest;s.open("POST",`${o.apiHost}/api/event`,!0),s.setRequestHeader("Content-Type","text/plain"),s.send(JSON.stringify(p)),s.onreadystatechange=()=>{s.readyState===4&&r&&r.callback&&r.callback()}}function b(c){const o=()=>({hashMode:!1,trackLocalhost:!1,url:location.href,domain:location.hostname,referrer:document.referrer||null,deviceWidth:window.innerWidth,apiHost:"https://plausible.io",...c}),r=(t,n,i)=>{v(t,{...o(),...i},n)},h=(t,n)=>{r("pageview",n,t)};return{trackEvent:r,trackPageview:h,enableAutoPageviews:()=>{const t=()=>h(),n=history.pushState;return n&&(history.pushState=function(i,l,u){n.apply(this,[i,l,u]),t()},addEventListener("popstate",t)),c&&c.hashMode&&addEventListener("hashchange",t),h(),function(){n&&(history.pushState=n,removeEventListener("popstate",t)),c&&c.hashMode&&removeEventListener("hashchange",t)}},enableAutoOutboundTracking:(t=document,n={subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]})=>{function i(e){r("Outbound Link: Click",{props:{url:this.href}}),typeof process<"u"&&process,setTimeout(()=>{location.href=this.href},150),e.preventDefault()}const l=new Set;function u(e){e instanceof HTMLAnchorElement?e.host!==location.host&&(e.addEventListener("click",i),l.add(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(u)}function f(e){e instanceof HTMLAnchorElement?(e.removeEventListener("click",i),l.delete(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(f)}const d=new MutationObserver(e=>{e.forEach(a=>{a.type==="attributes"?(f(a.target),u(a.target)):a.type==="childList"&&(a.addedNodes.forEach(u),a.removedNodes.forEach(f))})});return t.querySelectorAll("a").forEach(u),d.observe(t,n),function(){l.forEach(a=>{a.removeEventListener("click",i)}),l.clear(),d.disconnect()}}}}const g=b({domain:"lantian.pub",trackLocalhost:!0,apiHost:""});g.trackPageview();</script> </footer>  </div>  </body> </html>