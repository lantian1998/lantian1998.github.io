<!DOCTYPE html><html lang="en-US" itemscope="" itemtype="https://schema.org/Article" data-astro-cid-porej7z2=""> <head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Migrating the Website to Docker - Lan Tian @ Blog</title><script>
  ;(() => {
    try {
      const mode = localStorage.getItem('user-color-scheme')
      if (mode == 'dark' || mode == 'light') {
        document.documentElement.setAttribute('data-user-color-scheme', mode)
      }
    } catch {
      // Ignore errors
    }
  })()
</script><link rel="stylesheet" href="/assets/index.CUlf1-Vz.css"><style>#post-navi[data-astro-cid-gfbmwgei]{padding:5px;border-top:1px solid var(--lt-border-weak);border-bottom:1px solid var(--lt-border-weak)}
ol[data-astro-cid-nj3qel45]{margin:0;padding:0;line-height:1.5}ol[data-astro-cid-nj3qel45] .toc-item[data-astro-cid-nj3qel45]{list-style:none}ol[data-astro-cid-nj3qel45] .toc-child[data-astro-cid-nj3qel45],ol[data-astro-cid-nj3qel45] .toc[data-astro-cid-nj3qel45]{padding:0}ol[data-astro-cid-nj3qel45] .toc-link[data-astro-cid-nj3qel45]{display:block;margin-left:1em;padding:.25em 0}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:1em;padding:.25em 0;float:left;font-style:normal;font-variant:normal;font-weight:900;font-family:Font Awesome\ 6 Free;font-feature-settings:normal;text-align:center}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before{content:""}ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{content:""}.post-info-wrap[data-astro-cid-dckccua4]{-ms-flex:0 0 2.5em;flex:0 0 2.5em;background-color:var(--lt-component-bg-emphasis)}@media(min-width:768px){.post-info[data-astro-cid-dckccua4]{position:sticky;top:0}}@media(max-width:767.98px){.post-info[data-astro-cid-dckccua4]{position:absolute}}
</style><script type="module" src="/assets/PageLayout.astro_astro_type_script_index_0_lang.C1wfUPs6.js"></script><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="imagemode" content="force"><meta name="nightmode" content="disable"><meta name="wap-font-scale" content="no"><meta name="title" content="Migrating the Website to Docker - Lan Tian @ Blog"><meta name="keywords" content=""><meta name="author" content="Lan Tian"><link rel="canonical" href="https://lantian.pub/en/article/modify-website/migrate-website-docker.lantian/"><link rel="alternate" type="application/rss+xml" title="Lan Tian @ Blog" href="https://lantian.pub/rss2.xml"><link rel="alternate" type="application/atom+xml" title="Lan Tian @ Blog" href="https://lantian.pub/feed.xml"><link rel="alternate" href="https://lantian.pub/article/modify-website/migrate-website-docker.lantian/" hreflang="zh"><link rel="alternate" href="https://lantian.pub/en/article/modify-website/migrate-website-docker.lantian/" hreflang="en"><meta name="copyright" content="Copyright 2012-2025 Lan Tian @ Blog"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="manifest" href="/manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#03a9f4"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#212121"><meta name="application-name" content="Lan Tian @ Blog"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-precomposed.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#03a9f4"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lan Tian @ Blog"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1170x2532.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2532x1170.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1179x2556.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2556x1179.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1284x2778.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2778x1284.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1290x2796.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2796x1290.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1488x2266.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2266x1488.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1640x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1640.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"><meta name="msapplication-TileColor" content="#bbdefb"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta name="msapplication-config" content="/browserconfig.xml"><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"><meta property="og:url" content="https://lantian.pub/en/article/modify-website/migrate-website-docker.lantian/"><meta property="og:type" content="website"><meta property="og:title" content="Migrating the Website to Docker - Lan Tian @ Blog"><meta property="og:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="Docker is a container management software for Linux. Each container is functionally similar to an OpenVZ VPS, allowing isolation of applications on a server. This isolation enables different versions of the same software or conflicting applications to run on the same server. For example, MySQL 5.7, MySQL 5.6, and MariaDB 10.1 can run simultaneously in three separate Docker containers on one server. However, Docker surpasses OpenVZ in its more flexible Linux kernel version requirements. OpenVZ kernels remain stuck at 2.6.32 (stable) and 3.10 (development), while Docker runs on any Linux kernel above 3.10. My server currently uses Linux kernel 4.9 (for BBR support), which clearly cannot run OpenVZ but works perfectly with Docker...."><meta property="og:site_name" content="Lan Tian @ Blog"><meta property="og:locale" content="en"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://lantian.pub/en/article/modify-website/migrate-website-docker.lantian/"><meta name="twitter:title" content="Migrating the Website to Docker - Lan Tian @ Blog"><meta property="twitter:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="Docker is a container management software for Linux. Each container is functionally similar to an OpenVZ VPS, allowing isolation of applications on a server. This isolation enables different versions of the same software or conflicting applications to run on the same server. For example, MySQL 5.7, MySQL 5.6, and MariaDB 10.1 can run simultaneously in three separate Docker containers on one server. However, Docker surpasses OpenVZ in its more flexible Linux kernel version requirements. OpenVZ kernels remain stuck at 2.6.32 (stable) and 3.10 (development), while Docker runs on any Linux kernel above 3.10. My server currently uses Linux kernel 4.9 (for BBR support), which clearly cannot run OpenVZ but works perfectly with Docker...."><meta name="twitter:dnt" content="on"><meta itemprop="name" content="Migrating the Website to Docker - Lan Tian @ Blog"><meta property="image" content="https://lantian.pub/apple-touch-icon.png"><meta content="Docker is a container management software for Linux. Each container is functionally similar to an OpenVZ VPS, allowing isolation of applications on a server. This isolation enables different versions of the same software or conflicting applications to run on the same server. For example, MySQL 5.7, MySQL 5.6, and MariaDB 10.1 can run simultaneously in three separate Docker containers on one server. However, Docker surpasses OpenVZ in its more flexible Linux kernel version requirements. OpenVZ kernels remain stuck at 2.6.32 (stable) and 3.10 (development), while Docker runs on any Linux kernel above 3.10. My server currently uses Linux kernel 4.9 (for BBR support), which clearly cannot run OpenVZ but works perfectly with Docker...."><meta content="Docker is a container management software for Linux. Each container is functionally similar to an OpenVZ VPS, allowing isolation of applications on a server. This isolation enables different versions of the same software or conflicting applications to run on the same server. For example, MySQL 5.7, MySQL 5.6, and MariaDB 10.1 can run simultaneously in three separate Docker containers on one server. However, Docker surpasses OpenVZ in its more flexible Linux kernel version requirements. OpenVZ kernels remain stuck at 2.6.32 (stable) and 3.10 (development), while Docker runs on any Linux kernel above 3.10. My server currently uses Linux kernel 4.9 (for BBR support), which clearly cannot run OpenVZ but works perfectly with Docker...."><link rel="me" href="https://mastodon.social/@lantian"></head> <body data-astro-cid-porej7z2=""> <div id="bg" data-astro-cid-j6vmxtef=""></div>   <div id="container" class="container" data-astro-cid-porej7z2=""> <nav class="lantian navbar navbar-expand-lg" data-astro-cid-wu5dj4rx=""> <div class="container-fluid" data-astro-cid-wu5dj4rx=""> <a class="navbar-brand" href="/en/" data-astro-cid-wu5dj4rx="">Lan Tian @ Blog</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#lantian-navbar" aria-controls="lantian-navbar" aria-expanded="false" aria-label="Toggle navigation" data-astro-cid-wu5dj4rx=""> <span class="navbar-toggler-icon" data-astro-cid-wu5dj4rx=""></span> </button> <div class="collapse navbar-collapse" id="lantian-navbar" data-astro-cid-wu5dj4rx=""> <ul class="navbar-nav" data-astro-cid-wu5dj4rx=""> <li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> <li class="nav-item dropdown d-block d-lg-none" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="pages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-file" data-astro-cid-wu5dj4rx=""></i> Page  <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="pages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> </ul> </li> </ul> <ul class="navbar-nav ms-auto" data-astro-cid-wu5dj4rx=""> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="languages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-language" data-astro-cid-wu5dj4rx=""></i> Language <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="languages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/article/modify-website/migrate-website-docker.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-cn" data-astro-cid-wu5dj4rx=""></span> Chinese Simplified / 简体中文 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item active" href="/en/article/modify-website/migrate-website-docker.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-us" data-astro-cid-wu5dj4rx=""></span> English </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">Not all pages have translations.</a> </li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">You may see 404 - this is normal.</a> </li> </ul> </li> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="color-scheme-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Night Mode </a> <ul class="dropdown-menu" aria-labelledby="color-scheme-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-auto" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Auto </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-light" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-sun" data-astro-cid-wu5dj4rx=""></i> Light</a> </li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-dark" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-moon" data-astro-cid-wu5dj4rx=""></i> Dark</a> </li> </ul> </li> </ul> </div> </div> </nav> <script type="module">const m="user-color-scheme",s="data-user-color-scheme",u=(e,t)=>{try{localStorage.setItem(e,t)}catch{}},i=e=>{try{return localStorage.getItem(e)}catch{return null}},c=e=>{const t={dark:!0,light:!0,auto:!0},o=e===null||!Object.keys(t).includes(e)?"auto":e;u(m,o);for(const l in t){const n=document.getElementById("color-scheme-"+l);n&&(l==o?n.classList.add("active"):n.classList.remove("active"))}o!="auto"?document.documentElement.setAttribute(s,o):document.documentElement.removeAttribute(s)};c(i(m));const r=document.getElementById("color-scheme-auto");r&&r.addEventListener("click",()=>c("auto"));const a=document.getElementById("color-scheme-light");a&&a.addEventListener("click",()=>c("light"));const d=document.getElementById("color-scheme-dark");d&&d.addEventListener("click",()=>c("dark"));</script>  <div class="d-flex" data-astro-cid-porej7z2=""> <div id="content" data-astro-cid-porej7z2="">  <article> <div class="d-flex"> <div class="post-info-wrap" data-astro-cid-dckccua4=""> <div class="post-info" data-astro-cid-dckccua4=""> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-clock"></span> <br> <small>12-29</small> </p> <div class="post-meta-value"> Published on<span class="badge badge-tag" data-astro-cid-dckccua4=""> 2016-12-29 13:55 </span>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-file-alt"></span> <br> <small>Website and Servers</small> </p> <div class="post-meta-value"> Category <a class="badge badge-tag" href="/en/category/modify-website" data-astro-cid-dckccua4=""> Website and Servers </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-tag"></span> <br> <small>1 tags</small> </p> <div class="post-meta-value"> Tags  <a class="badge badge-tag" href="/en/tag/Docker" data-astro-cid-dckccua4=""> Docker </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-list"></span> <br> <small>ToC</small> </p> <div class="post-meta-value">  <ol data-astro-cid-nj3qel45=""> <li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#installing-docker-and-docker-compose" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Installing Docker and Docker Compose</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#migrating-using-existing-images" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Migrating Using Existing Images</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#creating-an-image-from-apt-get-installed-software" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Creating an Image from apt-get Installed Software</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#building-a-custom-software-image" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Building a Custom Software Image</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#conclusion" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Conclusion</span> </a> </li> </ol>   </div> </div> </div> </div>  </div>  <div class="post-wrap">  <h1 class="post-title"> <a href="/en/article/modify-website/migrate-website-docker.lantian/" rel="bookmark" title="Migrating the Website to Docker">Migrating the Website to Docker</a> </h1> <div class="post-text">   <blockquote> <p>
This post is automatically translated with LLM. The translation content has
    NOT been reviewed and may contain errors.
</p> </blockquote><p>Docker is a container management software for Linux. Each container is functionally similar to an OpenVZ VPS, allowing isolation of applications on a server. This isolation enables different versions of the same software or conflicting applications to run on the same server. For example, MySQL 5.7, MySQL 5.6, and MariaDB 10.1 can run simultaneously in three separate Docker containers on one server.</p>
<p>However, Docker surpasses OpenVZ in its more flexible Linux kernel version requirements. OpenVZ kernels remain stuck at 2.6.32 (stable) and 3.10 (development), while Docker runs on any Linux kernel above 3.10. My server currently uses Linux kernel 4.9 (for BBR support), which clearly cannot run OpenVZ but works perfectly with Docker.</p>
<p>Another advantage of Docker is its comprehensive image repository and automation tools. With OpenVZ, I had to log into each VPS individually to configure networks, run <code>apt-get</code>, and perform regular backups. With Docker, I can directly use pre-built software images (no need for <code>apt-get</code>) and map data folders directly to the host machine (eliminating separate backups).</p>
<p>Docker also provides Docker Compose, which allows configuring multiple containers via a configuration file for rapid deployment and removal.</p>
<h2 id="installing-docker-and-docker-compose">Installing Docker and Docker Compose</h2>
<p>I use Debian 8, which allows direct installation from Docker's official repository.</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">apt-get</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> install</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> apt-transport-https</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ca-certificates</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> gnupg2</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">apt-key</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> adv</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> --keyserver</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> hkp://ha.pool.sks-keyservers.net:80</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> --recv-keys</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 58118E89F3A912897C070ADBF76221572C52609D</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">echo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "deb https://apt.dockerproject.org/repo debian-jessie main"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> >> </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">/etc/apt/sources.list</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">apt-get</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> update</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">apt-get</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> install</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> docker-engine</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">curl</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -L</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "https://github.com/docker/compose/releases/download/1.9.0/docker-compose-$(</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">uname</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -s</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">)-$(</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">uname</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -m</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">)"</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -o</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /usr/local/bin/docker-compose</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">chmod</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> +x</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /usr/local/bin/docker-compose</span></span></code></pre>
<h2 id="migrating-using-existing-images">Migrating Using Existing Images</h2>
<p>My server originally ran: Nginx, PHP7.0-FPM, MariaDB, Memcached, Redis, and SS. For unified management, I migrated them using Docker images.</p>
<p>I stored all data in <code>/srv</code>, so I created a <code>docker-compose.yml</code> file in this directory. This is Docker Compose's configuration file. The basic format is as follows: (Content after # is my explanatory note and doesn't exist in the original file)</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">version</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">services</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  container1</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    image</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">Container image name (Docker automatically downloads if missing)</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    container_name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">Container name</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    environment</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Environment variables</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">ENV_VAR_NAME=value</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">PASSWORD=123456</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    restart</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">always</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Restart immediately if container crashes</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    volumes</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Map host folders to container for data management</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/host/data/path:/container/data/path'</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/var/lib/mysql:/var/lib/mysql'</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    ports</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Port mapping</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'host_port:container_port'</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Publicly accessible</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'80:80'</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'host_ip:host_port:container_port'</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Only accessible locally</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'127.0.0.1:11211:11211'</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  container2</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">... (same as container1)</span></span></code></pre>
<p>Next, we'll create a <code>docker-compose.yml</code> to run the MariaDB image and import data. (Content after # is my note)</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">version</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">services</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  lantian-mariadb</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    image</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">mariadb:latest</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    container_name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">lantian-mariadb</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    restart</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">always</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    volumes</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/srv/mysql:/var/lib/mysql'</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/etc/timezone:/etc/timezone'</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Sync host timezone</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/etc/localtime:/etc/localtime'</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">    ports</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'127.0.0.1:3306:3306'</span></span></code></pre>
<p>First, stop the original MariaDB: <code>service mysql stop</code> (no seamless migration considered)</p>
<p>Move the data folder: <code>mv /var/lib/mysql /srv/mysql</code></p>
<p>Finally, load the configuration: <code>docker-compose up -d</code></p>
<p>MariaDB is now running in Docker!</p>
<p>Redis and Memcached can be migrated similarly using their official images.</p>
<h2 id="creating-an-image-from-apt-get-installed-software">Creating an Image from apt-get Installed Software</h2>
<p>PHP7.0-FPM is more complex. The official PHP-FPM image uses unusual compilation flags and configuration paths that differ from my DotDeb installation. To avoid issues, I created a custom Docker image.</p>
<p>Building Docker images requires only basic bash knowledge. Create a new folder, then add a Dockerfile with the following structure: (Comments after # are mine)</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">FROM</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> debian:jessie # Base image</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">MAINTAINER</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> Lan Tian </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"lantian@lantian.pub"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> # Optional author info</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ADD</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> somefile.txt /somefile.txt # Add local file to image</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">RUN</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> apt-get update # Execute command during build</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">EXPOSE</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> 80 # Expose port to other containers</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ENTRYPOINT</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> [</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"php-fpm7.0"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">] # Startup command (container stops when this exits)</span></span></code></pre>
<p>For this image, I need to: add DotDeb repository, run <code>apt-get</code>, add custom configs, expose ports, and set the startup command. My Dockerfile:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">FROM</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> debian:jessie</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">MAINTAINER</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> Lan Tian </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"lantian@lantian.pub"</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ADD</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> dotdeb.gpg /dotdeb.gpg</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">RUN</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> echo </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"deb http://packages.dotdeb.org jessie all"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> >> /etc/apt/sources.list \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; echo </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"deb-src http://packages.dotdeb.org jessie all"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> >> /etc/apt/sources.list \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; apt-key add /dotdeb.gpg \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; apt-get update \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; apt-get install -y php7.0-fpm php7.0-bz2 php7.0-curl php7.0-gd php7.0-json php7.0-mbstring php7.0-mcrypt php7.0-memcached php7.0-mysql php7.0-redis php7.0-sqlite3 php7.0-xml php7.0-xmlrpc php7.0-zip \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; apt-get clean</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ADD</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> www.conf /etc/php/7.0/fpm/pool.d/www.conf</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ADD</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> php.ini /etc/php/7.0/fpm/php.ini</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ADD</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> php-fpm.conf /etc/php/7.0/fpm/php-fpm.conf</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">EXPOSE</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> 9000</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ENTRYPOINT</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> [</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"php-fpm7.0"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">]</span></span></code></pre>
<p>Prepare files:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">wget</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://www.dotdeb.org/dotdeb.gpg</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cp</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /etc/php/7.0/fpm/pool.d/www.conf</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ./</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cp</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /etc/php/7.0/fpm/php.ini</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ./</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cp</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /etc/php/7.0/fpm/php-fpm.conf</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ./</span></span></code></pre>
<p>Build the image:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">docker</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> build</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -t</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> lt-php7-fpm</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> .</span></span></code></pre>
<p>Add to <code>docker-compose.yml</code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">lt-php-fpm</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  image</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">lt-php7-fpm</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  container_name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">lt-php-fpm</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  restart</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">always</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  volumes</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'./www:/srv/www'</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Website root</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'./owncloud:/srv/owncloud'</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Remove if not using OwnCloud</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/etc/timezone:/etc/timezone'</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Timezone</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/etc/localtime:/etc/localtime'</span></span></code></pre>
<h2 id="building-a-custom-software-image">Building a Custom Software Image</h2>
<p>My Nginx setup is more complex due to custom patches: HTTP2/SPDY, Google PageSpeed, Certificate Transparency, and Brotli compression. Since no existing image fits, I compiled my own.</p>
<p>The solution: convert all compilation commands into a Dockerfile. Use variables for version numbers to simplify updates:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ENV</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> NGINX_VERSION=1.11.8 # Set variable</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">RUN</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> cd nginx-${NGINX_VERSION} # Use variable</span></span></code></pre>
<p>My Dockerfile:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">FROM</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> debian</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">MAINTAINER</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> Lan Tian </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"lantian@lantian.pub"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ENV</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> NGINX_VERSION=1.11.8 OPENSSL_VERSION=1.1.0c NPS_VERSION=1.12.34.2</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">RUN</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> mkdir /tmp/build &#x26;&#x26; cd /tmp/build \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; apt-get update -q\</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; apt-get -y install build-essential git autoconf automake libtool wget tar zlib1g-dev libpcre3 libpcre3-dev unzip \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; wget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; tar xvf nginx-${NGINX_VERSION}.tar.gz \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; git clone https://github.com/bagder/libbrotli.git \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; cd /tmp/build/libbrotli &#x26;&#x26; ./autogen.sh &#x26;&#x26; ./configure &#x26;&#x26; make &#x26;&#x26; make install &#x26;&#x26; cd /tmp/build \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; ln -s /usr/local/lib/libbrotlienc.so.1 /usr/lib/libbrotlienc.so.1 \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; git clone https://github.com/google/ngx_brotli.git \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; cd /tmp/build/ngx_brotli &#x26;&#x26; git submodule update --init &#x26;&#x26; cd /tmp/build/ \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; git clone https://github.com/grahamedgecombe/nginx-ct.git \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; wget https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; tar xvf openssl-${OPENSSL_VERSION}.tar.gz \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; wget https://github.com/pagespeed/ngx_pagespeed/archive/v${NPS_VERSION}-beta.zip \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; unzip v${NPS_VERSION}-beta.zip \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; cd /tmp/build/ngx_pagespeed-${NPS_VERSION}-beta/ \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; wget https://dl.google.com/dl/page-speed/psol/${NPS_VERSION}-x64.tar.gz \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; tar -xvf ${NPS_VERSION}-x64.tar.gz \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; cd /tmp/build \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; wget https://raw.githubusercontent.com/cujanovic/nginx-http2-spdy-patch/master/nginx-spdy-1.11.5%2B.patch -O nginx-spdy.patch \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; cd nginx-${NGINX_VERSION} \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; patch -p1 &#x3C; /tmp/build/nginx-spdy.patch \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; ./configure \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-threads \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-file-aio \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-ipv6 \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-http_ssl_module \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-http_spdy_module \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-http_v2_module \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-http_gzip_static_module \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-http_gunzip_module \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-http_stub_status_module \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-http_sub_module \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --add-module=/tmp/build/ngx_pagespeed-${NPS_VERSION}-beta \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --add-module=/tmp/build/nginx-ct \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --add-module=/tmp/build/ngx_brotli \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-openssl=/tmp/build/openssl-${OPENSSL_VERSION} \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">       --with-cc-opt=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"-O3 -fPIE -fstack-protector-strong -Wformat -Werror=format-security -Wno-deprecated-declarations"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; make \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; make install \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; cd / &#x26;&#x26; rm -rf /tmp/build \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; apt-get purge -y unzip git autoconf libtool wget automake build-essential \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; apt-get autoremove -y --purge \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    &#x26;&#x26; ln -sf /dev/stdout /usr/local/nginx/logs/access.log \</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">      &#x26;&#x26; ln -sf /dev/stderr /usr/local/nginx/logs/error.log</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">EXPOSE</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> 80 443</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ADD</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> start.sh /start.sh</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">ENTRYPOINT</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> /bin/bash /start.sh</span></span></code></pre>
<p>Critical issue: Nginx runs in background by default, causing Docker to terminate the container. Solution via <code>start.sh</code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">/usr/local/nginx/sbin/nginx</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">tail</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -F</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /usr/local/nginx/logs/access.log</span></span></code></pre>
<p><code>tail -F</code> keeps the container running by continuously monitoring logs.</p>
<p>Build the image:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">docker</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> build</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -t</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> lt-nginx</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> .</span></span></code></pre>
<p>Add to <code>docker-compose.yml</code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">lt-nginx</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  image</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">lt-nginx</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  container_name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">lt-nginx</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  restart</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">always</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  volumes</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'./nginx:/usr/local/nginx/conf'</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Config files</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'./www:/srv/www'</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Website root</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/etc/timezone:/etc/timezone'</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Timezone</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/etc/localtime:/etc/localtime'</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  ports</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'80:80'</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">    - </span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'443:443'</span></span></code></pre>
<h2 id="conclusion">Conclusion</h2>
<p>We've set up MariaDB, PHP-FPM, and Nginx containers. They can now be managed uniformly via:</p>
<ul>
<li>Start: <code>docker-compose up -d</code></li>
<li>Stop: <code>docker-compose down</code>
This greatly simplifies deployment and maintenance.</li>
</ul>
<pre><code></code></pre>  </div>  <div class="clearfix" id="post-navi" data-astro-cid-gfbmwgei=""> <div class="float-end text-end" data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-computer/linux-memory-leak-check.lantian/" title="Troubleshooting a Linux Memory Leak" data-astro-cid-gfbmwgei=""> Troubleshooting a Linux Memory Leak </a> <br data-astro-cid-gfbmwgei=""> Next post »
</div> <div class="float-start text-start position-absolute" data-astro-cid-gfbmwgei="">
« Previous post <br data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-website/mailgun-typecho-comment-email-notification.lantian/" title="Typecho Comment Email Notification Plugin Based on Mailgun" data-astro-cid-gfbmwgei=""> Typecho Comment Email Notification Plugin Based on Mailgun </a> </div> </div>  <div id="waline" data-waline-language="en-US" data-waline-path="/en/article/modify-website/migrate-website-docker.lantian"></div> <script type="module" src="/assets/WalineComment.astro_astro_type_script_index_0_lang.Dqib3X1E.js"></script>  </div> </div> </article>  </div> <aside class="d-none d-xl-block"> <section class="widget"> <h3>Latest posts</h3> <ul class="list-unstyled"> <li> 07-20  <a href="/en/article/modify-computer/legal-lte-network-at-home-with-open5gs.lantian/">Legal LTE Network at Home with Open5GS</a> </li><li> 06-27  <a href="/en/article/modify-computer/sidestore-without-stosvpn-across-lan.lantian/">Using SideStore without StosVPN across your LAN</a> </li><li> 05-19  <a href="/en/article/modify-computer/nix-logarithmetic-math-library-from-zero.lantian/">Nix Logarithmic Math Library from Ground Zero</a> </li><li> 04-06  <a href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/">Legal LTE Network at Home for $100</a> </li><li> 02-10  <a href="/en/article/modify-computer/build-custom-android-kernel-with-nix.lantian/">Building Custom Android Kernel with Nix</a> </li><li> 04-20  <a href="/en/article/modify-website/migrate-blog-to-astro-js.lantian/">Migrating My Blog to Astro.js</a> </li><li> 12-16  <a href="/en/article/modify-computer/nixos-low-ram-vps.lantian/">NixOS Series 5: Creating Disk Image for Low RAM VPS</a> </li><li> 09-20  <a href="/en/article/modify-computer/nix-trigonometric-math-library-from-zero.lantian/">Nix Trigonometric Math Library from Ground Zero</a> </li><li> 05-29  <a href="/en/article/random-notes/pipewire-sigkill-fix.lantian/">Preventing Pipewire from being SIGKILLed</a> </li><li> 05-12  <a href="/en/article/modify-website/how-to-kill-the-dn42-network.lantian/">How to Kill the DN42 Network (Updated 2023-05-12)</a> </li><li> 05-08  <a href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/">NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05)</a> </li><li> 04-17  <a href="/en/article/random-notes/fix-china-telecom-roaming-no-4g-on-aosp-rom.lantian/">Fix China Telecom 4G Roaming on AOSP ROM by Changing APN</a> </li><li> 03-26  <a href="/en/article/random-notes/old-hp-workstation-as-all-in-one.lantian/">Notes on Setting Up NAS+Router on Old HP Workstation</a> </li><li> 01-14  <a href="/en/article/modify-computer/nixos-impermanence.lantian/">NixOS Series 4: &quot;Stateless&quot; Operating System</a> </li><li> 06-21  <a href="/en/article/modify-computer/nixos-packaging.lantian/">NixOS Series 3: Software Packaging 101</a> </li> </ul> </section> <section class="widget"> <h3>Latest comments</h3> <ul class="list-unstyled" id="recent-comments">  <li><a href="#">Loading...</a></li>  </ul> </section> <script type="module">const i=window.location.hostname=="localhost"?"https://comments.lantian.pub":window.location.origin;fetch(`${i}/api/comment?type=recent&count=10`).then(t=>{if(t.status!==200)throw new Error(`Server returned bad HTTP status ${t.status}`);return t.json()}).then(t=>{const e=document.getElementById("recent-comments");e&&(e.innerHTML=t.data.map(n=>{const o=n.comment.replace(/(<([^>]+)>)/gi,"");return"<li>"+n.nick+' <a href="'+n.url+'">'+o+"</a></li>"}).join(""))});</script> <section class="widget"> <h3>Others</h3> <ul class="list-unstyled">  <li> <i class="fas fa-fw fa-rss"></i>  <a href="/rss2.xml" target="_blank">RSS Feed</a> |  <a href="/feed.xml" target="_blank">Atom</a> |  <a href="/feed.json" target="_blank">JSON</a> </li> <li> <i class="fas fa-fw fa-globe"></i>  <a href="https://stats.uptimerobot.com/BLK6VsRkR" target="_blank"> Sever Status </a> </li> <li> <i class="fas fa-fw fa-sitemap"></i>  <a href="https://lg.lantian.pub" target="_blank">DN42 Looking Glass</a> </li> <li> <i class="fas fa-fw fa-link"></i>  <a href="gopher://lantian.pub" target="_blank">Access with Gopher protocol</a> </li>  </ul> </section> <section class="widget"> <h3>Links</h3> <ul class="list-unstyled"> <li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://0x7f.cc"> 0x7f Blog 🐑 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="http://foreverblog.cn"> 10 Year&#39;s Promise (Forever Blog) </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://alanyhq.com"> Alanyhq </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.baoshuo.ren/?utm_source=friends"> Baoshuo&#39;s Blog </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.cas7.moe"> Blog of Moecast </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://jerryxiao.cc"> JerryXiao </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://sangsir.com"> SangSir </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://snli.org"> Shucheng Li </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://yuetau.net"> YuetAu&#39;s Spot </a> </li> </ul> </section> </aside> </div> <footer class="lantian clearfix" data-astro-cid-w3csb3e3="">  <div id="copyright" class="float-end text-end" data-astro-cid-w3csb3e3=""> <i class="fas fa-copyright" data-astro-cid-w3csb3e3=""></i> 2012-2025 Lan Tian @ Blog<br data-astro-cid-w3csb3e3=""> <small data-astro-cid-w3csb3e3=""> Powered by Astro v5.15.1 @ 2025-10-25 23:46:40 </small> </div> <script type="module">function v(c,o,r){const h=/^localhost$|^127(?:\.[0-9]+){0,2}\.[0-9]+$|^(?:0*:)*?:?0*1$/.test(location.hostname)||location.protocol==="file:";if(!o.trackLocalhost&&h)return console.warn("[Plausible] Ignoring event because website is running locally");try{if(window.localStorage.plausible_ignore==="true")return console.warn('[Plausible] Ignoring event because "plausible_ignore" is set to "true" in localStorage')}catch{}const p={n:c,u:o.url,d:o.domain,r:o.referrer,w:o.deviceWidth,h:o.hashMode?1:0,p:r&&r.props?JSON.stringify(r.props):void 0},s=new XMLHttpRequest;s.open("POST",`${o.apiHost}/api/event`,!0),s.setRequestHeader("Content-Type","text/plain"),s.send(JSON.stringify(p)),s.onreadystatechange=()=>{s.readyState===4&&r&&r.callback&&r.callback()}}function b(c){const o=()=>({hashMode:!1,trackLocalhost:!1,url:location.href,domain:location.hostname,referrer:document.referrer||null,deviceWidth:window.innerWidth,apiHost:"https://plausible.io",...c}),r=(t,n,i)=>{v(t,{...o(),...i},n)},h=(t,n)=>{r("pageview",n,t)};return{trackEvent:r,trackPageview:h,enableAutoPageviews:()=>{const t=()=>h(),n=history.pushState;return n&&(history.pushState=function(i,l,u){n.apply(this,[i,l,u]),t()},addEventListener("popstate",t)),c&&c.hashMode&&addEventListener("hashchange",t),h(),function(){n&&(history.pushState=n,removeEventListener("popstate",t)),c&&c.hashMode&&removeEventListener("hashchange",t)}},enableAutoOutboundTracking:(t=document,n={subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]})=>{function i(e){r("Outbound Link: Click",{props:{url:this.href}}),typeof process<"u"&&process,setTimeout(()=>{location.href=this.href},150),e.preventDefault()}const l=new Set;function u(e){e instanceof HTMLAnchorElement?e.host!==location.host&&(e.addEventListener("click",i),l.add(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(u)}function f(e){e instanceof HTMLAnchorElement?(e.removeEventListener("click",i),l.delete(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(f)}const d=new MutationObserver(e=>{e.forEach(a=>{a.type==="attributes"?(f(a.target),u(a.target)):a.type==="childList"&&(a.addedNodes.forEach(u),a.removedNodes.forEach(f))})});return t.querySelectorAll("a").forEach(u),d.observe(t,n),function(){l.forEach(a=>{a.removeEventListener("click",i)}),l.clear(),d.disconnect()}}}}const g=b({domain:"lantian.pub",trackLocalhost:!0,apiHost:""});g.trackPageview();</script> </footer>  </div>  </body> </html>