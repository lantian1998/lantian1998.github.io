<!DOCTYPE html><html lang="en-US" itemscope="" itemtype="https://schema.org/Article" data-astro-cid-porej7z2=""> <head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Installing and Upgrading ESXi on Kimsufi Dedicated Server and Setting Up a Software Router - Lan Tian @ Blog</title><script>
  ;(() => {
    try {
      const mode = localStorage.getItem('user-color-scheme')
      if (mode == 'dark' || mode == 'light') {
        document.documentElement.setAttribute('data-user-color-scheme', mode)
      }
    } catch {
      // Ignore errors
    }
  })()
</script><link rel="stylesheet" href="/assets/index.CUlf1-Vz.css"><style>#post-navi[data-astro-cid-gfbmwgei]{padding:5px;border-top:1px solid var(--lt-border-weak);border-bottom:1px solid var(--lt-border-weak)}
ol[data-astro-cid-nj3qel45]{margin:0;padding:0;line-height:1.5}ol[data-astro-cid-nj3qel45] .toc-item[data-astro-cid-nj3qel45]{list-style:none}ol[data-astro-cid-nj3qel45] .toc-child[data-astro-cid-nj3qel45],ol[data-astro-cid-nj3qel45] .toc[data-astro-cid-nj3qel45]{padding:0}ol[data-astro-cid-nj3qel45] .toc-link[data-astro-cid-nj3qel45]{display:block;margin-left:1em;padding:.25em 0}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:1em;padding:.25em 0;float:left;font-style:normal;font-variant:normal;font-weight:900;font-family:Font Awesome\ 6 Free;font-feature-settings:normal;text-align:center}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before{content:""}ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{content:""}.post-info-wrap[data-astro-cid-dckccua4]{-ms-flex:0 0 2.5em;flex:0 0 2.5em;background-color:var(--lt-component-bg-emphasis)}@media(min-width:768px){.post-info[data-astro-cid-dckccua4]{position:sticky;top:0}}@media(max-width:767.98px){.post-info[data-astro-cid-dckccua4]{position:absolute}}
</style><script type="module" src="/assets/PageLayout.astro_astro_type_script_index_0_lang.C1wfUPs6.js"></script><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="imagemode" content="force"><meta name="nightmode" content="disable"><meta name="wap-font-scale" content="no"><meta name="title" content="Installing and Upgrading ESXi on Kimsufi Dedicated Server and Setting Up a Software Router - Lan Tian @ Blog"><meta name="keywords" content=""><meta name="author" content="Lan Tian"><link rel="canonical" href="https://lantian.pub/en/article/modify-website/kimsufi-dedi-esxi-software-router.lantian/"><link rel="alternate" type="application/rss+xml" title="Lan Tian @ Blog" href="https://lantian.pub/rss2.xml"><link rel="alternate" type="application/atom+xml" title="Lan Tian @ Blog" href="https://lantian.pub/feed.xml"><link rel="alternate" href="https://lantian.pub/article/modify-website/kimsufi-dedi-esxi-software-router.lantian/" hreflang="zh"><link rel="alternate" href="https://lantian.pub/en/article/modify-website/kimsufi-dedi-esxi-software-router.lantian/" hreflang="en"><meta name="copyright" content="Copyright 2012-2025 Lan Tian @ Blog"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="manifest" href="/manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#03a9f4"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#212121"><meta name="application-name" content="Lan Tian @ Blog"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-precomposed.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#03a9f4"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lan Tian @ Blog"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1170x2532.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2532x1170.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1179x2556.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2556x1179.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1284x2778.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2778x1284.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1290x2796.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2796x1290.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1488x2266.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2266x1488.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1640x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1640.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"><meta name="msapplication-TileColor" content="#bbdefb"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta name="msapplication-config" content="/browserconfig.xml"><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"><meta property="og:url" content="https://lantian.pub/en/article/modify-website/kimsufi-dedi-esxi-software-router.lantian/"><meta property="og:type" content="website"><meta property="og:title" content="Installing and Upgrading ESXi on Kimsufi Dedicated Server and Setting Up a Software Router - Lan Tian @ Blog"><meta property="og:image" content="https://lantian.pub/usr/uploads/2018/06/4190919588.png"><meta content="Kimsufi is a budget brand under French company OVH, specializing in renting high-performance servers at extremely affordable prices. I personally rent the KS-4C model, featuring an i5-2400 processor, 16GB RAM, 2TB HDD, 100Mbps unmetered bandwidth, for just 13 euros/month. Its exceptional value makes it perfect for running virtual machines for experiments. VMware ESXi (now also called vSphere Hypervisor) and Proxmox VE are two popular operating systems specifically designed for virtualization, both available for free. Crucially, Kimsufi's control panel offers one-click installations for both systems. However, during my usage, I found that Proxmox VE frequently suffered from unresponsive remote VM connections (VNC black screens) or keystroke loss (especially critical during password entry)..."><meta property="og:site_name" content="Lan Tian @ Blog"><meta property="og:locale" content="en"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://lantian.pub/en/article/modify-website/kimsufi-dedi-esxi-software-router.lantian/"><meta name="twitter:title" content="Installing and Upgrading ESXi on Kimsufi Dedicated Server and Setting Up a Software Router - Lan Tian @ Blog"><meta property="twitter:image" content="https://lantian.pub/usr/uploads/2018/06/4190919588.png"><meta content="Kimsufi is a budget brand under French company OVH, specializing in renting high-performance servers at extremely affordable prices. I personally rent the KS-4C model, featuring an i5-2400 processor, 16GB RAM, 2TB HDD, 100Mbps unmetered bandwidth, for just 13 euros/month. Its exceptional value makes it perfect for running virtual machines for experiments. VMware ESXi (now also called vSphere Hypervisor) and Proxmox VE are two popular operating systems specifically designed for virtualization, both available for free. Crucially, Kimsufi's control panel offers one-click installations for both systems. However, during my usage, I found that Proxmox VE frequently suffered from unresponsive remote VM connections (VNC black screens) or keystroke loss (especially critical during password entry)..."><meta name="twitter:dnt" content="on"><meta itemprop="name" content="Installing and Upgrading ESXi on Kimsufi Dedicated Server and Setting Up a Software Router - Lan Tian @ Blog"><meta property="image" content="https://lantian.pub/usr/uploads/2018/06/4190919588.png"><meta content="Kimsufi is a budget brand under French company OVH, specializing in renting high-performance servers at extremely affordable prices. I personally rent the KS-4C model, featuring an i5-2400 processor, 16GB RAM, 2TB HDD, 100Mbps unmetered bandwidth, for just 13 euros/month. Its exceptional value makes it perfect for running virtual machines for experiments. VMware ESXi (now also called vSphere Hypervisor) and Proxmox VE are two popular operating systems specifically designed for virtualization, both available for free. Crucially, Kimsufi's control panel offers one-click installations for both systems. However, during my usage, I found that Proxmox VE frequently suffered from unresponsive remote VM connections (VNC black screens) or keystroke loss (especially critical during password entry)..."><meta content="Kimsufi is a budget brand under French company OVH, specializing in renting high-performance servers at extremely affordable prices. I personally rent the KS-4C model, featuring an i5-2400 processor, 16GB RAM, 2TB HDD, 100Mbps unmetered bandwidth, for just 13 euros/month. Its exceptional value makes it perfect for running virtual machines for experiments. VMware ESXi (now also called vSphere Hypervisor) and Proxmox VE are two popular operating systems specifically designed for virtualization, both available for free. Crucially, Kimsufi's control panel offers one-click installations for both systems. However, during my usage, I found that Proxmox VE frequently suffered from unresponsive remote VM connections (VNC black screens) or keystroke loss (especially critical during password entry)..."><link rel="me" href="https://mastodon.social/@lantian"></head> <body data-astro-cid-porej7z2=""> <div id="bg" data-astro-cid-j6vmxtef=""></div>   <div id="container" class="container" data-astro-cid-porej7z2=""> <nav class="lantian navbar navbar-expand-lg" data-astro-cid-wu5dj4rx=""> <div class="container-fluid" data-astro-cid-wu5dj4rx=""> <a class="navbar-brand" href="/en/" data-astro-cid-wu5dj4rx="">Lan Tian @ Blog</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#lantian-navbar" aria-controls="lantian-navbar" aria-expanded="false" aria-label="Toggle navigation" data-astro-cid-wu5dj4rx=""> <span class="navbar-toggler-icon" data-astro-cid-wu5dj4rx=""></span> </button> <div class="collapse navbar-collapse" id="lantian-navbar" data-astro-cid-wu5dj4rx=""> <ul class="navbar-nav" data-astro-cid-wu5dj4rx=""> <li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> <li class="nav-item dropdown d-block d-lg-none" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="pages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-file" data-astro-cid-wu5dj4rx=""></i> Page  <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="pages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> </ul> </li> </ul> <ul class="navbar-nav ms-auto" data-astro-cid-wu5dj4rx=""> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="languages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-language" data-astro-cid-wu5dj4rx=""></i> Language <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="languages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/article/modify-website/kimsufi-dedi-esxi-software-router.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-cn" data-astro-cid-wu5dj4rx=""></span> Chinese Simplified / 简体中文 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item active" href="/en/article/modify-website/kimsufi-dedi-esxi-software-router.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-us" data-astro-cid-wu5dj4rx=""></span> English </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">Not all pages have translations.</a> </li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">You may see 404 - this is normal.</a> </li> </ul> </li> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="color-scheme-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Night Mode </a> <ul class="dropdown-menu" aria-labelledby="color-scheme-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-auto" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Auto </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-light" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-sun" data-astro-cid-wu5dj4rx=""></i> Light</a> </li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-dark" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-moon" data-astro-cid-wu5dj4rx=""></i> Dark</a> </li> </ul> </li> </ul> </div> </div> </nav> <script type="module">const m="user-color-scheme",s="data-user-color-scheme",u=(e,t)=>{try{localStorage.setItem(e,t)}catch{}},i=e=>{try{return localStorage.getItem(e)}catch{return null}},c=e=>{const t={dark:!0,light:!0,auto:!0},o=e===null||!Object.keys(t).includes(e)?"auto":e;u(m,o);for(const l in t){const n=document.getElementById("color-scheme-"+l);n&&(l==o?n.classList.add("active"):n.classList.remove("active"))}o!="auto"?document.documentElement.setAttribute(s,o):document.documentElement.removeAttribute(s)};c(i(m));const r=document.getElementById("color-scheme-auto");r&&r.addEventListener("click",()=>c("auto"));const a=document.getElementById("color-scheme-light");a&&a.addEventListener("click",()=>c("light"));const d=document.getElementById("color-scheme-dark");d&&d.addEventListener("click",()=>c("dark"));</script>  <div class="d-flex" data-astro-cid-porej7z2=""> <div id="content" data-astro-cid-porej7z2="">  <article> <div class="d-flex"> <div class="post-info-wrap" data-astro-cid-dckccua4=""> <div class="post-info" data-astro-cid-dckccua4=""> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-clock"></span> <br> <small>06-06</small> </p> <div class="post-meta-value"> Published on<span class="badge badge-tag" data-astro-cid-dckccua4=""> 2018-06-06 17:22 </span>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-file-alt"></span> <br> <small>Website and Servers</small> </p> <div class="post-meta-value"> Category <a class="badge badge-tag" href="/en/category/modify-website" data-astro-cid-dckccua4=""> Website and Servers </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-tag"></span> <br> <small>2 tags</small> </p> <div class="post-meta-value"> Tags  <a class="badge badge-tag" href="/en/tag/Kimsufi" data-astro-cid-dckccua4=""> Kimsufi </a>  <a class="badge badge-tag" href="/en/tag/ESXi" data-astro-cid-dckccua4=""> ESXi </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-list"></span> <br> <small>ToC</small> </p> <div class="post-meta-value">  <ol data-astro-cid-nj3qel45=""> <li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#why-i-wrote-this-article" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Why I Wrote This Article</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#installing-esxi" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Installing ESXi</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#configuring-ipv6" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Configuring IPv6</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#installing-software-router" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Installing Software Router</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#disabling-ipv4" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Disabling IPv4</span> </a> </li> </ol>   </div> </div> </div> </div>  </div>  <div class="post-wrap"> <div class="post-image-wrap"> <picture> <source srcset="/usr/uploads/2018/06/4190919588.png.thumb.png.webp" type="image/webp"> <source srcset="/usr/uploads/2018/06/4190919588.png.thumb.png.avif" type="image/avif"> <source srcset="/usr/uploads/2018/06/4190919588.png.thumb.png.jxl" type="image/jxl"> <img src="/usr/uploads/2018/06/4190919588.png.thumb.png" alt="Illustration for Installing and Upgrading ESXi on Kimsufi Dedicated Server and Setting Up a Software Router" width="200" height="150"> </picture> </div> <h1 class="post-title"> <a href="/en/article/modify-website/kimsufi-dedi-esxi-software-router.lantian/" rel="bookmark" title="Installing and Upgrading ESXi on Kimsufi Dedicated Server and Setting Up a Software Router">Installing and Upgrading ESXi on Kimsufi Dedicated Server and Setting Up a Software Router</a> </h1> <div class="post-text">   <blockquote> <p>
This post is automatically translated with LLM. The translation content has
    NOT been reviewed and may contain errors.
</p> </blockquote><p>Kimsufi is a budget brand under French company OVH, specializing in renting high-performance servers at extremely affordable prices. I personally rent the KS-4C model, featuring an i5-2400 processor, 16GB RAM, 2TB HDD, 100Mbps unmetered bandwidth, for just 13 euros/month. Its exceptional value makes it perfect for running virtual machines for experiments.</p>
<p>VMware ESXi (now also called vSphere Hypervisor) and Proxmox VE are two popular operating systems specifically designed for virtualization, both available for free. Crucially, Kimsufi's control panel offers one-click installations for both systems. However, during my usage, I found that Proxmox VE frequently suffered from unresponsive remote VM connections (VNC black screens) or keystroke loss (especially critical during password entry) under poor network conditions, so I switched to ESXi.</p>
<p>This led to another issue: ESXi isn't a full-fledged Linux/FreeBSD system and lacks comprehensive NAT functionality, meaning it can't run multiple VMs behind one IP address with port forwarding. However, since Kimsufi provides both IPv4 and IPv6 addresses, we can assign the IPv4 to a VM while configuring ESXi to use IPv6, then set up that VM to handle NAT.</p>
<p>This is precisely what we'll accomplish in this article.</p>
<h2 id="why-i-wrote-this-article">Why I Wrote This Article</h2>
<p>Because I encountered numerous issues during configuration:</p>
<ol>
<li>The command-line online upgrade method for ESXi 5.0 no longer works and throws errors;</li>
<li>While ESXi 6's web interface is convenient for daily VM management (no client required), it contains bugs when configuring ESXi network settings.</li>
</ol>
<h2 id="installing-esxi">Installing ESXi</h2>
<p>The ESXi version provided by Kimsufi is extremely outdated (5.0), while the latest version at the time of writing was 6.7. Therefore, we must upgrade immediately after installation. However, due to VMware's policy changes, the following online upgrade method no longer works:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> software</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> profile</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> update</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -p</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ESXi-6.5.0-20170702001-standard</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -d</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://hostupdate.vmware.com/software/VUM/PRODUCTION/main/vmw-depot-index.xml</span></span></code></pre>
<p>Running this command on ESXi 5.0 results in XML format errors. Thus, we must use an offline installation package for local upgrading. But ESXi's wget doesn't support HTTPS, requiring an intermediate VPS for transfer.</p>
<p>Detailed steps:</p>
<ol>
<li>Connect via a proxy VPS (Shadowsocks) since VMware's download site verifies IP addresses.</li>
<li>Visit <a href="https://my.vmware.com/group/vmware/patch#search" rel="noopener noreferrer" target="_blank">https://my.vmware.com/group/vmware/patch#search</a>, select ESXi 6.0.0 (5.0 cannot upgrade directly to 6.5), click search to view patches:<br>
<picture><source srcset="/usr/uploads/2018/06/4190919588.png.webp" type="image/webp"><source srcset="/usr/uploads/2018/06/4190919588.png.avif" type="image/avif"><source srcset="/usr/uploads/2018/06/4190919588.png.jxl" type="image/jxl"><img src="/usr/uploads/2018/06/4190919588.png" alt="VMware Patch List"></picture></li>
<li>Scroll down to find any patch with a filename like <code>update-from-esxi6.0-6.0_update03</code>:<br>
<picture><source srcset="/usr/uploads/2018/06/162530643.png.webp" type="image/webp"><source srcset="/usr/uploads/2018/06/162530643.png.avif" type="image/avif"><source srcset="/usr/uploads/2018/06/162530643.png.jxl" type="image/jxl"><img src="/usr/uploads/2018/06/162530643.png" alt="Target Patch"></picture></li>
<li>Copy the download link, wget it on the VPS. After downloading, start an HTTP server on the VPS, then wget again from ESXi.</li>
<li>Click the KBxxxxxx link in the third column (KB2148155 in the image above).</li>
<li>Scroll down to the Image Profiles section on the new page:<br>
<picture><source srcset="/usr/uploads/2018/06/85829824.png.webp" type="image/webp"><source srcset="/usr/uploads/2018/06/85829824.png.avif" type="image/avif"><source srcset="/usr/uploads/2018/06/85829824.png.jxl" type="image/jxl"><img src="/usr/uploads/2018/06/85829824.png" alt="Image Profiles"></picture><br>
The name like <code>ESXi-6.0.0-20170202001-standard</code> is the target version name.</li>
<li>Run in ESXi's SSH:</li>
</ol>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> software</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> profile</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> update</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -d</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> [absolute_path_to_downloaded_zip] -p [version_name]</span></span></code></pre>
<p>Example:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> software</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> profile</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> update</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -d</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /vmfs/volumes/datastore1/update-from-esxi6.0-6.0_update03.zip</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -p</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ESXi-6.0.0-20170202001-standard</span></span></code></pre>
<p>Press Enter to execute the upgrade, then reboot.
8. Return to Step 2, select version 6.5.0 (no 6.7 upgrade file available at writing time), repeat the process.</p>
<p>After completing these steps, we have ESXi version 6.5.</p>
<h2 id="configuring-ipv6">Configuring IPv6</h2>
<p>Our goal is to assign IPv6 to ESXi and IPv4 to VMs. However, ESXi's web interface fails to save network settings properly, requiring CLI operations:</p>
<ol>
<li>Log into ESXi, enable IPv6 and reboot:</li>
</ol>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> network</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> set</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -e</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> true</span></span></code></pre>
<ol start="2">
<li>Enable IPv6 on the default NIC:</li>
</ol>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> network</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> interface</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ipv6</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> set</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -e</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> true</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -r</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> false</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vmk0</span></span></code></pre>
<ol start="3">
<li>Assuming your server's IPv6 is <code>2001:41d0:1:234::1</code>, your gateway is <code>2001:41d0:1:2ff:ff:ff:ff:ff</code> (refer to Kimsufi's IPv6 tutorials). Add two IPv6 addresses: your assigned IP and a random address in the same /64 subnet to allow gateway recognition:</li>
</ol>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> network</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> interface</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ipv6</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> address</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> add</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vmk0</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -I</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 2001:41d0:1:234::1</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> network</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> interface</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ipv6</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> address</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> add</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vmk0</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -I</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 2001:41d0:1:2ff:12:34:56:78</span></span></code></pre>
<ol start="4">
<li>Set default gateway:</li>
</ol>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> network</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> route</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ipv6</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> add</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -g</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 2001:41d0:1:2ff:ff:ff:ff:ff</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -n</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> default</span></span></code></pre>
<ol start="5">
<li>Ping from another IPv6-enabled VPS to confirm connectivity before proceeding.</li>
<li>If your local network lacks IPv6, consider using Cloudflare to proxy the server's IPv6 address for easier management.</li>
</ol>
<h2 id="installing-software-router">Installing Software Router</h2>
<p>I use pfSense as the software router. First download the pfSense ISO to ESXi (HTTP supported, no proxy needed):</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /vmfs/volumes/datastore1</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">wget</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> http://frafiles.pfsense.org/mirror/downloads/pfSense-CE-2.4.3-RELEASE-amd64.iso.gz</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">gunzip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> pfSense-CE-2.4.3-RELEASE-amd64.iso.gz</span></span></code></pre>
<p>In the web panel:</p>
<ul>
<li>Go to Networking > Virtual Switches, create a new vSwitch.</li>
<li>Under Port Groups, create a port group connected to this switch (this will be the internal network for VMs):<br>
<picture><source srcset="/usr/uploads/2018/06/1606507342.png.webp" type="image/webp"><source srcset="/usr/uploads/2018/06/1606507342.png.avif" type="image/avif"><source srcset="/usr/uploads/2018/06/1606507342.png.jxl" type="image/jxl"><img src="/usr/uploads/2018/06/1606507342.png" alt="New Port Group"></picture><br>
To allow ESXi to join the internal network:</li>
<li>Create another port group connected to the same switch:<br>
<picture><source srcset="/usr/uploads/2018/06/4199878051.png.webp" type="image/webp"><source srcset="/usr/uploads/2018/06/4199878051.png.avif" type="image/avif"><source srcset="/usr/uploads/2018/06/4199878051.png.jxl" type="image/jxl"><img src="/usr/uploads/2018/06/4199878051.png" alt="Second New Port Group"></picture></li>
<li>Under VMkernel NICs, create a virtual NIC connected to this port group with "Management" service:<br>
<picture><source srcset="/usr/uploads/2018/06/1501702341.png.webp" type="image/webp"><source srcset="/usr/uploads/2018/06/1501702341.png.avif" type="image/avif"><source srcset="/usr/uploads/2018/06/1501702341.png.jxl" type="image/jxl"><img src="/usr/uploads/2018/06/1501702341.png" alt="ESXi Joining Internal Network"></picture><br>
Copy the physical NIC's MAC address from the Physical NICs page. Since the datacenter binds IPs to MACs, we'll configure the VM to spoof the server's MAC address.</li>
</ul>
<p>Create the VM normally. Note:</p>
<ul>
<li>Set the first NIC's MAC to match the physical NIC, connecting it to "VM Network" (external network).</li>
<li>If connected via IPv4, ESXi management will disconnect briefly when the router boots (normal during IP conflict).</li>
<li>The router can now ping externally but TCP connections will reset. Next, disable ESXi's IPv4 to resolve the conflict.</li>
</ul>
<h2 id="disabling-ipv4">Disabling IPv4</h2>
<p>⚠️ High-risk operation! If IPv6 isn't working and IPv4 is disabled, the server becomes inaccessible (requires reinstall)! Double-check IPv6 functionality first!</p>
<p>From an IPv6-enabled VPS, SSH into the server and run:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> network</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> interface</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ipv4</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> set</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vmk0</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -t</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> none</span></span></code></pre>
<p>The software router should now have normal internet access.</p>
<p>To connect ESXi to the internal network:</p>
<ul>
<li>In the web panel (VMkernel NICs), modify the manually created vNIC's IP to match the internal network:<br>
<picture><source srcset="/usr/uploads/2018/06/3509596894.png.webp" type="image/webp"><source srcset="/usr/uploads/2018/06/3509596894.png.avif" type="image/avif"><source srcset="/usr/uploads/2018/06/3509596894.png.jxl" type="image/jxl"><img src="/usr/uploads/2018/06/3509596894.png" alt="Modifying vNIC Address"></picture></li>
<li>Run in ESXi SSH:</li>
</ul>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> network</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> route</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ipv4</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> add</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -g</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> [internal_gateway_ip] -n default</span></span></code></pre>
<p>Example:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">esxcli</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> network</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> route</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ipv4</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> add</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -g</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 172.18.254.1</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -n</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> default</span></span></code></pre>
<p>ESXi can now access IPv4 sites through the software router.</p>
<pre><code></code></pre>  </div>  <div class="clearfix" id="post-navi" data-astro-cid-gfbmwgei=""> <div class="float-end text-end" data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-website/write-config-file-let-thunderbird-autoconfig-domain-email.lantian/" title="Writing Configuration Files to Enable Thunderbird Auto-Configuration for Domain Email" data-astro-cid-gfbmwgei=""> Writing Configuration Files to Enable Thunderbird Auto-Configuration for Domain Email </a> <br data-astro-cid-gfbmwgei=""> Next post »
</div> <div class="float-start text-start position-absolute" data-astro-cid-gfbmwgei="">
« Previous post <br data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-website/nginx-tls-1-3-multiple-draft-and-hpack.lantian/" title="nginx: TLS 1.3 Multi-Draft Support and HPACK" data-astro-cid-gfbmwgei=""> nginx: TLS 1.3 Multi-Draft Support and HPACK </a> </div> </div>  <div id="waline" data-waline-language="en-US" data-waline-path="/en/article/modify-website/kimsufi-dedi-esxi-software-router.lantian"></div> <script type="module" src="/assets/WalineComment.astro_astro_type_script_index_0_lang.Dqib3X1E.js"></script>  </div> </div> </article>  </div> <aside class="d-none d-xl-block"> <section class="widget"> <h3>Latest posts</h3> <ul class="list-unstyled"> <li> 07-20  <a href="/en/article/modify-computer/legal-lte-network-at-home-with-open5gs.lantian/">Legal LTE Network at Home with Open5GS</a> </li><li> 06-27  <a href="/en/article/modify-computer/sidestore-without-stosvpn-across-lan.lantian/">Using SideStore without StosVPN across your LAN</a> </li><li> 05-19  <a href="/en/article/modify-computer/nix-logarithmetic-math-library-from-zero.lantian/">Nix Logarithmic Math Library from Ground Zero</a> </li><li> 04-06  <a href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/">Legal LTE Network at Home for $100</a> </li><li> 02-10  <a href="/en/article/modify-computer/build-custom-android-kernel-with-nix.lantian/">Building Custom Android Kernel with Nix</a> </li><li> 04-20  <a href="/en/article/modify-website/migrate-blog-to-astro-js.lantian/">Migrating My Blog to Astro.js</a> </li><li> 12-16  <a href="/en/article/modify-computer/nixos-low-ram-vps.lantian/">NixOS Series 5: Creating Disk Image for Low RAM VPS</a> </li><li> 09-20  <a href="/en/article/modify-computer/nix-trigonometric-math-library-from-zero.lantian/">Nix Trigonometric Math Library from Ground Zero</a> </li><li> 05-29  <a href="/en/article/random-notes/pipewire-sigkill-fix.lantian/">Preventing Pipewire from being SIGKILLed</a> </li><li> 05-12  <a href="/en/article/modify-website/how-to-kill-the-dn42-network.lantian/">How to Kill the DN42 Network (Updated 2023-05-12)</a> </li><li> 05-08  <a href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/">NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05)</a> </li><li> 04-17  <a href="/en/article/random-notes/fix-china-telecom-roaming-no-4g-on-aosp-rom.lantian/">Fix China Telecom 4G Roaming on AOSP ROM by Changing APN</a> </li><li> 03-26  <a href="/en/article/random-notes/old-hp-workstation-as-all-in-one.lantian/">Notes on Setting Up NAS+Router on Old HP Workstation</a> </li><li> 01-14  <a href="/en/article/modify-computer/nixos-impermanence.lantian/">NixOS Series 4: &quot;Stateless&quot; Operating System</a> </li><li> 06-21  <a href="/en/article/modify-computer/nixos-packaging.lantian/">NixOS Series 3: Software Packaging 101</a> </li> </ul> </section> <section class="widget"> <h3>Latest comments</h3> <ul class="list-unstyled" id="recent-comments">  <li><a href="#">Loading...</a></li>  </ul> </section> <script type="module">const i=window.location.hostname=="localhost"?"https://comments.lantian.pub":window.location.origin;fetch(`${i}/api/comment?type=recent&count=10`).then(t=>{if(t.status!==200)throw new Error(`Server returned bad HTTP status ${t.status}`);return t.json()}).then(t=>{const e=document.getElementById("recent-comments");e&&(e.innerHTML=t.data.map(n=>{const o=n.comment.replace(/(<([^>]+)>)/gi,"");return"<li>"+n.nick+' <a href="'+n.url+'">'+o+"</a></li>"}).join(""))});</script> <section class="widget"> <h3>Others</h3> <ul class="list-unstyled">  <li> <i class="fas fa-fw fa-rss"></i>  <a href="/rss2.xml" target="_blank">RSS Feed</a> |  <a href="/feed.xml" target="_blank">Atom</a> |  <a href="/feed.json" target="_blank">JSON</a> </li> <li> <i class="fas fa-fw fa-globe"></i>  <a href="https://stats.uptimerobot.com/BLK6VsRkR" target="_blank"> Sever Status </a> </li> <li> <i class="fas fa-fw fa-sitemap"></i>  <a href="https://lg.lantian.pub" target="_blank">DN42 Looking Glass</a> </li> <li> <i class="fas fa-fw fa-link"></i>  <a href="gopher://lantian.pub" target="_blank">Access with Gopher protocol</a> </li>  </ul> </section> <section class="widget"> <h3>Links</h3> <ul class="list-unstyled"> <li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://0x7f.cc"> 0x7f Blog 🐑 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="http://foreverblog.cn"> 10 Year&#39;s Promise (Forever Blog) </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://alanyhq.com"> Alanyhq </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.baoshuo.ren/?utm_source=friends"> Baoshuo&#39;s Blog </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.cas7.moe"> Blog of Moecast </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://jerryxiao.cc"> JerryXiao </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://sangsir.com"> SangSir </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://snli.org"> Shucheng Li </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://yuetau.net"> YuetAu&#39;s Spot </a> </li> </ul> </section> </aside> </div> <footer class="lantian clearfix" data-astro-cid-w3csb3e3="">  <div id="copyright" class="float-end text-end" data-astro-cid-w3csb3e3=""> <i class="fas fa-copyright" data-astro-cid-w3csb3e3=""></i> 2012-2025 Lan Tian @ Blog<br data-astro-cid-w3csb3e3=""> <small data-astro-cid-w3csb3e3=""> Powered by Astro v5.15.1 @ 2025-10-25 23:46:39 </small> </div> <script type="module">function v(c,o,r){const h=/^localhost$|^127(?:\.[0-9]+){0,2}\.[0-9]+$|^(?:0*:)*?:?0*1$/.test(location.hostname)||location.protocol==="file:";if(!o.trackLocalhost&&h)return console.warn("[Plausible] Ignoring event because website is running locally");try{if(window.localStorage.plausible_ignore==="true")return console.warn('[Plausible] Ignoring event because "plausible_ignore" is set to "true" in localStorage')}catch{}const p={n:c,u:o.url,d:o.domain,r:o.referrer,w:o.deviceWidth,h:o.hashMode?1:0,p:r&&r.props?JSON.stringify(r.props):void 0},s=new XMLHttpRequest;s.open("POST",`${o.apiHost}/api/event`,!0),s.setRequestHeader("Content-Type","text/plain"),s.send(JSON.stringify(p)),s.onreadystatechange=()=>{s.readyState===4&&r&&r.callback&&r.callback()}}function b(c){const o=()=>({hashMode:!1,trackLocalhost:!1,url:location.href,domain:location.hostname,referrer:document.referrer||null,deviceWidth:window.innerWidth,apiHost:"https://plausible.io",...c}),r=(t,n,i)=>{v(t,{...o(),...i},n)},h=(t,n)=>{r("pageview",n,t)};return{trackEvent:r,trackPageview:h,enableAutoPageviews:()=>{const t=()=>h(),n=history.pushState;return n&&(history.pushState=function(i,l,u){n.apply(this,[i,l,u]),t()},addEventListener("popstate",t)),c&&c.hashMode&&addEventListener("hashchange",t),h(),function(){n&&(history.pushState=n,removeEventListener("popstate",t)),c&&c.hashMode&&removeEventListener("hashchange",t)}},enableAutoOutboundTracking:(t=document,n={subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]})=>{function i(e){r("Outbound Link: Click",{props:{url:this.href}}),typeof process<"u"&&process,setTimeout(()=>{location.href=this.href},150),e.preventDefault()}const l=new Set;function u(e){e instanceof HTMLAnchorElement?e.host!==location.host&&(e.addEventListener("click",i),l.add(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(u)}function f(e){e instanceof HTMLAnchorElement?(e.removeEventListener("click",i),l.delete(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(f)}const d=new MutationObserver(e=>{e.forEach(a=>{a.type==="attributes"?(f(a.target),u(a.target)):a.type==="childList"&&(a.addedNodes.forEach(u),a.removedNodes.forEach(f))})});return t.querySelectorAll("a").forEach(u),d.observe(t,n),function(){l.forEach(a=>{a.removeEventListener("click",i)}),l.clear(),d.disconnect()}}}}const g=b({domain:"lantian.pub",trackLocalhost:!0,apiHost:""});g.trackPageview();</script> </footer>  </div>  </body> </html>