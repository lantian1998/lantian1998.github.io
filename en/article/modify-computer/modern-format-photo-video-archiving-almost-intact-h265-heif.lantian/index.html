<!DOCTYPE html><html lang="en-US" itemscope="" itemtype="https://schema.org/Article" data-astro-cid-porej7z2=""> <head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>(Almost) Lossless Archival with Modern Formats - H265 and HEIF - Lan Tian @ Blog</title><script>
  ;(() => {
    try {
      const mode = localStorage.getItem('user-color-scheme')
      if (mode == 'dark' || mode == 'light') {
        document.documentElement.setAttribute('data-user-color-scheme', mode)
      }
    } catch {
      // Ignore errors
    }
  })()
</script><link rel="stylesheet" href="/assets/index.CUlf1-Vz.css"><style>#post-navi[data-astro-cid-gfbmwgei]{padding:5px;border-top:1px solid var(--lt-border-weak);border-bottom:1px solid var(--lt-border-weak)}
ol[data-astro-cid-nj3qel45]{margin:0;padding:0;line-height:1.5}ol[data-astro-cid-nj3qel45] .toc-item[data-astro-cid-nj3qel45]{list-style:none}ol[data-astro-cid-nj3qel45] .toc-child[data-astro-cid-nj3qel45],ol[data-astro-cid-nj3qel45] .toc[data-astro-cid-nj3qel45]{padding:0}ol[data-astro-cid-nj3qel45] .toc-link[data-astro-cid-nj3qel45]{display:block;margin-left:1em;padding:.25em 0}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:1em;padding:.25em 0;float:left;font-style:normal;font-variant:normal;font-weight:900;font-family:Font Awesome\ 6 Free;font-feature-settings:normal;text-align:center}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before{content:""}ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{content:""}.post-info-wrap[data-astro-cid-dckccua4]{-ms-flex:0 0 2.5em;flex:0 0 2.5em;background-color:var(--lt-component-bg-emphasis)}@media(min-width:768px){.post-info[data-astro-cid-dckccua4]{position:sticky;top:0}}@media(max-width:767.98px){.post-info[data-astro-cid-dckccua4]{position:absolute}}
</style><script type="module" src="/assets/PageLayout.astro_astro_type_script_index_0_lang.C1wfUPs6.js"></script><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="imagemode" content="force"><meta name="nightmode" content="disable"><meta name="wap-font-scale" content="no"><meta name="title" content="(Almost) Lossless Archival with Modern Formats - H265 and HEIF - Lan Tian @ Blog"><meta name="keywords" content=""><meta name="author" content="Lan Tian"><link rel="canonical" href="https://lantian.pub/en/article/modify-computer/modern-format-photo-video-archiving-almost-intact-h265-heif.lantian/"><link rel="alternate" type="application/rss+xml" title="Lan Tian @ Blog" href="https://lantian.pub/rss2.xml"><link rel="alternate" type="application/atom+xml" title="Lan Tian @ Blog" href="https://lantian.pub/feed.xml"><link rel="alternate" href="https://lantian.pub/article/modify-computer/modern-format-photo-video-archiving-almost-intact-h265-heif.lantian/" hreflang="zh"><link rel="alternate" href="https://lantian.pub/en/article/modify-computer/modern-format-photo-video-archiving-almost-intact-h265-heif.lantian/" hreflang="en"><meta name="copyright" content="Copyright 2012-2025 Lan Tian @ Blog"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="manifest" href="/manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#03a9f4"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#212121"><meta name="application-name" content="Lan Tian @ Blog"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-precomposed.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#03a9f4"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lan Tian @ Blog"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1170x2532.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2532x1170.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1179x2556.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2556x1179.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1284x2778.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2778x1284.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1290x2796.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2796x1290.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1488x2266.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2266x1488.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1640x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1640.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"><meta name="msapplication-TileColor" content="#bbdefb"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta name="msapplication-config" content="/browserconfig.xml"><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"><meta property="og:url" content="https://lantian.pub/en/article/modify-computer/modern-format-photo-video-archiving-almost-intact-h265-heif.lantian/"><meta property="og:type" content="website"><meta property="og:title" content="(Almost) Lossless Archival with Modern Formats - H265 and HEIF - Lan Tian @ Blog"><meta property="og:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="Many people keep their inventory of photos and videos for their travels, parties, or whatever important moments of their lives. If you are into taking photos and recording videos and like keeping all of them, you will likely fill up hard drives after hard drives. If you don't want to keep adding more drives to your collection, you may also try to compress your photos and videos. Speaking of compression, a common method is to reduce the resolution of images. I've used the good old Microsoft Office Picture Manager (that comes with Office 2003) and its built-in one-key image compression. Behind the scenes, it's actually downsampling images to JPEG files of around 1024x768. One major drawback is that a lot of the details are completely lost...."><meta property="og:site_name" content="Lan Tian @ Blog"><meta property="og:locale" content="en"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://lantian.pub/en/article/modify-computer/modern-format-photo-video-archiving-almost-intact-h265-heif.lantian/"><meta name="twitter:title" content="(Almost) Lossless Archival with Modern Formats - H265 and HEIF - Lan Tian @ Blog"><meta property="twitter:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="Many people keep their inventory of photos and videos for their travels, parties, or whatever important moments of their lives. If you are into taking photos and recording videos and like keeping all of them, you will likely fill up hard drives after hard drives. If you don't want to keep adding more drives to your collection, you may also try to compress your photos and videos. Speaking of compression, a common method is to reduce the resolution of images. I've used the good old Microsoft Office Picture Manager (that comes with Office 2003) and its built-in one-key image compression. Behind the scenes, it's actually downsampling images to JPEG files of around 1024x768. One major drawback is that a lot of the details are completely lost...."><meta name="twitter:dnt" content="on"><meta itemprop="name" content="(Almost) Lossless Archival with Modern Formats - H265 and HEIF - Lan Tian @ Blog"><meta property="image" content="https://lantian.pub/apple-touch-icon.png"><meta content="Many people keep their inventory of photos and videos for their travels, parties, or whatever important moments of their lives. If you are into taking photos and recording videos and like keeping all of them, you will likely fill up hard drives after hard drives. If you don't want to keep adding more drives to your collection, you may also try to compress your photos and videos. Speaking of compression, a common method is to reduce the resolution of images. I've used the good old Microsoft Office Picture Manager (that comes with Office 2003) and its built-in one-key image compression. Behind the scenes, it's actually downsampling images to JPEG files of around 1024x768. One major drawback is that a lot of the details are completely lost...."><meta content="Many people keep their inventory of photos and videos for their travels, parties, or whatever important moments of their lives. If you are into taking photos and recording videos and like keeping all of them, you will likely fill up hard drives after hard drives. If you don't want to keep adding more drives to your collection, you may also try to compress your photos and videos. Speaking of compression, a common method is to reduce the resolution of images. I've used the good old Microsoft Office Picture Manager (that comes with Office 2003) and its built-in one-key image compression. Behind the scenes, it's actually downsampling images to JPEG files of around 1024x768. One major drawback is that a lot of the details are completely lost...."><link rel="me" href="https://mastodon.social/@lantian"></head> <body data-astro-cid-porej7z2=""> <div id="bg" data-astro-cid-j6vmxtef=""></div>   <div id="container" class="container" data-astro-cid-porej7z2=""> <nav class="lantian navbar navbar-expand-lg" data-astro-cid-wu5dj4rx=""> <div class="container-fluid" data-astro-cid-wu5dj4rx=""> <a class="navbar-brand" href="/en/" data-astro-cid-wu5dj4rx="">Lan Tian @ Blog</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#lantian-navbar" aria-controls="lantian-navbar" aria-expanded="false" aria-label="Toggle navigation" data-astro-cid-wu5dj4rx=""> <span class="navbar-toggler-icon" data-astro-cid-wu5dj4rx=""></span> </button> <div class="collapse navbar-collapse" id="lantian-navbar" data-astro-cid-wu5dj4rx=""> <ul class="navbar-nav" data-astro-cid-wu5dj4rx=""> <li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> <li class="nav-item dropdown d-block d-lg-none" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="pages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-file" data-astro-cid-wu5dj4rx=""></i> Page  <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="pages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> </ul> </li> </ul> <ul class="navbar-nav ms-auto" data-astro-cid-wu5dj4rx=""> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="languages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-language" data-astro-cid-wu5dj4rx=""></i> Language <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="languages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/article/modify-computer/modern-format-photo-video-archiving-almost-intact-h265-heif.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-cn" data-astro-cid-wu5dj4rx=""></span> Chinese Simplified / 简体中文 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item active" href="/en/article/modify-computer/modern-format-photo-video-archiving-almost-intact-h265-heif.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-us" data-astro-cid-wu5dj4rx=""></span> English </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">Not all pages have translations.</a> </li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">You may see 404 - this is normal.</a> </li> </ul> </li> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="color-scheme-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Night Mode </a> <ul class="dropdown-menu" aria-labelledby="color-scheme-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-auto" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Auto </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-light" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-sun" data-astro-cid-wu5dj4rx=""></i> Light</a> </li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-dark" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-moon" data-astro-cid-wu5dj4rx=""></i> Dark</a> </li> </ul> </li> </ul> </div> </div> </nav> <script type="module">const m="user-color-scheme",s="data-user-color-scheme",u=(e,t)=>{try{localStorage.setItem(e,t)}catch{}},i=e=>{try{return localStorage.getItem(e)}catch{return null}},c=e=>{const t={dark:!0,light:!0,auto:!0},o=e===null||!Object.keys(t).includes(e)?"auto":e;u(m,o);for(const l in t){const n=document.getElementById("color-scheme-"+l);n&&(l==o?n.classList.add("active"):n.classList.remove("active"))}o!="auto"?document.documentElement.setAttribute(s,o):document.documentElement.removeAttribute(s)};c(i(m));const r=document.getElementById("color-scheme-auto");r&&r.addEventListener("click",()=>c("auto"));const a=document.getElementById("color-scheme-light");a&&a.addEventListener("click",()=>c("light"));const d=document.getElementById("color-scheme-dark");d&&d.addEventListener("click",()=>c("dark"));</script>  <div class="d-flex" data-astro-cid-porej7z2=""> <div id="content" data-astro-cid-porej7z2="">  <article> <div class="d-flex"> <div class="post-info-wrap" data-astro-cid-dckccua4=""> <div class="post-info" data-astro-cid-dckccua4=""> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-clock"></span> <br> <small>02-13</small> </p> <div class="post-meta-value"> Published on<span class="badge badge-tag" data-astro-cid-dckccua4=""> 2020-02-13 15:05 </span>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-file-alt"></span> <br> <small>Computers and Clients</small> </p> <div class="post-meta-value"> Category <a class="badge badge-tag" href="/en/category/modify-computer" data-astro-cid-dckccua4=""> Computers and Clients </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-tag"></span> <br> <small>4 tags</small> </p> <div class="post-meta-value"> Tags  <a class="badge badge-tag" href="/en/tag/Image" data-astro-cid-dckccua4=""> Image </a>  <a class="badge badge-tag" href="/en/tag/Video" data-astro-cid-dckccua4=""> Video </a>  <a class="badge badge-tag" href="/en/tag/H265" data-astro-cid-dckccua4=""> H265 </a>  <a class="badge badge-tag" href="/en/tag/HEIF" data-astro-cid-dckccua4=""> HEIF </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-list"></span> <br> <small>ToC</small> </p> <div class="post-meta-value">  <ol data-astro-cid-nj3qel45=""> <li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#changelog" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Changelog</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#video-archival---h265" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Video Archival - H265</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#image-archival---heif" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Image Archival - HEIF</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#results" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Results</span> </a> </li> </ol>   </div> </div> </div> </div>  </div>  <div class="post-wrap">  <h1 class="post-title"> <a href="/en/article/modify-computer/modern-format-photo-video-archiving-almost-intact-h265-heif.lantian/" rel="bookmark" title="(Almost) Lossless Archival with Modern Formats - H265 and HEIF">(Almost) Lossless Archival with Modern Formats - H265 and HEIF</a> </h1> <div class="post-text">   <p>Many people keep their inventory of photos and videos for their travels,
parties, or whatever important moments of their lives. If you are into taking
photos and recording videos and like keeping all of them, you will likely fill
up hard drives after hard drives. If you don't want to keep adding more drives
to your collection, you may also try to compress your photos and videos.</p>
<p>Speaking of compression, a common method is to reduce the resolution of images.
I've used the good old Microsoft Office Picture Manager (that comes with
Office 2003) and its built-in one-key image compression. Behind the scenes, it's
actually downsampling images to JPEG files of around 1024x768. One major
drawback is that a lot of the details are completely lost. Even if you think you
can accept the losses by the time you archive the files, with the development of
technology, those losses may become significant one day. For example, in
mid-2000, a common monitor had a resolution of 1024x768, which is why Microsoft
Office Picture Manager chose to compress images to this resolution. But when
they are enlarged on a modern 1080p or even 4K monitor, the loss of details
makes images blurry, and such losses are irreversible.</p>
<p>Therefore, I wish that the quality is almost not affected at all while
compressing photos and videos. Help from modern video and image compression
algorithms is needed to achieve this. Early compression algorithms come with
limitations from their eras since they are unable to perform complicated
compression or decompression operations with the CPU performance and RAM size
limits and produce badly compressed files (larger in file size). Modern
algorithms, on the other hand, are designed with multicore processors and large
RAMs in mind and can compress the files to a smaller size. For example, the most
popular JPEG image format is invented back in 1992, and its compression rate is
being laughed at by WebP, invented in 2010. According to
<a href="https://developers.google.com/speed/webp/docs/webp_study" rel="noopener noreferrer" target="_blank">this study by Google</a>,
WebP is 25% smaller than JPEG for a set of sample files used. Another example is
LZMA used by 7-Zip, which fully utilizes multicore processors and eats a few
gigs of RAM, and in turn, produces results much smaller than Zip files' Deflate
algorithm.</p>
<p>In this post, I will use FFmpeg and ImageMagick, to convert all my videos to
H265 (HEVC) encoded MP4 files and my photos to HEIF.</p>
<h2 id="changelog">Changelog</h2>
<ul>
<li>2020-06-24: Fix an error with ImageMagick in Arch repo: it doesn't come with
HEIF support by default, but installing <code>libheif</code> can fix that. No need for
<code>imagemagick-full</code>.</li>
<li>2020-02-13: Initial version.</li>
</ul>
<h2 id="video-archival---h265">Video Archival - H265</h2>
<p>Here are the reasons I chose H265:</p>
<ul>
<li>H265 (invented in 2013) is newer than H264 (invented in 2003) and has a higher
compress rate.</li>
<li>According to <a href="https://trac.ffmpeg.org/wiki/Encode/H.265" rel="noopener noreferrer" target="_blank">FFmpeg's H265 page</a>,
compared to the popular H264, H265 files can be around 50% smaller at the same
quality.</li>
<li>Although older computers may have performance issues decoding H265 videos, its
hardware decoders are appearing on newer graphic cards and mobile devices.
With the widespread of hardware decoders, such obstacles will gradually go
away.</li>
<li>Current H265 software encoders are mature enough.</li>
</ul>
<p>Comparatively:</p>
<ul>
<li>While H264 is indeed popular with a ton of hardware and software decoders, it
is too old and cannot achieve a satisfying compression ratio.</li>
<li>VP9 is a free and open source video format created in 2013 by Google. Yes, it
costs money to use H265 in a commercial environment. According to
<a href="https://netflixtechblog.com/a-large-scale-comparison-of-x264-x265-and-libvpx-a-sneak-peek-2e81e88f8b0f" rel="noopener noreferrer" target="_blank">Netflix's report</a>,
at the same image quality, VP9 produces better compression rate than H264, but
worse than H265.
<ul>
<li>Since we are personal users, we don't care about H265's commercialization
costs; simply use it.</li>
</ul>
</li>
<li>AV1 was created by an alliance of corporations in 2018 to compete with the
costly commercial H265. The problem is that it's too new with immature
encoders, and may produce worse results than H265.</li>
</ul>
<p>While using FFmpeg to encode videos, we need to pay attention to parameter
selections to both prevent wasting space and prevent degrading image quality.</p>
<ul>
<li>H265 is just a video encoding format, and we need a corresponding encoder.
This is similar to writing a blog in Markdown, which I can do with either
Notepad, Word, or VS Code.
<ul>
<li>For H265 video archival, <strong>never use GPU hardware acceleration, even with a
2080 Ti</strong>. Hardware acceleration of graphic cards is primarily focused on
<strong>real-time</strong> processing, which is incredibly useful for online streaming
and game recording. But to achieve that, a lot of details are lost. In
addition, with limited space on the hardware encoding circuit on the silicon
chip, the hardware encoder cannot use all features of H265 and will produce
a larger file. You may think of this as "degraded to H264 level".
<ul>
<li>GPUs of the same generation share the same encoding/decoding circuit. The
only difference is thenumber of circuits. For example, GTX 1050 has one
set of circuit, while GTX 1080 Ti has two. This means that GTX 1080 Ti can
encode two streams simultaneously. But for each stream, the quality and
speed should be largely the same (assuming GPUs run at the same
frequency).</li>
<li>In fact, according to
<a href="https://developer.nvidia.com/video-encode-decode-gpu-support-matrix" rel="noopener noreferrer" target="_blank">NVIDIA's information</a>,
GPUs with only one set of circuit, such as 1050, can encode two streams at
the same time, and I guess it's achieved by switching back and forth.
However, don't expect much performance in this case. On another thought,
if you have to encode two streams at the same time, you can definitely
afford another 1050.</li>
</ul>
</li>
<li>The commonly used CPU encoder is <code>x265</code>, a runtime library that cannot be
executed directly. Therefore we will use <code>FFmpeg</code>, which calls x265 to
perform H265 encoding.</li>
<li>For H264, since NVIDIA's new hardware encoders are mature enough and can
achieve a similar quality compared to CPU encoding, you may try them on <strong>10
series or newer</strong> GPUs. However, I still recommend CPU encoding unless
you're unable to use it.</li>
<li>Similarly, the most popular CPU encoder for H264 is <code>x264</code>, also called by
FFmpeg.</li>
</ul>
</li>
<li>The parameter with the most impact on video quality is <code>Bitrate</code>, or the file
size of one second's video.
<ul>
<li>Usually, we don't manually specify bitrates for each video, as this will
need a lot of time. Instead, we use <code>CRF (Constant Rate Factor)</code> to set the
desired quality and let the software automatically determine a suitable
bitrate. <strong>A lower CRF means larger file and higher quality</strong>, and vice
versa.</li>
<li>For different encoding formats, the same CRF number refers to different
quality levels. For example, according to
<a href="https://trac.ffmpeg.org/wiki/Encode/H.265" rel="noopener noreferrer" target="_blank">FFmpeg's H265 page</a>, H264's CRF
23 is almost equivalent to H265's CRF 28 quality-wise.</li>
<li>For H265, according to
<a href="https://handbrake.fr/docs/en/latest/workflow/adjust-quality.html" rel="noopener noreferrer" target="_blank">HandBrake converter's doc</a>,
the common range of CRF for 4K resolution is 22-28, and 20-24 for 1080p. My
final choice of CRF is 22, as I consider it to be a balance point between
quality and size personally.</li>
<li>For H264, CRF is usually set to 17-24.</li>
<li>Bitrate doesn't impact encoding speed much.</li>
</ul>
</li>
<li>Another important factor is <code>preset</code> which sets the computational complexity
of the encoder to look for similar parts in the video and compress them, even
at the same bitrate.
<ul>
<li>For H264 and H265, <code>preset</code> can be set to:
<ul>
<li>ultrafast</li>
<li>superfast</li>
<li>veryfast</li>
<li>faster</li>
<li>fast</li>
<li>medium</li>
<li>slow</li>
<li>slower</li>
<li>veryslow</li>
<li>placebo</li>
</ul>
</li>
<li>For H265, since H265 encoding already takes ages, I chose <code>medium</code> (for
i7-7700HQ). If you're using something like a i9-9900K, i9-10980XE, or a
Threadripper 3990X, something with many many threads and super high clock
speeds, you may try <code>slow</code> or even <code>slower</code>.</li>
<li>For H264, since H264 encoding is much simpler (compared to H265), you may
start from <code>slower</code> and try <code>veryslow</code>.</li>
<li>If you set this parameter too high, the output file will not be much
smaller, but the time it takes will <strong>increase exponentially</strong>.</li>
</ul>
</li>
</ul>
<p>I'm doing the transcoding on Arch Linux. First install <code>x264</code> (optional), <code>x265</code>
and <code>FFmpeg</code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">sudo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> pacman</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -S</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ffmpeg</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> x265</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> x264</span></span></code></pre>
<p>Then <code>cd</code> to the directory containing your videos, and run this command (H265,
CRF 22, <code>medium</code>):</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">for</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080"> FILE</span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB"> in</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> **/*.mp4</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; </span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">do</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26"> ffmpeg</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -loglevel</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> quiet</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -stats</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">$FILE</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -c:v</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> libx265</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -crf</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 22</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -preset</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> medium</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -c:a</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> aac</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -b:a</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 128k</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -movflags</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> +faststart</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">$FILE</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">.converted.mp4"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; </span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">done</span></span></code></pre>
<p>Or this command (H264, CRF 17, <code>slower</code>):</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">for</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080"> FILE</span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB"> in</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> **/*.mp4</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; </span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">do</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26"> ffmpeg</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -loglevel</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> quiet</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -stats</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">$FILE</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -c:v</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> libx264</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -crf</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 17</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -preset</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> slower</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -c:a</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> aac</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -b:a</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 128k</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -movflags</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> +faststart</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">$FILE</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">.converted.mp4"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; </span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">done</span></span></code></pre>
<p>Since video encoding is slow, you may leave the computer transcoding while you
go to sleep. It may take a few hours and even up to a few days. As a reference,
by using the H265 command on my i7-7700HQ laptop, the speed factor is 0.065x, or
the computer will encode 0.065 seconds of video every real-world second, or 15
real-world seconds for 1 video second.</p>
<h2 id="image-archival---heif">Image Archival - HEIF</h2>
<p>Here are the reasons I chose HEIF:</p>
<ul>
<li>HEIF specification was finalized in 2015.</li>
<li>HEIF is currently widely used on iOS devices as the default format for
cameras. Android 9 also added support as well. In the foreseeable future,
software support for HEIF will become mature quickly.</li>
<li>The major advantage is that it uses H265 to encode photos, which fully
utilizes the maturity of video encoders. In addition, hardware acceleration
can be used if necessary.</li>
</ul>
<p>HEIF files can be generated by ImageMagick. But on Arch Linux, the ImageMagick
from Arch repo doesn't come with HEIF support by default, and we need to install
<code>libheif</code> additionally. We can also install <code>exiftool</code>, which copies EXIF
information (including camera model, aperture, shutter, ISO parameters,
locations, etc) to HEIF files.</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pikaur</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -S</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> imagemagick</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> libheif</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> perl-image-exiftool</span></span></code></pre>
<p>The next three commands convert all JPG files to HEIC (file extension for HEIF),
transfer EXIF information, and remove the JPG files:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">for</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080"> x</span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB"> in</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> **/*.jpg</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; </span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">do</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26"> magick</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">$x</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "${</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">x</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">%</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">jpg</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">}.heic"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; </span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">done</span></span>
<span class="line"><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">for</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080"> x</span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB"> in</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> **/*.jpg</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; </span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">do</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26"> exiftool</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -overwrite_original</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -tagsFromFile</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">$x</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -all:all</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "${</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">x</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">%</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">jpg</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">}.heic"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; </span><span style="--shiki-dark:#C586C0;--shiki-light:#AF00DB">done</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">rm</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -rf</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> **</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">/</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">*</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">.jpg</span></span></code></pre>
<p>The HEIC files produced should be around half the size of JPEG files.</p>
<p>There aren't many parameters to tune for HEIF, and the default settings are
enough for almost everyone. By contrast, in my testing, if I adjust quality with
parameters, the generated image will be huge (even larger than JPEG) but with no
noticeable differences in image quality.</p>
<h2 id="results">Results</h2>
<p>I compressed my photos and videos from 36 GB to 19 GB with the help of H265 and
HEIC, with no noticeable quality changes.</p>  </div>  <div class="clearfix" id="post-navi" data-astro-cid-gfbmwgei=""> <div class="float-end text-end" data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-website/powerdns-lua-diy-geodns.lantian/" title="Building GeoDNS with PowerDNS Lua Functionality for Regional DNS Resolution" data-astro-cid-gfbmwgei=""> Building GeoDNS with PowerDNS Lua Functionality for Regional DNS Resolution </a> <br data-astro-cid-gfbmwgei=""> Next post »
</div> <div class="float-start text-start position-absolute" data-astro-cid-gfbmwgei="">
« Previous post <br data-astro-cid-gfbmwgei=""> <a href="/en/article/creations/ladspa-plugin-frequency-splitter-bass-boost.lantian/" title="LADSPA Stereo Frequency Splitter &#38; Bass Booster" data-astro-cid-gfbmwgei=""> LADSPA Stereo Frequency Splitter &amp; Bass Booster </a> </div> </div>  <div id="waline" data-waline-language="en-US" data-waline-path="/en/article/modify-computer/modern-format-photo-video-archiving-almost-intact-h265-heif.lantian"></div> <script type="module" src="/assets/WalineComment.astro_astro_type_script_index_0_lang.Dqib3X1E.js"></script>  </div> </div> </article>  </div> <aside class="d-none d-xl-block"> <section class="widget"> <h3>Latest posts</h3> <ul class="list-unstyled"> <li> 07-20  <a href="/en/article/modify-computer/legal-lte-network-at-home-with-open5gs.lantian/">Legal LTE Network at Home with Open5GS</a> </li><li> 06-27  <a href="/en/article/modify-computer/sidestore-without-stosvpn-across-lan.lantian/">Using SideStore without StosVPN across your LAN</a> </li><li> 05-19  <a href="/en/article/modify-computer/nix-logarithmetic-math-library-from-zero.lantian/">Nix Logarithmic Math Library from Ground Zero</a> </li><li> 04-06  <a href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/">Legal LTE Network at Home for $100</a> </li><li> 02-10  <a href="/en/article/modify-computer/build-custom-android-kernel-with-nix.lantian/">Building Custom Android Kernel with Nix</a> </li><li> 04-20  <a href="/en/article/modify-website/migrate-blog-to-astro-js.lantian/">Migrating My Blog to Astro.js</a> </li><li> 12-16  <a href="/en/article/modify-computer/nixos-low-ram-vps.lantian/">NixOS Series 5: Creating Disk Image for Low RAM VPS</a> </li><li> 09-20  <a href="/en/article/modify-computer/nix-trigonometric-math-library-from-zero.lantian/">Nix Trigonometric Math Library from Ground Zero</a> </li><li> 05-29  <a href="/en/article/random-notes/pipewire-sigkill-fix.lantian/">Preventing Pipewire from being SIGKILLed</a> </li><li> 05-12  <a href="/en/article/modify-website/how-to-kill-the-dn42-network.lantian/">How to Kill the DN42 Network (Updated 2023-05-12)</a> </li><li> 05-08  <a href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/">NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05)</a> </li><li> 04-17  <a href="/en/article/random-notes/fix-china-telecom-roaming-no-4g-on-aosp-rom.lantian/">Fix China Telecom 4G Roaming on AOSP ROM by Changing APN</a> </li><li> 03-26  <a href="/en/article/random-notes/old-hp-workstation-as-all-in-one.lantian/">Notes on Setting Up NAS+Router on Old HP Workstation</a> </li><li> 01-14  <a href="/en/article/modify-computer/nixos-impermanence.lantian/">NixOS Series 4: &quot;Stateless&quot; Operating System</a> </li><li> 06-21  <a href="/en/article/modify-computer/nixos-packaging.lantian/">NixOS Series 3: Software Packaging 101</a> </li> </ul> </section> <section class="widget"> <h3>Latest comments</h3> <ul class="list-unstyled" id="recent-comments">  <li><a href="#">Loading...</a></li>  </ul> </section> <script type="module">const i=window.location.hostname=="localhost"?"https://comments.lantian.pub":window.location.origin;fetch(`${i}/api/comment?type=recent&count=10`).then(t=>{if(t.status!==200)throw new Error(`Server returned bad HTTP status ${t.status}`);return t.json()}).then(t=>{const e=document.getElementById("recent-comments");e&&(e.innerHTML=t.data.map(n=>{const o=n.comment.replace(/(<([^>]+)>)/gi,"");return"<li>"+n.nick+' <a href="'+n.url+'">'+o+"</a></li>"}).join(""))});</script> <section class="widget"> <h3>Others</h3> <ul class="list-unstyled">  <li> <i class="fas fa-fw fa-rss"></i>  <a href="/rss2.xml" target="_blank">RSS Feed</a> |  <a href="/feed.xml" target="_blank">Atom</a> |  <a href="/feed.json" target="_blank">JSON</a> </li> <li> <i class="fas fa-fw fa-globe"></i>  <a href="https://stats.uptimerobot.com/BLK6VsRkR" target="_blank"> Sever Status </a> </li> <li> <i class="fas fa-fw fa-sitemap"></i>  <a href="https://lg.lantian.pub" target="_blank">DN42 Looking Glass</a> </li> <li> <i class="fas fa-fw fa-link"></i>  <a href="gopher://lantian.pub" target="_blank">Access with Gopher protocol</a> </li>  </ul> </section> <section class="widget"> <h3>Links</h3> <ul class="list-unstyled"> <li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://0x7f.cc"> 0x7f Blog 🐑 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="http://foreverblog.cn"> 10 Year&#39;s Promise (Forever Blog) </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://alanyhq.com"> Alanyhq </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.baoshuo.ren/?utm_source=friends"> Baoshuo&#39;s Blog </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.cas7.moe"> Blog of Moecast </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://jerryxiao.cc"> JerryXiao </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://sangsir.com"> SangSir </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://snli.org"> Shucheng Li </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://yuetau.net"> YuetAu&#39;s Spot </a> </li> </ul> </section> </aside> </div> <footer class="lantian clearfix" data-astro-cid-w3csb3e3="">  <div id="copyright" class="float-end text-end" data-astro-cid-w3csb3e3=""> <i class="fas fa-copyright" data-astro-cid-w3csb3e3=""></i> 2012-2025 Lan Tian @ Blog<br data-astro-cid-w3csb3e3=""> <small data-astro-cid-w3csb3e3=""> Powered by Astro v5.15.1 @ 2025-10-25 23:46:39 </small> </div> <script type="module">function v(c,o,r){const h=/^localhost$|^127(?:\.[0-9]+){0,2}\.[0-9]+$|^(?:0*:)*?:?0*1$/.test(location.hostname)||location.protocol==="file:";if(!o.trackLocalhost&&h)return console.warn("[Plausible] Ignoring event because website is running locally");try{if(window.localStorage.plausible_ignore==="true")return console.warn('[Plausible] Ignoring event because "plausible_ignore" is set to "true" in localStorage')}catch{}const p={n:c,u:o.url,d:o.domain,r:o.referrer,w:o.deviceWidth,h:o.hashMode?1:0,p:r&&r.props?JSON.stringify(r.props):void 0},s=new XMLHttpRequest;s.open("POST",`${o.apiHost}/api/event`,!0),s.setRequestHeader("Content-Type","text/plain"),s.send(JSON.stringify(p)),s.onreadystatechange=()=>{s.readyState===4&&r&&r.callback&&r.callback()}}function b(c){const o=()=>({hashMode:!1,trackLocalhost:!1,url:location.href,domain:location.hostname,referrer:document.referrer||null,deviceWidth:window.innerWidth,apiHost:"https://plausible.io",...c}),r=(t,n,i)=>{v(t,{...o(),...i},n)},h=(t,n)=>{r("pageview",n,t)};return{trackEvent:r,trackPageview:h,enableAutoPageviews:()=>{const t=()=>h(),n=history.pushState;return n&&(history.pushState=function(i,l,u){n.apply(this,[i,l,u]),t()},addEventListener("popstate",t)),c&&c.hashMode&&addEventListener("hashchange",t),h(),function(){n&&(history.pushState=n,removeEventListener("popstate",t)),c&&c.hashMode&&removeEventListener("hashchange",t)}},enableAutoOutboundTracking:(t=document,n={subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]})=>{function i(e){r("Outbound Link: Click",{props:{url:this.href}}),typeof process<"u"&&process,setTimeout(()=>{location.href=this.href},150),e.preventDefault()}const l=new Set;function u(e){e instanceof HTMLAnchorElement?e.host!==location.host&&(e.addEventListener("click",i),l.add(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(u)}function f(e){e instanceof HTMLAnchorElement?(e.removeEventListener("click",i),l.delete(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(f)}const d=new MutationObserver(e=>{e.forEach(a=>{a.type==="attributes"?(f(a.target),u(a.target)):a.type==="childList"&&(a.addedNodes.forEach(u),a.removedNodes.forEach(f))})});return t.querySelectorAll("a").forEach(u),d.observe(t,n),function(){l.forEach(a=>{a.removeEventListener("click",i)}),l.clear(),d.disconnect()}}}}const g=b({domain:"lantian.pub",trackLocalhost:!0,apiHost:""});g.trackPageview();</script> </footer>  </div>  </body> </html>