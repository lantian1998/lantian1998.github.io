<!DOCTYPE html><html lang="en-US" itemscope="" itemtype="https://schema.org/Article" data-astro-cid-porej7z2=""> <head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Intel and NVIDIA GPU Passthrough on a Optimus MUXless Laptop - Lan Tian @ Blog</title><script>
  ;(() => {
    try {
      const mode = localStorage.getItem('user-color-scheme')
      if (mode == 'dark' || mode == 'light') {
        document.documentElement.setAttribute('data-user-color-scheme', mode)
      }
    } catch {
      // Ignore errors
    }
  })()
</script><link rel="stylesheet" href="/assets/index.CUlf1-Vz.css"><style>#post-navi[data-astro-cid-gfbmwgei]{padding:5px;border-top:1px solid var(--lt-border-weak);border-bottom:1px solid var(--lt-border-weak)}
ol[data-astro-cid-nj3qel45]{margin:0;padding:0;line-height:1.5}ol[data-astro-cid-nj3qel45] .toc-item[data-astro-cid-nj3qel45]{list-style:none}ol[data-astro-cid-nj3qel45] .toc-child[data-astro-cid-nj3qel45],ol[data-astro-cid-nj3qel45] .toc[data-astro-cid-nj3qel45]{padding:0}ol[data-astro-cid-nj3qel45] .toc-link[data-astro-cid-nj3qel45]{display:block;margin-left:1em;padding:.25em 0}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:1em;padding:.25em 0;float:left;font-style:normal;font-variant:normal;font-weight:900;font-family:Font Awesome\ 6 Free;font-feature-settings:normal;text-align:center}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before{content:""}ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{content:""}.post-info-wrap[data-astro-cid-dckccua4]{-ms-flex:0 0 2.5em;flex:0 0 2.5em;background-color:var(--lt-component-bg-emphasis)}@media(min-width:768px){.post-info[data-astro-cid-dckccua4]{position:sticky;top:0}}@media(max-width:767.98px){.post-info[data-astro-cid-dckccua4]{position:absolute}}
</style><script type="module" src="/assets/PageLayout.astro_astro_type_script_index_0_lang.C1wfUPs6.js"></script><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="imagemode" content="force"><meta name="nightmode" content="disable"><meta name="wap-font-scale" content="no"><meta name="title" content="Intel and NVIDIA GPU Passthrough on a Optimus MUXless Laptop - Lan Tian @ Blog"><meta name="keywords" content=""><meta name="author" content="Lan Tian"><link rel="canonical" href="https://lantian.pub/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/"><link rel="alternate" type="application/rss+xml" title="Lan Tian @ Blog" href="https://lantian.pub/rss2.xml"><link rel="alternate" type="application/atom+xml" title="Lan Tian @ Blog" href="https://lantian.pub/feed.xml"><link rel="alternate" href="https://lantian.pub/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" hreflang="zh"><link rel="alternate" href="https://lantian.pub/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" hreflang="en"><meta name="copyright" content="Copyright 2012-2025 Lan Tian @ Blog"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="manifest" href="/manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#03a9f4"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#212121"><meta name="application-name" content="Lan Tian @ Blog"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-precomposed.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#03a9f4"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lan Tian @ Blog"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1170x2532.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2532x1170.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1179x2556.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2556x1179.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1284x2778.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2778x1284.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1290x2796.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2796x1290.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1488x2266.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2266x1488.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1640x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1640.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"><meta name="msapplication-TileColor" content="#bbdefb"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta name="msapplication-config" content="/browserconfig.xml"><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"><meta property="og:url" content="https://lantian.pub/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/"><meta property="og:type" content="website"><meta property="og:title" content="Intel and NVIDIA GPU Passthrough on a Optimus MUXless Laptop - Lan Tian @ Blog"><meta property="og:image" content="https://lantian.pub/usr/uploads/202007/linus-torvalds-nvidia.png"><meta content="Changelog 2022-07-21: Add starting GVT-g on startup. Thanks to comment from Owsmyf (on Chinese version of this post). 2022-01-22: Revisions on NVIDIA driver updates and comments. I successfully passed through an Optimus MUXed GPU on my new laptop. Abstract (Spoiler Alert!) I successfully passed through Intel's GVT-g virtual GPU, as well as the dedicated NVIDIA GPU itself, into a virtual machine on Lenovo R720 gaming laptop. However, due to the limitation of the architecture itself, this GPU passthrough scheme is severely limited. For example, the dGPU is unusable in many games, and the performance is still relatively worse despite the complicated setup it needs. Therefore, you may attempt the passthrough purely for the fun of tinkering,..."><meta property="og:site_name" content="Lan Tian @ Blog"><meta property="og:locale" content="en"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://lantian.pub/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/"><meta name="twitter:title" content="Intel and NVIDIA GPU Passthrough on a Optimus MUXless Laptop - Lan Tian @ Blog"><meta property="twitter:image" content="https://lantian.pub/usr/uploads/202007/linus-torvalds-nvidia.png"><meta content="Changelog 2022-07-21: Add starting GVT-g on startup. Thanks to comment from Owsmyf (on Chinese version of this post). 2022-01-22: Revisions on NVIDIA driver updates and comments. I successfully passed through an Optimus MUXed GPU on my new laptop. Abstract (Spoiler Alert!) I successfully passed through Intel's GVT-g virtual GPU, as well as the dedicated NVIDIA GPU itself, into a virtual machine on Lenovo R720 gaming laptop. However, due to the limitation of the architecture itself, this GPU passthrough scheme is severely limited. For example, the dGPU is unusable in many games, and the performance is still relatively worse despite the complicated setup it needs. Therefore, you may attempt the passthrough purely for the fun of tinkering,..."><meta name="twitter:dnt" content="on"><meta itemprop="name" content="Intel and NVIDIA GPU Passthrough on a Optimus MUXless Laptop - Lan Tian @ Blog"><meta property="image" content="https://lantian.pub/usr/uploads/202007/linus-torvalds-nvidia.png"><meta content="Changelog 2022-07-21: Add starting GVT-g on startup. Thanks to comment from Owsmyf (on Chinese version of this post). 2022-01-22: Revisions on NVIDIA driver updates and comments. I successfully passed through an Optimus MUXed GPU on my new laptop. Abstract (Spoiler Alert!) I successfully passed through Intel's GVT-g virtual GPU, as well as the dedicated NVIDIA GPU itself, into a virtual machine on Lenovo R720 gaming laptop. However, due to the limitation of the architecture itself, this GPU passthrough scheme is severely limited. For example, the dGPU is unusable in many games, and the performance is still relatively worse despite the complicated setup it needs. Therefore, you may attempt the passthrough purely for the fun of tinkering,..."><meta content="Changelog 2022-07-21: Add starting GVT-g on startup. Thanks to comment from Owsmyf (on Chinese version of this post). 2022-01-22: Revisions on NVIDIA driver updates and comments. I successfully passed through an Optimus MUXed GPU on my new laptop. Abstract (Spoiler Alert!) I successfully passed through Intel's GVT-g virtual GPU, as well as the dedicated NVIDIA GPU itself, into a virtual machine on Lenovo R720 gaming laptop. However, due to the limitation of the architecture itself, this GPU passthrough scheme is severely limited. For example, the dGPU is unusable in many games, and the performance is still relatively worse despite the complicated setup it needs. Therefore, you may attempt the passthrough purely for the fun of tinkering,..."><link rel="me" href="https://mastodon.social/@lantian"></head> <body data-astro-cid-porej7z2=""> <div id="bg" data-astro-cid-j6vmxtef=""></div>   <div id="container" class="container" data-astro-cid-porej7z2=""> <nav class="lantian navbar navbar-expand-lg" data-astro-cid-wu5dj4rx=""> <div class="container-fluid" data-astro-cid-wu5dj4rx=""> <a class="navbar-brand" href="/en/" data-astro-cid-wu5dj4rx="">Lan Tian @ Blog</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#lantian-navbar" aria-controls="lantian-navbar" aria-expanded="false" aria-label="Toggle navigation" data-astro-cid-wu5dj4rx=""> <span class="navbar-toggler-icon" data-astro-cid-wu5dj4rx=""></span> </button> <div class="collapse navbar-collapse" id="lantian-navbar" data-astro-cid-wu5dj4rx=""> <ul class="navbar-nav" data-astro-cid-wu5dj4rx=""> <li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> <li class="nav-item dropdown d-block d-lg-none" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="pages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-file" data-astro-cid-wu5dj4rx=""></i> Page  <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="pages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> </ul> </li> </ul> <ul class="navbar-nav ms-auto" data-astro-cid-wu5dj4rx=""> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="languages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-language" data-astro-cid-wu5dj4rx=""></i> Language <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="languages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-cn" data-astro-cid-wu5dj4rx=""></span> Chinese Simplified / 简体中文 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item active" href="/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-us" data-astro-cid-wu5dj4rx=""></span> English </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">Not all pages have translations.</a> </li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">You may see 404 - this is normal.</a> </li> </ul> </li> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="color-scheme-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Night Mode </a> <ul class="dropdown-menu" aria-labelledby="color-scheme-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-auto" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Auto </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-light" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-sun" data-astro-cid-wu5dj4rx=""></i> Light</a> </li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-dark" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-moon" data-astro-cid-wu5dj4rx=""></i> Dark</a> </li> </ul> </li> </ul> </div> </div> </nav> <script type="module">const m="user-color-scheme",s="data-user-color-scheme",u=(e,t)=>{try{localStorage.setItem(e,t)}catch{}},i=e=>{try{return localStorage.getItem(e)}catch{return null}},c=e=>{const t={dark:!0,light:!0,auto:!0},o=e===null||!Object.keys(t).includes(e)?"auto":e;u(m,o);for(const l in t){const n=document.getElementById("color-scheme-"+l);n&&(l==o?n.classList.add("active"):n.classList.remove("active"))}o!="auto"?document.documentElement.setAttribute(s,o):document.documentElement.removeAttribute(s)};c(i(m));const r=document.getElementById("color-scheme-auto");r&&r.addEventListener("click",()=>c("auto"));const a=document.getElementById("color-scheme-light");a&&a.addEventListener("click",()=>c("light"));const d=document.getElementById("color-scheme-dark");d&&d.addEventListener("click",()=>c("dark"));</script>  <div class="d-flex" data-astro-cid-porej7z2=""> <div id="content" data-astro-cid-porej7z2="">  <article> <div class="d-flex"> <div class="post-info-wrap" data-astro-cid-dckccua4=""> <div class="post-info" data-astro-cid-dckccua4=""> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-clock"></span> <br> <small>06-25</small> </p> <div class="post-meta-value"> Published on<span class="badge badge-tag" data-astro-cid-dckccua4=""> 2020-06-25 23:59 </span>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-file-alt"></span> <br> <small>Computers and Clients</small> </p> <div class="post-meta-value"> Category <a class="badge badge-tag" href="/en/category/modify-computer" data-astro-cid-dckccua4=""> Computers and Clients </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-tag"></span> <br> <small>5 tags</small> </p> <div class="post-meta-value"> Tags  <a class="badge badge-tag" href="/en/tag/GPU" data-astro-cid-dckccua4=""> GPU </a>  <a class="badge badge-tag" href="/en/tag/Virtual-Machine" data-astro-cid-dckccua4=""> Virtual Machine </a>  <a class="badge badge-tag" href="/en/tag/Intel" data-astro-cid-dckccua4=""> Intel </a>  <a class="badge badge-tag" href="/en/tag/NVIDIA" data-astro-cid-dckccua4=""> NVIDIA </a>  <a class="badge badge-tag" href="/en/tag/MUXless" data-astro-cid-dckccua4=""> MUXless </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-list"></span> <br> <small>ToC</small> </p> <div class="post-meta-value">  <ol data-astro-cid-nj3qel45=""> <li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#changelog" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Changelog</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#abstract-spoiler-alert" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Abstract (Spoiler Alert!)</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#why" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Why?</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#my-environment" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">My Environment</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#stop-host-os-from-tampering-with-nvidia-gpu" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Stop Host OS from Tampering with NVIDIA GPU</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#setting-up-intel-gvt-g-virtual-igpu" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Setting up Intel GVT-g Virtual iGPU</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#setting-up-nvidia-dgpu-passthrough" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Setting up NVIDIA dGPU Passthrough</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#whats-next" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">What&#39;s Next?</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#references" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">References</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#appendix-final-libvirt-xml-file" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Appendix: Final Libvirt XML File</span> </a> </li> </ol>   </div> </div> </div> </div>  </div>  <div class="post-wrap"> <div class="post-image-wrap"> <picture> <source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.thumb.png.webp" type="image/webp"> <source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.thumb.png.avif" type="image/avif"> <source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.thumb.png.jxl" type="image/jxl"> <img src="/usr/uploads/202007/linus-torvalds-nvidia.png.thumb.png" alt="Illustration for Intel and NVIDIA GPU Passthrough on a Optimus MUXless Laptop" width="200" height="150"> </picture> </div> <h1 class="post-title"> <a href="/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/" rel="bookmark" title="Intel and NVIDIA GPU Passthrough on a Optimus MUXless Laptop">Intel and NVIDIA GPU Passthrough on a Optimus MUXless Laptop</a> </h1> <div class="post-text">   <h2 id="changelog">Changelog</h2>
<p>2022-07-21: Add starting GVT-g on startup. Thanks to comment from Owsmyf (on
Chinese version of this post). 2022-01-22: Revisions on NVIDIA driver updates
and comments.</p>
<blockquote>
<p><a href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian">I successfully passed through an Optimus MUXed GPU on my new laptop.</a></p>
</blockquote>
<h2 id="abstract-spoiler-alert">Abstract (Spoiler Alert!)</h2>
<p>I successfully passed through Intel's GVT-g virtual GPU, as well as the
dedicated NVIDIA GPU itself, into a virtual machine on Lenovo R720 gaming
laptop.</p>
<p>However, due to the limitation of the architecture itself, this GPU passthrough
scheme is severely limited. For example, the dGPU is unusable in many games, and
the performance is still relatively worse despite the complicated setup it
needs.</p>
<p>Therefore, you may attempt the passthrough purely for the fun of tinkering, but
I don't recommend using it for anything important.</p>
<h2 id="why">Why?</h2>
<p>I do my daily routines, including web browsing and coding, on Arch Linux, and I
rarely boot into the dual-booted Windows that exists alongside Linux. But
sometimes I had to boot to Windows when, for example, I wanted to play games
with my friends.</p>
<blockquote>
<p>Although there are compatibility layers, such as Wine and Proton, to run
Windows programs, as well as DXVK that translates DirectX commands to Vulkan
for some 3D performance boost, there are still lots of games that won't work
under Wine, such as those games with DRM or anti-cheat protection, or some
games that call <del>strange</del> private Windows APIs.</p>
</blockquote>
<p>But dual-booting means I have to maintain two operating systems, including their
system updates, data sharing, and synchronization. For instance, I had to run a
Hyper-V virtual machine running Linux and passthrough the disk with the Linux
ZFS partition and share the files over Samba in order to access them from
Windows.</p>
<blockquote>
<p>Instant 1GB less memory, and it takes 2-3 minutes to connect to the share
after logging on.</p>
</blockquote>
<p>On the other hand, traditional virtual machine hypervisors (QEMU, VirtualBox,
VMware, etc.) have <strong>horrible</strong> 3D performance.</p>
<ul>
<li>QEMU: What is 3D acceleration anyway?
<ul>
<li>For QXL, which only supports 2D acceleration</li>
<li>There is an attempt in 3D acceleration called Virtio-GPU, but it's
incomplete and doesn't support Windows (yet)</li>
</ul>
</li>
<li>VirtualBox: Better than nothing
<ul>
<li>It supports a fraction of DirectX APIs but is incomplete</li>
<li>And on my system VirtualBox sometimes outputs corrupted images with 2D
acceleration</li>
<li>And on my system VirtualBox sometimes freezes (compatibility problem with
ZFS?)</li>
</ul>
</li>
<li>VMware: Best among the three
<ul>
<li>Still, not enough</li>
<li>And it's closed source and requires a fee</li>
</ul>
</li>
</ul>
<p>Another common solution is the PCIe passthrough functionality of the VM
hypervisor, which gives full control of the high-performance GPU to the VM,
where it directly runs the official drivers and talks to the GPU.</p>
<ul>
<li>You'll need a CPU that supports either VT-d (Intel) or AMD-Vi (AMD), but you'd
be fine with CPUs made in recent years
<ul>
<li>Unless you are <del>filming Scrapyard Wars</del> picking up old PC components</li>
</ul>
</li>
<li>And you'll need at least 2 GPUs (including integrated ones)
<ul>
<li>Since the high-performance GPU is taken by the VM, the host system cannot
display anything without another GPU</li>
</ul>
</li>
<li>And you'll need a hypervisor that supports PCIe passthrough
<ul>
<li>VirtualBox and VMware Workstation can't do this (as far as I know)</li>
<li>VMware ESXi (an OS dedicated to virtualization) can do this
<ul>
<li>Free for personal users with a simple web UI</li>
<li>But closed-source, picky on network cards, and is a resource hog (on RAM,
for example)</li>
</ul>
</li>
<li>Proxmox VE can do this as well
<ul>
<li>A Debian-based OS for virtualization</li>
<li>The system itself is open source and free, but it charges a fee on
technical support</li>
<li>Based on QEMU</li>
</ul>
</li>
<li>Or simply install QEMU on your Linux distribution
<ul>
<li>QEMU: free and open-source, <del>the chosen one (by multiple Linux VM
solutions)</del></li>
<li>You need to type a long command to start the VM, but easier management is
possible with Libvirt and Virt-manager</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>But for NVIDIA GPUs and laptops, things are more complicated:</p>
<ul>
<li>
<p>NVIDIA drivers refuse to load in VMs</p>
<ul>
<li>NVIDIA doesn't want you to go with a consumer card that costs a mere few
hundred dollars. They want you to spend thousands on a GRID GPU dedicated to
virtualization.
<ul>
<li><picture><source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.webp" type="image/webp"><source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.avif" type="image/avif"><source srcset="/usr/uploads/202007/linus-torvalds-nvidia.png.jxl" type="image/jxl"><img src="/usr/uploads/202007/linus-torvalds-nvidia.png" alt="Linus Torvalds Fxxk Nvidia"></picture></li>
</ul>
</li>
<li>Therefore, you need a lot of hacks to hide the fact that you're running a VM
and make NVIDIA drivers load.
<ul>
<li>Will be discussed in detail later.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Laptop NVIDIA GPUs are different from desktop GPUs</p>
<ul>
<li>
<p>No, I don't just mean performance. The overall architecture is also
different.</p>
</li>
<li>
<p>On a desktop, the GPU is connected in the following scheme:</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!-- Generated by graphviz version 14.0.2 (0)
 --><!-- Pages: 1 -->
<svg width="262pt" height="98pt" viewBox="0.00 0.00 262.00 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<polygon fill="white" stroke="none" points="-4,4 -4,-94 257.66,-94 257.66,4 -4,4"></polygon><!-- CPU -->
<g id="node1" class="node">
<title>CPU</title>
<polygon fill="none" stroke="black" points="54,-63 0,-63 0,-27 54,-27 54,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="27" y="-40.8" font-family="Times,serif" font-size="14.00">CPU</text>
</g><!-- NVIDIA -->
<g id="node2" class="node">
<title>NVIDIA</title>
<polygon fill="none" stroke="black" points="155.77,-63 90,-63 90,-27 155.77,-27 155.77,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="122.88" y="-40.8" font-family="Times,serif" font-size="14.00">NVIDIA</text>
</g><!-- CPU&#45;&gt;NVIDIA -->
<g id="edge1" class="edge">
<title>CPU->NVIDIA</title>
<path fill="none" stroke="black" d="M54.4,-45C61.85,-45 70.15,-45 78.32,-45"></path>
<polygon fill="black" stroke="black" points="78.16,-48.5 88.16,-45 78.16,-41.5 78.16,-48.5"></polygon>
</g><!-- HDMI -->
<g id="node3" class="node">
<title>HDMI</title>
<polygon fill="none" stroke="black" points="249.71,-90 195.71,-90 195.71,-54 249.71,-54 249.71,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="222.71" y="-67.8" font-family="Times,serif" font-size="14.00">HDMI</text>
</g><!-- NVIDIA&#45;&gt;HDMI -->
<g id="edge2" class="edge">
<title>NVIDIA->HDMI</title>
<path fill="none" stroke="black" d="M156.19,-53.92C165.21,-56.41 175.08,-59.13 184.37,-61.69"></path>
<polygon fill="black" stroke="black" points="183.28,-65.02 193.85,-64.31 185.14,-58.28 183.28,-65.02"></polygon>
</g><!-- Monitor -->
<g id="node4" class="node">
<title>Monitor</title>
<polygon fill="none" stroke="black" points="253.66,-36 191.77,-36 191.77,0 253.66,0 253.66,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="222.71" y="-13.8" font-family="Times,serif" font-size="14.00">Monitor</text>
</g><!-- NVIDIA&#45;&gt;Monitor -->
<g id="edge3" class="edge">
<title>NVIDIA->Monitor</title>
<path fill="none" stroke="black" d="M156.19,-36.08C163.99,-33.93 172.44,-31.6 180.59,-29.35"></path>
<polygon fill="black" stroke="black" points="181.26,-32.79 189.97,-26.76 179.4,-26.05 181.26,-32.79"></polygon>
</g>
</g>
</svg>
</p>
<p>The GPU only connects to the CPU and monitors and doesn't care about other
components.</p>
</li>
<li>
<p>But on laptops, things are different. They even differ between laptops.</p>
<ul>
<li>
<p>If you spent a few hundred dollars on a low-to-mid-range gaming laptop,
the connections may look like:</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!-- Generated by graphviz version 14.0.2 (0)
 --><!-- Pages: 1 -->
<svg width="269pt" height="125pt" viewBox="0.00 0.00 269.00 125.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 121)">
<polygon fill="white" stroke="none" points="-4,4 -4,-121 265.05,-121 265.05,4 -4,4"></polygon><!-- CPU -->
<g id="node1" class="node">
<title>CPU</title>
<polygon fill="none" stroke="black" points="54,-90 0,-90 0,-54 54,-54 54,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="27" y="-67.8" font-family="Times,serif" font-size="14.00">CPU</text>
</g><!-- NVIDIA -->
<g id="node2" class="node">
<title>NVIDIA</title>
<polygon fill="none" stroke="black" points="159.46,-117 93.7,-117 93.7,-81 159.46,-81 159.46,-117"></polygon>
<text xml:space="preserve" text-anchor="middle" x="126.58" y="-94.8" font-family="Times,serif" font-size="14.00">NVIDIA</text>
</g><!-- CPU&#45;&gt;NVIDIA -->
<g id="edge1" class="edge">
<title>CPU->NVIDIA</title>
<path fill="none" stroke="black" d="M54.41,-79.31C63.01,-81.69 72.79,-84.39 82.3,-87.02"></path>
<polygon fill="black" stroke="black" points="81.2,-90.35 91.78,-89.65 83.07,-83.61 81.2,-90.35"></polygon>
</g><!-- Intel GPU -->
<g id="node3" class="node">
<title>Intel GPU</title>
<polygon fill="none" stroke="black" points="163.16,-63 90,-63 90,-27 163.16,-27 163.16,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="126.58" y="-40.8" font-family="Times,serif" font-size="14.00">Intel GPU</text>
</g><!-- CPU&#45;&gt;Intel GPU -->
<g id="edge2" class="edge">
<title>CPU->Intel GPU</title>
<path fill="none" stroke="black" d="M54.41,-64.69C61.94,-62.61 70.39,-60.27 78.75,-57.96"></path>
<polygon fill="black" stroke="black" points="79.46,-61.39 88.17,-55.35 77.6,-54.65 79.46,-61.39"></polygon>
</g><!-- NVIDIA&#45;&gt;Intel GPU -->
<g id="edge3" class="edge">
<title>NVIDIA->Intel GPU</title>
<path fill="none" stroke="black" d="M126.58,-80.51C126.58,-78.52 126.58,-76.53 126.58,-74.54"></path>
<polygon fill="black" stroke="black" points="130.08,-74.65 126.58,-64.65 123.08,-74.65 130.08,-74.65"></polygon>
</g><!-- HDMI -->
<g id="node4" class="node">
<title>HDMI</title>
<polygon fill="none" stroke="black" points="257.11,-90 203.11,-90 203.11,-54 257.11,-54 257.11,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="230.11" y="-67.8" font-family="Times,serif" font-size="14.00">HDMI</text>
</g><!-- Intel GPU&#45;&gt;HDMI -->
<g id="edge4" class="edge">
<title>Intel GPU->HDMI</title>
<path fill="none" stroke="black" d="M163.66,-54.6C172.82,-57.03 182.67,-59.65 191.89,-62.1"></path>
<polygon fill="black" stroke="black" points="190.69,-65.4 201.25,-64.59 192.49,-58.64 190.69,-65.4"></polygon>
</g><!-- Monitor -->
<g id="node5" class="node">
<title>Monitor</title>
<polygon fill="none" stroke="black" points="261.05,-36 199.16,-36 199.16,0 261.05,0 261.05,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="230.11" y="-13.8" font-family="Times,serif" font-size="14.00">Monitor</text>
</g><!-- Intel GPU&#45;&gt;Monitor -->
<g id="edge5" class="edge">
<title>Intel GPU->Monitor</title>
<path fill="none" stroke="black" d="M163.66,-35.4C171.49,-33.32 179.82,-31.11 187.83,-28.98"></path>
<polygon fill="black" stroke="black" points="188.62,-32.39 197.38,-26.44 186.82,-25.62 188.62,-32.39"></polygon>
</g>
</g>
</svg>
</p>
<p>The difference is, instead of directly connecting to the monitor, the dGPU
transfers the rendered image to iGPU, which in turn sends them to the
monitor.</p>
<p>It is called the MUXless scheme of NVIDIA Optimus.</p>
<ul>
<li>Pros:
<ul>
<li>Saves battery juice (dGPU turns off when not needed)</li>
<li>Saves cost (compared to other schemes)</li>
</ul>
</li>
<li>Cons:
<ul>
<li>High latency when rendering game frames (since an extra transfer is
required)</li>
<li>Severe technical difficulty when passing through the GPU:
<ul>
<li>Windows prefers to run games on the GPU connected to the current
monitor.
<ul>
<li>Since the dGPU isn't connected to any monitor, games won't prefer
to use the dGPU. Instead, they will use the low-performance
virtualized GPU (ex. QXL) or the Intel GVT-g virtual GPU (with
Intel-level performance).</li>
</ul>
</li>
<li>In the combination of Intel + NVIDIA Optimus, NVIDIA drivers are in
charge of moving the workload to dGPU.
<ul>
<li>But NVIDIA drivers won't accept Intel GVT-g into the combination,
and Optimus won't be enabled.</li>
</ul>
</li>
<li>This means games will run on the integrated graphics unless the game
engine proactively detects and uses the dGPU.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>If you spent a bit more than a thousand on a mid-to-higher-range laptop,
you may get:</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!-- Generated by graphviz version 14.0.2 (0)
 --><!-- Pages: 1 -->
<svg width="269pt" height="98pt" viewBox="0.00 0.00 269.00 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<polygon fill="white" stroke="none" points="-4,4 -4,-94 265.05,-94 265.05,4 -4,4"></polygon><!-- CPU -->
<g id="node1" class="node">
<title>CPU</title>
<polygon fill="none" stroke="black" points="54,-63 0,-63 0,-27 54,-27 54,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="27" y="-40.8" font-family="Times,serif" font-size="14.00">CPU</text>
</g><!-- NVIDIA -->
<g id="node2" class="node">
<title>NVIDIA</title>
<polygon fill="none" stroke="black" points="159.46,-90 93.7,-90 93.7,-54 159.46,-54 159.46,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="126.58" y="-67.8" font-family="Times,serif" font-size="14.00">NVIDIA</text>
</g><!-- CPU&#45;&gt;NVIDIA -->
<g id="edge1" class="edge">
<title>CPU->NVIDIA</title>
<path fill="none" stroke="black" d="M54.41,-52.31C63.01,-54.69 72.79,-57.39 82.3,-60.02"></path>
<polygon fill="black" stroke="black" points="81.2,-63.35 91.78,-62.65 83.07,-56.61 81.2,-63.35"></polygon>
</g><!-- Intel GPU -->
<g id="node3" class="node">
<title>Intel GPU</title>
<polygon fill="none" stroke="black" points="163.16,-36 90,-36 90,0 163.16,0 163.16,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="126.58" y="-13.8" font-family="Times,serif" font-size="14.00">Intel GPU</text>
</g><!-- CPU&#45;&gt;Intel GPU -->
<g id="edge2" class="edge">
<title>CPU->Intel GPU</title>
<path fill="none" stroke="black" d="M54.41,-37.69C61.94,-35.61 70.39,-33.27 78.75,-30.96"></path>
<polygon fill="black" stroke="black" points="79.46,-34.39 88.17,-28.35 77.6,-27.65 79.46,-34.39"></polygon>
</g><!-- NVIDIA&#45;&gt;Intel GPU -->
<g id="edge3" class="edge">
<title>NVIDIA->Intel GPU</title>
<path fill="none" stroke="black" d="M126.58,-53.51C126.58,-47.72 126.58,-41.93 126.58,-36.14"></path>
</g><!-- HDMI -->
<g id="node4" class="node">
<title>HDMI</title>
<polygon fill="none" stroke="black" points="257.11,-90 203.11,-90 203.11,-54 257.11,-54 257.11,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="230.11" y="-67.8" font-family="Times,serif" font-size="14.00">HDMI</text>
</g><!-- NVIDIA&#45;&gt;HDMI -->
<g id="edge6" class="edge">
<title>NVIDIA->HDMI</title>
<path fill="none" stroke="black" d="M159.7,-72C169.75,-72 180.93,-72 191.32,-72"></path>
<polygon fill="black" stroke="black" points="191.12,-75.5 201.12,-72 191.12,-68.5 191.12,-75.5"></polygon>
</g><!-- Monitor -->
<g id="node5" class="node">
<title>Monitor</title>
<polygon fill="none" stroke="black" points="261.05,-36 199.16,-36 199.16,0 261.05,0 261.05,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="230.11" y="-13.8" font-family="Times,serif" font-size="14.00">Monitor</text>
</g><!-- NVIDIA&#45;&gt;Monitor -->
<g id="edge7" class="edge">
<title>NVIDIA->Monitor</title>
<path fill="none" stroke="black" d="M159.7,-54.91C169.02,-49.96 179.3,-44.49 189.04,-39.31"></path>
<polygon fill="black" stroke="black" points="190.4,-42.55 197.58,-34.77 187.11,-36.37 190.4,-42.55"></polygon>
</g><!-- Intel GPU&#45;&gt;HDMI -->
<g id="edge4" class="edge">
<title>Intel GPU->HDMI</title>
<path fill="none" stroke="black" d="M162.24,-36.43C172.04,-41.65 182.74,-47.34 192.65,-52.61"></path>
<polygon fill="black" stroke="black" points="190.81,-55.6 201.28,-57.2 194.1,-49.42 190.81,-55.6"></polygon>
</g><!-- Intel GPU&#45;&gt;Monitor -->
<g id="edge5" class="edge">
<title>Intel GPU->Monitor</title>
<path fill="none" stroke="black" d="M163.66,-18C171.4,-18 179.63,-18 187.55,-18"></path>
<polygon fill="black" stroke="black" points="187.33,-21.5 197.33,-18 187.33,-14.5 187.33,-21.5"></polygon>
</g>
</g>
</svg>
</p>
<p>Compared to the last scheme, there is a switch on the motherboard circuit,
and the HDMI port and the monitor can be allocated to different GPUs
on-demand.</p>
<p>This is another scheme of NVIDIA Optimus, called MUXed scheme.</p>
<ul>
<li>Pros:
<ul>
<li>Saves power (dGPU turns off when not needed)</li>
<li>Low frame latency (when the monitor is switched to run on dGPU)</li>
<li>Easier passthroughs.
<ul>
<li>For example, you may switch the HDMI port to the dGPU, and spend a
few dollars on a fake HDMI dongle from Aliexpress, to let games in
VM run on the dGPU; then you can see the outputs with remote desktop
software.</li>
</ul>
</li>
</ul>
</li>
<li>Cons:
<ul>
<li>Expensive (with all those circuits)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>If you spent thousands on a top-end laptop, you may get this:</p>
<p><!--?xml version="1.0" encoding="UTF-8" standalone="no"?--><!-- Generated by graphviz version 14.0.2 (0)
 --><!-- Pages: 1 -->
<svg width="262pt" height="98pt" viewBox="0.00 0.00 262.00 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<polygon fill="white" stroke="none" points="-4,4 -4,-94 257.66,-94 257.66,4 -4,4"></polygon><!-- CPU -->
<g id="node1" class="node">
<title>CPU</title>
<polygon fill="none" stroke="black" points="54,-63 0,-63 0,-27 54,-27 54,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="27" y="-40.8" font-family="Times,serif" font-size="14.00">CPU</text>
</g><!-- NVIDIA -->
<g id="node2" class="node">
<title>NVIDIA</title>
<polygon fill="none" stroke="black" points="155.77,-63 90,-63 90,-27 155.77,-27 155.77,-63"></polygon>
<text xml:space="preserve" text-anchor="middle" x="122.88" y="-40.8" font-family="Times,serif" font-size="14.00">NVIDIA</text>
</g><!-- CPU&#45;&gt;NVIDIA -->
<g id="edge1" class="edge">
<title>CPU->NVIDIA</title>
<path fill="none" stroke="black" d="M54.4,-45C61.85,-45 70.15,-45 78.32,-45"></path>
<polygon fill="black" stroke="black" points="78.16,-48.5 88.16,-45 78.16,-41.5 78.16,-48.5"></polygon>
</g><!-- HDMI -->
<g id="node3" class="node">
<title>HDMI</title>
<polygon fill="none" stroke="black" points="249.71,-90 195.71,-90 195.71,-54 249.71,-54 249.71,-90"></polygon>
<text xml:space="preserve" text-anchor="middle" x="222.71" y="-67.8" font-family="Times,serif" font-size="14.00">HDMI</text>
</g><!-- NVIDIA&#45;&gt;HDMI -->
<g id="edge2" class="edge">
<title>NVIDIA->HDMI</title>
<path fill="none" stroke="black" d="M156.19,-53.92C165.21,-56.41 175.08,-59.13 184.37,-61.69"></path>
<polygon fill="black" stroke="black" points="183.28,-65.02 193.85,-64.31 185.14,-58.28 183.28,-65.02"></polygon>
</g><!-- Monitor -->
<g id="node4" class="node">
<title>Monitor</title>
<polygon fill="none" stroke="black" points="253.66,-36 191.77,-36 191.77,0 253.66,0 253.66,-36"></polygon>
<text xml:space="preserve" text-anchor="middle" x="222.71" y="-13.8" font-family="Times,serif" font-size="14.00">Monitor</text>
</g><!-- NVIDIA&#45;&gt;Monitor -->
<g id="edge3" class="edge">
<title>NVIDIA->Monitor</title>
<path fill="none" stroke="black" d="M156.19,-36.08C163.99,-33.93 172.44,-31.6 180.59,-29.35"></path>
<polygon fill="black" stroke="black" points="181.26,-32.79 189.97,-26.76 179.4,-26.05 181.26,-32.79"></polygon>
</g>
</g>
</svg>
</p>
<p>Wonder where the iGPU had gone? How come you need it on a
multi-thousand-dollar laptop for gaming?</p>
<p>Under this scheme, the manufacturer cuts power to the iGPU component, so
all the power budget can be allocated to CPU and dGPU for better
performance. This is basically the same as a desktop computer.</p>
<ul>
<li>Pros:
<ul>
<li>High performance with low latency (direct connection from dGPU to
monitor, and no unnecessary power budget on iGPU)</li>
<li>Saves cost (no complicated switching circuits)</li>
</ul>
</li>
<li>Cons:
<ul>
<li>Costs more power (with the dGPU always on)
<ul>
<li>But you likely don't need it anyway with a multi-thousand-dollar
laptop.</li>
</ul>
</li>
<li>Catastrophic for GPU passthrough
<ul>
<li>Since you only have one GPU, your host OS won't get to use any GPU
when it is passed through.</li>
<li>If you insist, you need to code your own switching scripts and find
your way to debug without any display output.</li>
<li>Try this if you are brave enough (YOLO!)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>How to determine the actual scheme:</p>
<p>Run <code>lspci</code> on the Linux OS, and look for entries about Intel HD Graphics
or NVIDIA.</p>
<ul>
<li>If the dGPU starts with <code>3D Controller</code>, you have the first Optimus
scheme (iGPU connected to monitor).</li>
<li>If the dGPU starts with <code>VGA Controller</code>, and there is an <code>HD Graphics</code>
GPU, you have the second Optimus scheme (switching between two GPUs).</li>
<li>If the dGPU starts with <code>VGA Controller</code>, and there is no <code>HD Graphics</code>
GPU, you have the last scheme without iGPU.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="my-environment">My Environment</h2>
<p>When writing this post, I'm using this laptop and OS;</p>
<ul>
<li>Lenovo Legion R720-15IKBN (i7-7700HQ, GTX1050)
<ul>
<li>The first Optimus MUXless scheme, with the iGPU connected to the monitor.</li>
</ul>
</li>
<li>Host OS is Arch Linux, up to date when writing this article</li>
<li>QEMU hypervisor with Libvirt and Virt-Manager for graphical management</li>
<li>Windows 10 LTSC 2019 in VM</li>
</ul>
<p>And here are my goals:</p>
<ul>
<li>Create an Intel GVT-g virtual GPU and pass it to VM</li>
<li>Disable NVIDIA GPU on the host, and hand it over completely to VM</li>
</ul>
<p>Before starting, you need to prepare:</p>
<ul>
<li>A QEMU (Libvirt) virtual machine with Windows 10 installed
<ul>
<li>With UEFI (OVMF) firmware. Not guaranteed to work with BIOS (SeaBIOS)
firmware.</li>
<li>With QXL virtual GPU.</li>
</ul>
</li>
<li>A Windows that boots on the physical computer
<ul>
<li>Dual boot, Windows To Go, etc.</li>
<li>Windows PE may work as long as you can use the Device Manager.</li>
</ul>
</li>
<li>Host OS displaying contents with the iGPU. dGPU either disabled or driver
unloaded.
<ul>
<li>Or you cannot passthrough the GVT-g GPU (Virt-Manager will crash).</li>
<li>And you cannot passthrough the dGPU (taken by Host OS).</li>
</ul>
</li>
</ul>
<p>Important tips:</p>
<ul>
<li>Multiple reboots of the host OS is required, and your host OS may crash! Back
up your data.</li>
<li>You don't need to download any drivers manually. Windows will do it for you
automatically.
<ul>
<li>If it doesn't, don't go any further than downloading the driver EXE and
double-clicking</li>
<li><strong>Never</strong> specify the exact driver to be used in Device Manager</li>
<li>Debugging will be harder if you do this</li>
</ul>
</li>
</ul>
<h2 id="stop-host-os-from-tampering-with-nvidia-gpu">Stop Host OS from Tampering with NVIDIA GPU</h2>
<p>The NVIDIA driver on the Host OS will hold control of the dGPU, and stop VM from
using it. Therefore you need to replace the driver with <code>vfio-pci</code>, built solely
for PCIe passthrough.</p>
<p>Even if you don't plan to passthrough the dGPU, you need to switch the graphics
display of Host OS to the iGPU, or later Virt-Manager will crash. You may
disable NVIDIA drivers with the steps below or use software such as
<code>optimus-manager</code> for management.</p>
<p>Here are the steps for disabling the NVIDIA driver and passing control to the
PCIe passthrough module:</p>
<ol>
<li>
<p>Run <code>lspci -nn | grep NVIDIA</code> and obtain an output similar to:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">01:00.0</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 3D</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> controller</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> [0302]: NVIDIA Corporation GP107M [GeForce GTX </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">1050</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> Mobile] [10de:1c8d] (</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">rev</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> a1</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span></code></pre>
<p>Here <code>[10de:1c8d]</code> is the vendor ID and device ID of the dGPU, where <code>10de</code>
means this device is manufactured by NVIDIA, and <code>1c8d</code> means this is a
GTX 1050.</p>
</li>
<li>
<p>Create <code>/etc/modprobe.d/lantian.conf</code> with the following content:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">options</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio-pci</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ids=10de:1c8d</span></span></code></pre>
<p>This configures <code>vfio-pci</code>, the kernel module responsible for PCIe
passthrough, to manage the dGPU. <code>ids</code> is the vendor ID and device ID of the
device to be passed through.</p>
</li>
<li>
<p>Modify <code>/etc/mkinitcpio.conf</code>, add the following contents to <code>MODULES</code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">MODULES</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=(</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">vfio_pci</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio_iommu_type1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio_virqfd</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span></code></pre>
<p>And remove anything related to NVIDIA drivers (such as <code>nvidia</code>)</p>
<p>Now PCIe passthrough module will take control of the dGPU in the early
booting process, preventing NVIDIA drivers from taking control.</p>
</li>
<li>
<p>Run <code>mkinitcpio -P</code> to update the initramfs.</p>
</li>
<li>
<p>Reboot.</p>
<ul>
<li>Or you may wait until the first step of iGPU passthrough.</li>
</ul>
</li>
</ol>
<h2 id="setting-up-intel-gvt-g-virtual-igpu">Setting up Intel GVT-g Virtual iGPU</h2>
<p>Remember the multi-thousand-dollar NVIDIA GRID GPUs? If you get hold of one of
these, the GPU driver itself will support creating multiple virtual GPUs to be
used on different VMs, just like the CPU virtualization technology.</p>
<p>But different from NVIDIA, 5th gen and later Intel CPUs support this out of the
box, and you don't need to pay the ransom for an expensive GPU. Although iGPU is
weak, at least it allows for smooth web browsing in VM compared to QXL, etc.</p>
<p>Passing through this virtual Intel GPU is also relatively easy and may serve as
a practice.</p>
<ol>
<li>
<p>Enable kernel parameters for GVT-g, and load kernel modules</p>
<ul>
<li>
<p>Modify your kernel parameters (Usually located at
<code>/boot/loader/entries/arch.conf</code> if you use Systemd-boot), and add:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">i915.enable_gvt</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">=1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> kvm.ignore_msrs=</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> intel_iommu=on</span></span></code></pre>
</li>
<li>
<p>Modify <code>/etc/modules-load.d/lantian.conf</code> and add the next 3 lines:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">kvmgt</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">vfio-iommu-type1</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">vfio-mdev</span></span></code></pre>
<p>These 3 lines correspond to the required kernel modules.</p>
</li>
<li>
<p>Reboot.</p>
</li>
</ul>
</li>
<li>
<p>Create virtual GPU</p>
<ul>
<li>
<p>Run <code>lspci | grep "HD Graphics"</code> to look for the PCIe address of the iGPU.
I get this output for example:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">00:02.0</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> VGA</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> compatible</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> controller:</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Intel</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Corporation</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> HD</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Graphics</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 630</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> (rev </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">04</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span></code></pre>
<p>In this case, iGPU is located at <code>00:02.0</code> on the PCIe bus.</p>
</li>
<li>
<p>Run the following command to create the virtual GPU:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Must run as root</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">sudo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> su</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">echo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "af5972fb-5530-41a7-0000-fd836204445b"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> > </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"/sys/devices/pci0000:00/0000:00:02.0/mdev_supported_types/i915-GVTg_V5_4/create"</span></span></code></pre>
<p>Pay attention to the iGPU PCIe bus location. In addition you can optionally
replace the UUID.</p>
<p>In addition, each time you restart the system, you need to run this command
manually before starting the VM. You can also add this command to
<code>/etc/rc.local</code> to create the virtual GPU on startup. It does not have
performance impacts when the VM is off.</p>
</li>
</ul>
</li>
<li>
<p>Modify the VM configuration to expose the virtual GPU</p>
<ul>
<li>
<p>Run <code>virsh edit Win10</code>, where <code>Win10</code> is the name of your VM. Insert the
following contents above <code>&#x3C;/devices></code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'subsystem'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'mdev'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'vfio-pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> display</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> uuid</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'af5972fb-5530-41a7-0000-fd836204445b'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span></code></pre>
<p>Replace the UUID to match the last step. Also, <code>display</code> here is set to
<code>off</code>, which is intentional (normal).</p>
</li>
<li>
<p>Do not remove the QXL GPU yet.</p>
</li>
<li>
<p>Start the VM and open Device Manager. You should see a
<code>Microsoft Basic Display Adapter</code>.</p>
</li>
<li>
<p>Connect the VM to the Internet and wait. Windows will automatically install
the iGPU drivers, and you will see the Intel Control Panel in Start Menu.</p>
<ul>
<li>If the driver isn't installed after a long time, you may download the
iGPU driver (just the regular ones) from the Intel website, copy it to
the VM, and try to install it.</li>
<li>If it still doesn't work, it means you've done something wrong, or there
is a hypervisor bug.</li>
</ul>
</li>
<li>
<p>After the driver is installed, the VM can use the Intel GPU now. But since
the current monitor is displaying images from QXL GPU, and Intel GPU is not
the primary GPU, Windows hasn't set any program to run on Intel GPU yet.</p>
<ul>
<li>We will disable the QXL GPU next.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Shut down the VM and edit the configuration again:</p>
<ul>
<li>
<p>In the <code>&#x3C;hostdev></code> added above, change <code>display='off'</code> to <code>display='on'</code>.</p>
</li>
<li>
<p>Remove everything in <code>&#x3C;graphics>...&#x3C;/graphics></code> and <code>&#x3C;video>...&#x3C;/video></code>,
and replace with:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spice'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">listen</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'none'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">image</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> compression</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">gl</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enable</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'none'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span></code></pre>
</li>
<li>
<p>Add these lines before <code>&#x3C;/domain></code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.ramfb=on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.driver=vfio-pci-nohotplug'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.x-igd-opregion=on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.xres=1920'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.yres=1080'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.romfile=/vbios_gvt_uefi.rom'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:env</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'MESA_LOADER_DRIVER_OVERRIDE'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'i965'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span></code></pre>
<p>The <code>vbios_gvt_uefi.rom</code> can be downloaded from
<a href="http://120.25.59.132:3000/vbios_gvt_uefi.rom" rel="noopener noreferrer" target="_blank">http://120.25.59.132:3000/vbios_gvt_uefi.rom</a>,
or <a href="/usr/uploads/202007/vbios_gvt_uefi.rom">from this site</a>, and should be
put to root folder. If you moved it elsewhere, you need to modify the
<code>romfile</code> parameter correspondingly.</p>
</li>
<li>
<p>Change the first line of the configuration file, <code>&#x3C;domain type='kvm'></code>, to
<code>&#x3C;domain type='kvm' xmlns:qemu='http://libvirt.org/schemas/domain/qemu/1.0'></code>.</p>
</li>
</ul>
</li>
<li>
<p>Reboot the VM, and you should see normal graphics output. Now the VM is using
the GVT-g virtual GPU.</p>
</li>
</ol>
<h2 id="setting-up-nvidia-dgpu-passthrough">Setting up NVIDIA dGPU Passthrough</h2>
<p>In previous steps, the official NVIDIA drivers on the host OS are disabled, and
the dGPU is managed by <code>vfio-pci</code> for PCIe passthrough.</p>
<p>Passing through the dGPU itself is simple, but NVIDIA added a lot of driver
limitations for money:</p>
<ul>
<li>GPU must be on the correct PCIe bus location.</li>
<li>System should not expose VM characteristics.</li>
<li>System must have a battery.</li>
<li>GPU BIOS must be available in the ACPI table.</li>
<li>etc...</li>
</ul>
<p>So we have to hack through all these pitfalls.</p>
<blockquote>
<p>Update on 2022-01-22:</p>
</blockquote>
<blockquote>
<p><a href="https://nvidia.custhelp.com/app/answers/detail/a_id/5173" rel="noopener noreferrer" target="_blank">Since version 465, NVIDIA lifted most of the restrictions</a>,
so theoretically, you pass a GPU into the VM, and everything should just work.</p>
<p>But that's just the theory.</p>
<p>I still recommend everyone to follow all the steps and hide the VM
characteristics, because:</p>
<ol>
<li>
<p>Not all restructions are lifted for laptops.</p>
<ul>
<li>At least in my tests, an incorrect PCIe bus address for the GPU and the
absence of a battery still causes passthrough to fail, and the driver
will error out with the infamous code 43.</li>
</ul>
</li>
<li>
<p>Even if NVIDIA driver isn't detecting VMs, the programs you run might.
Hiding VM characteristics increases the chance to run them successfully.</p>
<ul>
<li>Examples include online games with anti-cheat systems, or commercial
software that require online activation.</li>
</ul>
</li>
<li>
<p>Because of architectural limitations of Optimus MUXless, you still need to
modify the UEFI firmware so the VM can see the GPU vBIOS.</p>
</li>
</ol>
</blockquote>
<ol>
<li>
<p>First reboot the physical machine to Windows and do the following things:</p>
<ul>
<li>(Optionally) Download GPU-Z and export the GPU vBIOS.</li>
<li>Find your dGPU in Device Manager and look for its Hardware ID, such as
<code>PCI\VEN_10DE&#x26;DEV_1C8D&#x26;SUBSYS_39D117AA&#x26;REV_A1</code>, and record this somewhere.</li>
</ul>
</li>
<li>
<p>Then reboot back to Linux. If you haven't exported the GPU vBIOS, you may use
<code>VBiosFinder</code> software to extract it from the BIOS update of your computer.</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Download VBiosFinder</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> clone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/coderobe/VBiosFinder.git</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Download BIOS update from your computer's manufacturer site, usually an EXE file.</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># My BIOS update is named as BIOS-4KCN45WW.exe, replace accordingly</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">mv</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> BIOS-4KCN45WW.exe</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> VBiosFinder/</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Install dependencies</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pikaur</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -S</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ruby</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ruby-bundler</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> innoextract</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> p7zip</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> upx</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Install rom-parser</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> clone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/awilliam/rom-parser.git</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> rom-parser</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">make</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">mv</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> rom-parser</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ../VBiosFinder/3rdparty</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ..</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Install UEFIExtract</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> clone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/LongSoft/UEFITool.git</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -b</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> new_engine</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> UEFITool</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">./unixbuild.sh</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">mv</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> UEFIExtract/UEFIExtract</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ../VBiosFinder/3rdparty</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ..</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Extract vBIOS</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> VBiosFinder</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">bundle</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> update</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> --bundler</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">bundle</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> install</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> --path=vendor/bundle</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">./vbiosfinder</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> extract</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> BIOS-4KCN45WW.exe</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">ls</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> output</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># There will be a few files in the output folder:</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - vbios_10de_1c8c.rom</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - vbios_10de_1c8d.rom</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - vbios_10de_1c8e.rom</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - ...</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Find the one corresponding to the vendor ID and device ID, which is your vBIOS.</span></span></code></pre>
</li>
<li>
<p>Then add the vBIOS to VM's UEFI firmware (or OVMF).</p>
<p>On an Optimus laptop, NVIDIA drivers will search for the vBIOS from the
system's ACPI table and load it to the GPU. The ACPI table is managed by the
UEFI firmware, so it needs to be modified to add the vBIOS.</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Based on reports on GitHub, UEFI firmware shouldn't be moved once built</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># So find somewhere to permanently store the files</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /opt</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> clone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/tianocore/edk2.git</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Install dependencies</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pikaur</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -S</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> python2</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> iasl</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> nasm</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> subversion</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> perl-libwww</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vim</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> dos2unix</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> gcc5</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Assuming your vBIOS is at /vbios.rom</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> edk2/OvmfPkg/AcpiPlatformDxe</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">xxd</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /vbios.rom</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vrom.h</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify vrom.h, and rename the unsigned char array to VROM_BIN</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># and modify the length variable at the end to VROM_BIN_LEN, and record the number, 167936 in my case</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">wget</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/jscinoz/optimus-vfio-docs/files/1842788/ssdt.txt</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -O</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ssdt.asl</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify ssdt.asl, change line 37 to match VROM_BIN_LEN</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Run the following commands. Errors may pop up, but they're fine as long as Ssdt.aml is generated</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">iasl</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -f</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ssdt.asl</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">xxd</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -c1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Ssdt.aml</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">tail</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -n</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> +37</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cut</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -f2</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -d</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">' '</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">paste</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -sd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">' '</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">sed</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 's/ //g'</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">xxd</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -r</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -p</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> > </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">vrom_table.aml</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">xxd</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vrom_table.aml</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">sed</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> 's/vrom_table_aml/vrom_table/g'</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> > </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">vrom_table.h</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Switch back to edk2's folder and apply a patch</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ../..</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">wget</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://gist.github.com/jscinoz/c43a81882929ceaf7ec90afd820cd470/raw/139799c87fc806a966250e5686e15a28676fc84e/nvidia-hack.diff</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">patch</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -p1</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> &#x3C; </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">nvidia-hack.diff</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Compile OVMF</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">make</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -C</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> BaseTools</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">.</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ./edksetup.sh</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> BaseTools</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify these variables in Conf/target.txt:</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - ACTIVE_PLATFORM       = OvmfPkg/OvmfPkgX64.dsc</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - TARGET_ARCH           = X64</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - TOOL_CHAIN_TAG        = GCC5</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">build</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Wait until compilation is complete, and verify file's existence in Build/OvmfX64/DEBUG_GCC5/FV:</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - OVMF_CODE.fd</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - OVMF_VARS.fd</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Replace UEFI variables of your VM, remember to change VM names</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cp</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Build/OvmfX64/DEBUG_GCC5/FV/OVMF_VARS.fd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /var/lib/libvirt/qemu/nvram/Win10_VARS.fd</span></span></code></pre>
</li>
<li>
<p>Modify your VM configuration, <code>virsh edit Win10</code>, and do the following
changes:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&#x3C;!-- Modify the os section, remember to match the path to OVMF_CODE.fd --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> arch</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'x86_64'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> machine</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pc-q35-4.2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">hvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> readonly</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pflash'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/opt/edk2/Build/OvmfX64/DEBUG_GCC5/FV/OVMF_CODE.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/var/lib/libvirt/qemu/nvram/Win10_VARS.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&#x3C;!-- Modify the features section, so QEMU will hide the fact that this is a VM --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">acpi</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">apic</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">relaxed</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vapic</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">spinlocks</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> retries</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'8191'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vendor_id</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'GenuineIntel'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hidden</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vmport</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&#x3C;!-- Add the PCIe passthrough device, must be below the hostdev for iGPU --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'subsystem'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">rom</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bar</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &#x3C;!-- The PCIe bus address here MUST BE EXACTLY 01:00.0 --></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &#x3C;!-- If there is a PCIe bus address conflict when saving config changes, --></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &#x3C;!-- Remove &#x3C;address> of all other devices --></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &#x3C;!-- And Libvirt will reallocate PCIe bus addresses --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&#x3C;!-- Add these parameters before &#x3C;/qemu:commandline> --></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-vendor-id=0x10de'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-device-id=0x1c8d'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-sub-vendor-id=0x17aa'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-sub-device-id=0x39d1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-acpitable'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'file=/ssdt1.dat'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span></code></pre>
<p>The IDs here should match the hardware ID from Device Manager,
<code>PCI\VEN_10DE&#x26;DEV_1C8D&#x26;SUBSYS_39D117AA&#x26;REV_A1</code>. Replace accordingly.</p>
<p>The ssdt1.dat corresponds to the Base64 below. It can be converted to a
binary file with
<a href="https://base64.guru/converter/decode/file" rel="noopener noreferrer" target="_blank">Base64 decoding website</a> or
<a href="/usr/uploads/202007/ssdt1.dat">downloaded from this site</a>. Put it in the
root folder. If you moved its location, you should modify the file parameter
accordingly. It's also an ACPI table, and it emulates a fully-charged
battery, but instead of being merged to OVMF, it simply works as a QEMU
argument addition.</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">U1NEVKEAAAAB9EJPQ0hTAEJYUENTU0RUAQAAAElOVEwYEBkgoA8AFVwuX1NCX1BDSTAGABBMBi5f</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">U0JfUENJMFuCTwVCQVQwCF9ISUQMQdAMCghfVUlEABQJX1NUQQCkCh8UK19CSUYApBIjDQELcBcL</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">cBcBC9A5C1gCCywBCjwKPA0ADQANTElPTgANABQSX0JTVACkEgoEAAALcBcL0Dk</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span></span></code></pre>
<p><strong>Do not miss any steps, or you will be welcomed by Code 43 (Driver load
failure).</strong></p>
</li>
<li>
<p>Start the VM and wait a while. Windows will automatically install NVIDIA
drivers.</p>
<ul>
<li>If Device Manager shows the dGPU with an exclamation sign and code 43 or
driver load failure, you need to check if you've missed any steps and if
you've configured everything correctly.
<ul>
<li>Switch Device Manager to <code>Device by Connection</code>, and verify that dGPU is
at Bus 1, Slot 0, Function 0. The parent PCIe port to the dGPU should be
at Bus 0, Slot 1, Function 0.</li>
<li>Yes, that's how harsh NVIDIA drivers' checks are.</li>
<li>If they don't match, you need to reallocate PCIe addresses with the
method above.</li>
</ul>
</li>
<li>If the OS didn't automatically install the NVIDIA driver, and your manually
downloaded driver installer also shows that the system is incompatible, or
the GPU cannot be found, you need to check if the hardware ID matches
what's found on the host.</li>
<li>Even if dGPU is working correctly, you still won't be able to open NVIDIA
Control Panel (which tells you monitors aren't found). This is normal.</li>
</ul>
</li>
</ol>
<h2 id="whats-next">What's Next?</h2>
<p>Even if you've done every step above and got both iGPU and dGPU working in VM,
this is still not very helpful to gaming:</p>
<ul>
<li>Since Windows thinks the primary monitor is connected to GVT-g virtual iGPU,
the OS will let the weak iGPU handle all 3D applications.
<ul>
<li>If you didn't passthrough the GVT-g iGPU, then QXL will be in charge.</li>
<li>Exceptions: it is reported that some Unreal Engine games will actively
detect and use the dGPU.</li>
</ul>
</li>
<li>Since a MUXless Optimus dGPU isn't connected to monitors, there is no way to
select dGPU as the primary GPU.</li>
<li>Since GVT-g iGPU and NVIDIA dGPU cannot form Optimus configuration, NVIDIA
drivers won't move game workloads to dGPU.</li>
<li>If you only leave the dGPU in VM, although Windows will put render works on
the dGPU (there were no other choices), the resolution will be limited to
640x480, and you will have to rely on remote desktop software.</li>
</ul>
<p>Therefore, Optimus GPU passthrough is currently more for tinkerers than actual
gamers. If you are experienced in driver development, you may research in the
following directions;</p>
<ol>
<li>Let GVT-g iGPU and NVIDIA dGPU form Optimus configuration normally</li>
<li>Let QXL and NVIDIA dGPU form Optimus configuration</li>
<li>Modify NVIDIA drivers and add a virtual monitor</li>
</ol>
<h2 id="references">References</h2>
<p>Huge thanks to previous explorers on the topic of GPU passthrough. Without their
efforts, this post won't have existed in the first place.</p>
<p>Here are the sources I referenced when I did my configuration:</p>
<ul>
<li>Intel GVT-g virtual GPU
<ul>
<li>Arch Linux Wiki
<a href="https://wiki.archlinux.org/index.php/Intel_GVT-g" rel="noopener noreferrer" target="_blank">https://wiki.archlinux.org/index.php/Intel_GVT-g</a></li>
<li>Gentoo Wiki / Shunlir's VM configuration
<a href="https://wiki.gentoo.org/wiki/User:Shunlir/Intel_GVT-g#Install_Intel_driver_in_Guest" rel="noopener noreferrer" target="_blank">https://wiki.gentoo.org/wiki/User:Shunlir/Intel_GVT-g#Install_Intel_driver_in_Guest</a></li>
</ul>
</li>
<li>NVIDIA dGPU passthrough
<ul>
<li>GitHub Misairu-G's NVIDIA Optimus MUXed passthrough guide
<a href="https://gist.github.com/Misairu-G/616f7b2756c488148b7309addc940b28" rel="noopener noreferrer" target="_blank">https://gist.github.com/Misairu-G/616f7b2756c488148b7309addc940b28</a></li>
<li>GitHub jscinoz's Optimus MUXless passthrough exploration
<a href="https://github.com/jscinoz/optimus-vfio-docs" rel="noopener noreferrer" target="_blank">https://github.com/jscinoz/optimus-vfio-docs</a></li>
<li>GitHub arne-claeys' OVMF patches and related discussion
<a href="https://github.com/jscinoz/optimus-vfio-docs/issues/2" rel="noopener noreferrer" target="_blank">https://github.com/jscinoz/optimus-vfio-docs/issues/2</a></li>
<li>Reddit r/VFIO's guide compilation
<a href="https://www.reddit.com/r/VFIO/comments/8gv60l/current_state_of_optimus_muxless_laptop_gpu/" rel="noopener noreferrer" target="_blank">https://www.reddit.com/r/VFIO/comments/8gv60l/current_state_of_optimus_muxless_laptop_gpu/</a></li>
<li>Reddit r/VFIO's emulated battery patch
<a href="https://www.reddit.com/r/VFIO/comments/ebo2uk/nvidia_geforce_rtx_2060_mobile_success_qemu_ovmf/" rel="noopener noreferrer" target="_blank">https://www.reddit.com/r/VFIO/comments/ebo2uk/nvidia_geforce_rtx_2060_mobile_success_qemu_ovmf/</a></li>
</ul>
</li>
</ul>
<h2 id="appendix-final-libvirt-xml-file">Appendix: Final Libvirt XML File</h2>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">domain</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'kvm'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:qemu</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'http://libvirt.org/schemas/domain/qemu/1.0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">name</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">Win10</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">name</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">uuid</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">6f0e09e1-a7d4-4d33-b4f8-0dc69eaaed9b</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">uuid</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">metadata</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">libosinfo:libosinfo</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:libosinfo</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"http://libosinfo.org/xmlns/libvirt/domain/1.0"</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">libosinfo:os</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> id</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"http://microsoft.com/win/10"</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">libosinfo:libosinfo</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">metadata</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memory</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'KiB'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">4194304</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memory</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">currentMemory</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'KiB'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">4194304</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">currentMemory</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vcpu</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> placement</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'static'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">8</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vcpu</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> arch</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'x86_64'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> machine</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pc-q35-4.2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">hvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> readonly</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pflash'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/opt/edk2/Build/OvmfX64/DEBUG_GCC5/FV/OVMF_CODE.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/var/lib/libvirt/qemu/nvram/Win10_VARS.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">acpi</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">apic</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">relaxed</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vapic</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">spinlocks</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> retries</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'8191'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vendor_id</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'GenuineIntel'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hidden</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vmport</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cpu</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'host-model'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> check</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'partial'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">topology</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> sockets</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dies</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> cores</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'4'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> threads</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cpu</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">clock</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> offset</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'localtime'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'rtc'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> tickpolicy</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'catchup'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pit'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> tickpolicy</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'delay'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'hpet'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> present</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'hypervclock'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> present</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">clock</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_poweroff</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">destroy</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_poweroff</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_reboot</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">restart</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_reboot</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_crash</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">destroy</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_crash</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">pm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">suspend-to-mem</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enabled</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">suspend-to-disk</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enabled</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">pm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">devices</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">emulator</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/usr/bin/qemu-system-x86_64</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">emulator</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'file'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> device</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'disk'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">driver</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'qemu'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'raw'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> file</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/var/lib/libvirt/images/Win10.img'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dev</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'vda'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">boot</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> order</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x07'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'file'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> device</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'cdrom'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">driver</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'qemu'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'raw'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> file</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'/mnt/files/LegacyOS/Common/virtio-win-0.1.141.iso'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dev</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'sda'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'sata'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">readonly</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">boot</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> order</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'drive'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> controller</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> target</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'qemu-xhci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> ports</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'15'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x04'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'sata'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x1f'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x10'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x11'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'3'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'3'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x12'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'4'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'4'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x13'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x3'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'5'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'5'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x14'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x4'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'6'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'6'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x15'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x5'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'7'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'7'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x8'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x6'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'8'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'8'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x9'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x7'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'9'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-to-pci-bridge'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-pci-bridge'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x02'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'10'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'10'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0xa'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x03'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'11'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pcie-root-port'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'11'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0xb'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x03'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio-serial'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x05'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'scsi'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio-scsi'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x06'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">interface</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'bridge'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">mac</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> address</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'52:54:00:b0:65:5a'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bridge</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'br0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x03'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">interface</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">serial</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pty'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'isa-serial'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">        &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'isa-serial'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">serial</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">console</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pty'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'serial'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">console</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">channel</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spicevmc'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'com.redhat.spice.0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio-serial'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> controller</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">channel</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'tablet'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'mouse'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'ps2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'keyboard'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'ps2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spice'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">listen</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'none'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">image</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> compression</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">gl</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enable</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">sound</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'ich9'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x1b'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">sound</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'none'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'subsystem'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'mdev'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'no'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'vfio-pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> display</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">        &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> uuid</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'af5972fb-5530-41a7-0000-fd836204445b'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0a'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'subsystem'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'yes'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">        &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">rom</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bar</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'off'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x01'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spicevmc'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'2'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'spicevmc'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'usb'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'3'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memballoon</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'virtio'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'pci'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0000'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x08'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x00'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'0x0'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memballoon</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">devices</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.ramfb=on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.driver=vfio-pci-nohotplug'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.x-igd-opregion=on'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.xres=1920'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.yres=1080'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev0.romfile=/vbios_gvt_uefi.rom'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-vendor-id=0x10de'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-device-id=0x1c8d'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-sub-vendor-id=0x17aa'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-set'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'device.hostdev1.x-pci-sub-device-id=0x39d1'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'-acpitable'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'file=/ssdt1.dat'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:env</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'MESA_LOADER_DRIVER_OVERRIDE'</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">'i965'</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">domain</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span></code></pre>  </div>  <div class="clearfix" id="post-navi" data-astro-cid-gfbmwgei=""> <div class="float-end text-end" data-astro-cid-gfbmwgei=""> <a href="/en/article/one-pic/if-you-wanna-take-the-bite.lantian/" title="Willing to Take the Bait (Referring to US Visa)" data-astro-cid-gfbmwgei=""> Willing to Take the Bait (Referring to US Visa) </a> <br data-astro-cid-gfbmwgei=""> Next post »
</div> <div class="float-start text-start position-absolute" data-astro-cid-gfbmwgei="">
« Previous post <br data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-website/an-elegant-scripture-of-safety-generator.lantian/" title="An Elegant &#34;Scripture of Safety&#34; Generator" data-astro-cid-gfbmwgei=""> An Elegant &quot;Scripture of Safety&quot; Generator </a> </div> </div>  <div id="waline" data-waline-language="en-US" data-waline-path="/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian"></div> <script type="module" src="/assets/WalineComment.astro_astro_type_script_index_0_lang.Dqib3X1E.js"></script>  </div> </div> </article>  </div> <aside class="d-none d-xl-block"> <section class="widget"> <h3>Latest posts</h3> <ul class="list-unstyled"> <li> 07-20  <a href="/en/article/modify-computer/legal-lte-network-at-home-with-open5gs.lantian/">Legal LTE Network at Home with Open5GS</a> </li><li> 06-27  <a href="/en/article/modify-computer/sidestore-without-stosvpn-across-lan.lantian/">Using SideStore without StosVPN across your LAN</a> </li><li> 05-19  <a href="/en/article/modify-computer/nix-logarithmetic-math-library-from-zero.lantian/">Nix Logarithmic Math Library from Ground Zero</a> </li><li> 04-06  <a href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/">Legal LTE Network at Home for $100</a> </li><li> 02-10  <a href="/en/article/modify-computer/build-custom-android-kernel-with-nix.lantian/">Building Custom Android Kernel with Nix</a> </li><li> 04-20  <a href="/en/article/modify-website/migrate-blog-to-astro-js.lantian/">Migrating My Blog to Astro.js</a> </li><li> 12-16  <a href="/en/article/modify-computer/nixos-low-ram-vps.lantian/">NixOS Series 5: Creating Disk Image for Low RAM VPS</a> </li><li> 09-20  <a href="/en/article/modify-computer/nix-trigonometric-math-library-from-zero.lantian/">Nix Trigonometric Math Library from Ground Zero</a> </li><li> 05-29  <a href="/en/article/random-notes/pipewire-sigkill-fix.lantian/">Preventing Pipewire from being SIGKILLed</a> </li><li> 05-12  <a href="/en/article/modify-website/how-to-kill-the-dn42-network.lantian/">How to Kill the DN42 Network (Updated 2023-05-12)</a> </li><li> 05-08  <a href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/">NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05)</a> </li><li> 04-17  <a href="/en/article/random-notes/fix-china-telecom-roaming-no-4g-on-aosp-rom.lantian/">Fix China Telecom 4G Roaming on AOSP ROM by Changing APN</a> </li><li> 03-26  <a href="/en/article/random-notes/old-hp-workstation-as-all-in-one.lantian/">Notes on Setting Up NAS+Router on Old HP Workstation</a> </li><li> 01-14  <a href="/en/article/modify-computer/nixos-impermanence.lantian/">NixOS Series 4: &quot;Stateless&quot; Operating System</a> </li><li> 06-21  <a href="/en/article/modify-computer/nixos-packaging.lantian/">NixOS Series 3: Software Packaging 101</a> </li> </ul> </section> <section class="widget"> <h3>Latest comments</h3> <ul class="list-unstyled" id="recent-comments">  <li><a href="#">Loading...</a></li>  </ul> </section> <script type="module">const i=window.location.hostname=="localhost"?"https://comments.lantian.pub":window.location.origin;fetch(`${i}/api/comment?type=recent&count=10`).then(t=>{if(t.status!==200)throw new Error(`Server returned bad HTTP status ${t.status}`);return t.json()}).then(t=>{const e=document.getElementById("recent-comments");e&&(e.innerHTML=t.data.map(n=>{const o=n.comment.replace(/(<([^>]+)>)/gi,"");return"<li>"+n.nick+' <a href="'+n.url+'">'+o+"</a></li>"}).join(""))});</script> <section class="widget"> <h3>Others</h3> <ul class="list-unstyled">  <li> <i class="fas fa-fw fa-rss"></i>  <a href="/rss2.xml" target="_blank">RSS Feed</a> |  <a href="/feed.xml" target="_blank">Atom</a> |  <a href="/feed.json" target="_blank">JSON</a> </li> <li> <i class="fas fa-fw fa-globe"></i>  <a href="https://stats.uptimerobot.com/BLK6VsRkR" target="_blank"> Sever Status </a> </li> <li> <i class="fas fa-fw fa-sitemap"></i>  <a href="https://lg.lantian.pub" target="_blank">DN42 Looking Glass</a> </li> <li> <i class="fas fa-fw fa-link"></i>  <a href="gopher://lantian.pub" target="_blank">Access with Gopher protocol</a> </li>  </ul> </section> <section class="widget"> <h3>Links</h3> <ul class="list-unstyled"> <li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://0x7f.cc"> 0x7f Blog 🐑 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="http://foreverblog.cn"> 10 Year&#39;s Promise (Forever Blog) </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://alanyhq.com"> Alanyhq </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.baoshuo.ren/?utm_source=friends"> Baoshuo&#39;s Blog </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.cas7.moe"> Blog of Moecast </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://jerryxiao.cc"> JerryXiao </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://sangsir.com"> SangSir </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://snli.org"> Shucheng Li </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://yuetau.net"> YuetAu&#39;s Spot </a> </li> </ul> </section> </aside> </div> <footer class="lantian clearfix" data-astro-cid-w3csb3e3="">  <div id="copyright" class="float-end text-end" data-astro-cid-w3csb3e3=""> <i class="fas fa-copyright" data-astro-cid-w3csb3e3=""></i> 2012-2025 Lan Tian @ Blog<br data-astro-cid-w3csb3e3=""> <small data-astro-cid-w3csb3e3=""> Powered by Astro v5.15.1 @ 2025-10-25 23:46:38 </small> </div> <script type="module">function v(c,o,r){const h=/^localhost$|^127(?:\.[0-9]+){0,2}\.[0-9]+$|^(?:0*:)*?:?0*1$/.test(location.hostname)||location.protocol==="file:";if(!o.trackLocalhost&&h)return console.warn("[Plausible] Ignoring event because website is running locally");try{if(window.localStorage.plausible_ignore==="true")return console.warn('[Plausible] Ignoring event because "plausible_ignore" is set to "true" in localStorage')}catch{}const p={n:c,u:o.url,d:o.domain,r:o.referrer,w:o.deviceWidth,h:o.hashMode?1:0,p:r&&r.props?JSON.stringify(r.props):void 0},s=new XMLHttpRequest;s.open("POST",`${o.apiHost}/api/event`,!0),s.setRequestHeader("Content-Type","text/plain"),s.send(JSON.stringify(p)),s.onreadystatechange=()=>{s.readyState===4&&r&&r.callback&&r.callback()}}function b(c){const o=()=>({hashMode:!1,trackLocalhost:!1,url:location.href,domain:location.hostname,referrer:document.referrer||null,deviceWidth:window.innerWidth,apiHost:"https://plausible.io",...c}),r=(t,n,i)=>{v(t,{...o(),...i},n)},h=(t,n)=>{r("pageview",n,t)};return{trackEvent:r,trackPageview:h,enableAutoPageviews:()=>{const t=()=>h(),n=history.pushState;return n&&(history.pushState=function(i,l,u){n.apply(this,[i,l,u]),t()},addEventListener("popstate",t)),c&&c.hashMode&&addEventListener("hashchange",t),h(),function(){n&&(history.pushState=n,removeEventListener("popstate",t)),c&&c.hashMode&&removeEventListener("hashchange",t)}},enableAutoOutboundTracking:(t=document,n={subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]})=>{function i(e){r("Outbound Link: Click",{props:{url:this.href}}),typeof process<"u"&&process,setTimeout(()=>{location.href=this.href},150),e.preventDefault()}const l=new Set;function u(e){e instanceof HTMLAnchorElement?e.host!==location.host&&(e.addEventListener("click",i),l.add(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(u)}function f(e){e instanceof HTMLAnchorElement?(e.removeEventListener("click",i),l.delete(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(f)}const d=new MutationObserver(e=>{e.forEach(a=>{a.type==="attributes"?(f(a.target),u(a.target)):a.type==="childList"&&(a.addedNodes.forEach(u),a.removedNodes.forEach(f))})});return t.querySelectorAll("a").forEach(u),d.observe(t,n),function(){l.forEach(a=>{a.removeEventListener("click",i)}),l.clear(),d.disconnect()}}}}const g=b({domain:"lantian.pub",trackLocalhost:!0,apiHost:""});g.trackPageview();</script> </footer>  </div>  </body> </html>