<!DOCTYPE html><html lang="en-US" itemscope="" itemtype="https://schema.org/Article" data-astro-cid-porej7z2=""> <head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05) - Lan Tian @ Blog</title><script>
  ;(() => {
    try {
      const mode = localStorage.getItem('user-color-scheme')
      if (mode == 'dark' || mode == 'light') {
        document.documentElement.setAttribute('data-user-color-scheme', mode)
      }
    } catch {
      // Ignore errors
    }
  })()
</script><link rel="stylesheet" href="/assets/index.CUlf1-Vz.css"><style>#post-navi[data-astro-cid-gfbmwgei]{padding:5px;border-top:1px solid var(--lt-border-weak);border-bottom:1px solid var(--lt-border-weak)}
ol[data-astro-cid-nj3qel45]{margin:0;padding:0;line-height:1.5}ol[data-astro-cid-nj3qel45] .toc-item[data-astro-cid-nj3qel45]{list-style:none}ol[data-astro-cid-nj3qel45] .toc-child[data-astro-cid-nj3qel45],ol[data-astro-cid-nj3qel45] .toc[data-astro-cid-nj3qel45]{padding:0}ol[data-astro-cid-nj3qel45] .toc-link[data-astro-cid-nj3qel45]{display:block;margin-left:1em;padding:.25em 0}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:1em;padding:.25em 0;float:left;font-style:normal;font-variant:normal;font-weight:900;font-family:Font Awesome\ 6 Free;font-feature-settings:normal;text-align:center}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before{content:""}ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{content:""}.post-info-wrap[data-astro-cid-dckccua4]{-ms-flex:0 0 2.5em;flex:0 0 2.5em;background-color:var(--lt-component-bg-emphasis)}@media(min-width:768px){.post-info[data-astro-cid-dckccua4]{position:sticky;top:0}}@media(max-width:767.98px){.post-info[data-astro-cid-dckccua4]{position:absolute}}
</style><script type="module" src="/assets/PageLayout.astro_astro_type_script_index_0_lang.C1wfUPs6.js"></script><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="imagemode" content="force"><meta name="nightmode" content="disable"><meta name="wap-font-scale" content="no"><meta name="title" content="NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05) - Lan Tian @ Blog"><meta name="keywords" content=""><meta name="author" content="Lan Tian"><link rel="canonical" href="https://lantian.pub/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/"><link rel="alternate" type="application/rss+xml" title="Lan Tian @ Blog" href="https://lantian.pub/rss2.xml"><link rel="alternate" type="application/atom+xml" title="Lan Tian @ Blog" href="https://lantian.pub/feed.xml"><link rel="alternate" href="https://lantian.pub/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/" hreflang="zh"><link rel="alternate" href="https://lantian.pub/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/" hreflang="en"><meta name="copyright" content="Copyright 2012-2025 Lan Tian @ Blog"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="manifest" href="/manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#03a9f4"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#212121"><meta name="application-name" content="Lan Tian @ Blog"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-precomposed.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#03a9f4"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lan Tian @ Blog"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1170x2532.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2532x1170.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1179x2556.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2556x1179.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1284x2778.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2778x1284.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1290x2796.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2796x1290.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1488x2266.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2266x1488.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1640x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1640.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"><meta name="msapplication-TileColor" content="#bbdefb"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta name="msapplication-config" content="/browserconfig.xml"><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"><meta property="og:url" content="https://lantian.pub/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/"><meta property="og:type" content="website"><meta property="og:title" content="NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05) - Lan Tian @ Blog"><meta property="og:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="A year ago, to simultaneously browse webpages and write codes on my Arch Linux installation and use Windows to run tasks infeasible on Linux (such as gaming), I tried GPU passthrough on my Lenovo R720 gaming laptop . But since that laptop has an Optimus MUXless architecture (as mentioned in that post), its dedicated GPU doesn&#38;#39;t have output ports, and the integrated GPU is in charge of all the displays. Therefore, severe limitations exist for that setup, and I eventually gave up on it. But now, I&#38;#39;ve purchased a new laptop. The HDMI output port on this laptop is directly connected to its NVIDIA dedicated graphics card, or in other words, it has an Optimus MUXed architecture. Since there is a way to make the virtual machine aware of a &#38;quot;monitor on the dedicated GPU&#38;quot;,..."><meta property="og:site_name" content="Lan Tian @ Blog"><meta property="og:locale" content="en"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://lantian.pub/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/"><meta name="twitter:title" content="NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05) - Lan Tian @ Blog"><meta property="twitter:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="A year ago, to simultaneously browse webpages and write codes on my Arch Linux installation and use Windows to run tasks infeasible on Linux (such as gaming), I tried GPU passthrough on my Lenovo R720 gaming laptop . But since that laptop has an Optimus MUXless architecture (as mentioned in that post), its dedicated GPU doesn&#38;#39;t have output ports, and the integrated GPU is in charge of all the displays. Therefore, severe limitations exist for that setup, and I eventually gave up on it. But now, I&#38;#39;ve purchased a new laptop. The HDMI output port on this laptop is directly connected to its NVIDIA dedicated graphics card, or in other words, it has an Optimus MUXed architecture. Since there is a way to make the virtual machine aware of a &#38;quot;monitor on the dedicated GPU&#38;quot;,..."><meta name="twitter:dnt" content="on"><meta itemprop="name" content="NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05) - Lan Tian @ Blog"><meta property="image" content="https://lantian.pub/apple-touch-icon.png"><meta content="A year ago, to simultaneously browse webpages and write codes on my Arch Linux installation and use Windows to run tasks infeasible on Linux (such as gaming), I tried GPU passthrough on my Lenovo R720 gaming laptop . But since that laptop has an Optimus MUXless architecture (as mentioned in that post), its dedicated GPU doesn&#38;#39;t have output ports, and the integrated GPU is in charge of all the displays. Therefore, severe limitations exist for that setup, and I eventually gave up on it. But now, I&#38;#39;ve purchased a new laptop. The HDMI output port on this laptop is directly connected to its NVIDIA dedicated graphics card, or in other words, it has an Optimus MUXed architecture. Since there is a way to make the virtual machine aware of a &#38;quot;monitor on the dedicated GPU&#38;quot;,..."><meta content="A year ago, to simultaneously browse webpages and write codes on my Arch Linux installation and use Windows to run tasks infeasible on Linux (such as gaming), I tried GPU passthrough on my Lenovo R720 gaming laptop . But since that laptop has an Optimus MUXless architecture (as mentioned in that post), its dedicated GPU doesn&#38;#39;t have output ports, and the integrated GPU is in charge of all the displays. Therefore, severe limitations exist for that setup, and I eventually gave up on it. But now, I&#38;#39;ve purchased a new laptop. The HDMI output port on this laptop is directly connected to its NVIDIA dedicated graphics card, or in other words, it has an Optimus MUXed architecture. Since there is a way to make the virtual machine aware of a &#38;quot;monitor on the dedicated GPU&#38;quot;,..."><link rel="me" href="https://mastodon.social/@lantian"></head> <body data-astro-cid-porej7z2=""> <div id="bg" data-astro-cid-j6vmxtef=""></div>   <div id="container" class="container" data-astro-cid-porej7z2=""> <nav class="lantian navbar navbar-expand-lg" data-astro-cid-wu5dj4rx=""> <div class="container-fluid" data-astro-cid-wu5dj4rx=""> <a class="navbar-brand" href="/en/" data-astro-cid-wu5dj4rx="">Lan Tian @ Blog</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#lantian-navbar" aria-controls="lantian-navbar" aria-expanded="false" aria-label="Toggle navigation" data-astro-cid-wu5dj4rx=""> <span class="navbar-toggler-icon" data-astro-cid-wu5dj4rx=""></span> </button> <div class="collapse navbar-collapse" id="lantian-navbar" data-astro-cid-wu5dj4rx=""> <ul class="navbar-nav" data-astro-cid-wu5dj4rx=""> <li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> <li class="nav-item dropdown d-block d-lg-none" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="pages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-file" data-astro-cid-wu5dj4rx=""></i> Page  <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="pages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> </ul> </li> </ul> <ul class="navbar-nav ms-auto" data-astro-cid-wu5dj4rx=""> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="languages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-language" data-astro-cid-wu5dj4rx=""></i> Language <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="languages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-cn" data-astro-cid-wu5dj4rx=""></span> Chinese Simplified / 简体中文 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item active" href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-us" data-astro-cid-wu5dj4rx=""></span> English </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">Not all pages have translations.</a> </li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">You may see 404 - this is normal.</a> </li> </ul> </li> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="color-scheme-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Night Mode </a> <ul class="dropdown-menu" aria-labelledby="color-scheme-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-auto" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Auto </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-light" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-sun" data-astro-cid-wu5dj4rx=""></i> Light</a> </li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-dark" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-moon" data-astro-cid-wu5dj4rx=""></i> Dark</a> </li> </ul> </li> </ul> </div> </div> </nav> <script type="module">const m="user-color-scheme",s="data-user-color-scheme",u=(e,t)=>{try{localStorage.setItem(e,t)}catch{}},i=e=>{try{return localStorage.getItem(e)}catch{return null}},c=e=>{const t={dark:!0,light:!0,auto:!0},o=e===null||!Object.keys(t).includes(e)?"auto":e;u(m,o);for(const l in t){const n=document.getElementById("color-scheme-"+l);n&&(l==o?n.classList.add("active"):n.classList.remove("active"))}o!="auto"?document.documentElement.setAttribute(s,o):document.documentElement.removeAttribute(s)};c(i(m));const r=document.getElementById("color-scheme-auto");r&&r.addEventListener("click",()=>c("auto"));const a=document.getElementById("color-scheme-light");a&&a.addEventListener("click",()=>c("light"));const d=document.getElementById("color-scheme-dark");d&&d.addEventListener("click",()=>c("dark"));</script>  <div class="d-flex" data-astro-cid-porej7z2=""> <div id="content" data-astro-cid-porej7z2="">  <article> <div class="d-flex"> <div class="post-info-wrap" data-astro-cid-dckccua4=""> <div class="post-info" data-astro-cid-dckccua4=""> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-clock"></span> <br> <small>05-08</small> </p> <div class="post-meta-value"> Published on<span class="badge badge-tag" data-astro-cid-dckccua4=""> 2023-05-08 00:28 </span>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-file-alt"></span> <br> <small>Computers and Clients</small> </p> <div class="post-meta-value"> Category <a class="badge badge-tag" href="/en/category/modify-computer" data-astro-cid-dckccua4=""> Computers and Clients </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-tag"></span> <br> <small>4 tags</small> </p> <div class="post-meta-value"> Tags  <a class="badge badge-tag" href="/en/tag/GPU" data-astro-cid-dckccua4=""> GPU </a>  <a class="badge badge-tag" href="/en/tag/Virtual-Machine" data-astro-cid-dckccua4=""> Virtual Machine </a>  <a class="badge badge-tag" href="/en/tag/NVIDIA" data-astro-cid-dckccua4=""> NVIDIA </a>  <a class="badge badge-tag" href="/en/tag/MUXed" data-astro-cid-dckccua4=""> MUXed </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-list"></span> <br> <small>ToC</small> </p> <div class="post-meta-value">  <ol data-astro-cid-nj3qel45=""> <li class="toc-item toc-level-1" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#changelog" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Changelog</span> </a> </li><li class="toc-item toc-level-1" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#preparation" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Preparation</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#purchasing-a-new-optimus-muxed-laptop" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Purchasing A New Optimus MUXed Laptop</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#about-intel-gvt-g-virtual-gpus" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">About Intel GVT-g Virtual GPUs</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#2023-05-about-intel-sr-iov-virtual-gpus" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">(2023-05) About Intel SR-IOV Virtual GPUs</span> </a> </li><li class="toc-item toc-level-1" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#steps" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Steps</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#stop-host-os-from-tampering-with-nvidia-gpu" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Stop Host OS from Tampering with NVIDIA GPU</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#setting-up-nvidia-dgpu-passthrough" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Setting up NVIDIA dGPU Passthrough</span> </a> </li><li class="toc-item toc-level-1" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#performance-and-experience-optimizations" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Performance and Experience Optimizations</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#get-audio-output-from-vm" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Get Audio Output from VM</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#passthrough-keyboard--mouse-operations" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Passthrough Keyboard &amp; Mouse Operations</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#accelerating-looking-glass-with-kernel-modules" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Accelerating Looking Glass with Kernel Modules</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#cutting-power-to-gpu-when-unused" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Cutting Power to GPU When Unused</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#references" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">References</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#appendix-final-libvirt-xml-file" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Appendix: Final Libvirt XML File</span> </a> </li> </ol>   </div> </div> </div> </div>  </div>  <div class="post-wrap">  <h1 class="post-title"> <a href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/" rel="bookmark" title="NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05)">NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05)</a> </h1> <div class="post-text">   <p>A year ago, to simultaneously browse webpages and write codes on my Arch Linux
installation and use Windows to run tasks infeasible on Linux (such as gaming),
<a href="/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/">I tried GPU passthrough on my Lenovo R720 gaming laptop</a>.
But since that laptop has an Optimus MUXless architecture (as mentioned in that
post), its dedicated GPU doesn&#39;t have output ports, and the integrated GPU is in
charge of all the displays. Therefore, severe limitations exist for that setup,
and I eventually gave up on it.</p>
<p>But now, I&#39;ve purchased a new laptop. The HDMI output port on this laptop is
directly connected to its NVIDIA dedicated graphics card, or in other words, it
has an Optimus MUXed architecture. Since there is a way to make the virtual
machine aware of a &quot;monitor on the dedicated GPU&quot;, most functionalities work
normally. I am finally able to create a GPU passthrough setup that works
long-term.</p>
<h1 id="changelog">Changelog</h1>
<ul>
<li>2023-05-08: Update some contents for new version of Looking Glass B6.</li>
<li>2022-01-26: The PCIe power-saving patch isn&#39;t effective.</li>
</ul>
<h1 id="preparation">Preparation</h1>
<p>Before following steps in this post, you need to prepare:</p>
<ol>
<li>
<p>A laptop with the Optimus MUXed architecture. My laptop is a HP OMEN
17t-ck000 (i7-11800H, RTX 3070).</p>
<ul>
<li>(2022-01) My operating system is Arch Linux, with the latest updates.</li>
<li>(2023-05) My operating system is now NixOS while writing this update. Most
of the steps, however, should still apply to other Linux distros.</li>
<li>It&#39;s recommended to turn off Secure Boot, but you likely did it anyway
since you installed Linux. Theoretically, Secure Boot may cause limitations
on the PCIe passthrough functionality.</li>
</ul>
</li>
<li>
<p>Set up a virtual machine of Windows 10 or Windows 11 with Libvirt
(Virt-Manager). I&#39;m using Windows 11.</p>
<ul>
<li>My VM boots in UEFI (OVMF) mode, but theoretically, this guide will also
work with BIOS (SeaBIOS) mode. There are no steps that specifically require
UEFI boot mode.</li>
<li><strong>You MUST turn off Secure Boot in the VM! Or some drivers won&#39;t work!</strong>
<ul>
<li>Windows 11 installer will check whether Secure Boot is enabled. With
Secure Boot off, the installer might prompt that the computer is
incompatible, and refuse to install Windows. You can follow the steps in
this post to fix the problem:
<a href="https://www.tomshardware.com/how-to/bypass-windows-11-tpm-requirement" rel="noopener noreferrer" target="_blank">https://www.tomshardware.com/how-to/bypass-windows-11-tpm-requirement</a></li>
</ul>
</li>
<li>Set up the emulated QXL graphics card first, so you get video output from
the VM.</li>
</ul>
</li>
<li>
<p>(Optional) Depending on the video output ports on your computer, purchase an
HDMI, DP, or USB Type-C dummy plug. You can get one for a few bucks on
Amazon.</p>
<ul>
<li>(2023-05) Or you can choose to install a virtual monitor driver.</li>
<li><picture><source srcset="/usr/uploads/202201/hdmi-dummy-plug.jpg.webp" type="image/webp"><source srcset="/usr/uploads/202201/hdmi-dummy-plug.jpg.avif" type="image/avif"><source srcset="/usr/uploads/202201/hdmi-dummy-plug.jpg.jxl" type="image/jxl"><img src="/usr/uploads/202201/hdmi-dummy-plug.jpg" alt="HDMI Dummy Plug"></picture></li>
</ul>
</li>
<li>
<p>(Optional) A USB keyboard and mouse combo.</p>
</li>
</ol>
<p>A reminder before we begin:</p>
<ul>
<li>Multiple reboots of the host OS is required, and your host OS may crash! Back
up your data.</li>
<li>You don&#39;t need to download any NVIDIA driver manually. Windows will do it for
you automatically.
<ul>
<li>If it doesn&#39;t, don&#39;t go any further than downloading the driver EXE and
double-clicking.</li>
<li><strong>Never</strong> specify the exact driver to be used in Device Manager.</li>
<li>Debugging will be harder if you do this.</li>
</ul>
</li>
</ul>
<h2 id="purchasing-a-new-optimus-muxed-laptop">Purchasing A New Optimus MUXed Laptop</h2>
<p>If you are interested in GPU passthrough and are looking for a new laptop, you
can refer to my guidelines.</p>
<p>The prerequisites for laptop GPU passthrough is:</p>
<ol>
<li>The NVIDIA GPU itself must be capable of video output</li>
<li>There is at least one video output directly connected to that GPU</li>
</ol>
<p>However, it&#39;s extremely rare for a laptop manufacturer to mention the port
connection schemes on their product pages, so we have to infer from more common
specifications:</p>
<ol>
<li>
<p>Prefer a laptop with a MUX switch, aka ones that can switch their internal
screen onto the dedicated GPU. In this case, the dedicated GPU must be
capable of video output, and there&#39;s a high chance that the manufacturer
connected the chassis video outputs to the dedicated GPU:</p>
<ul>
<li>Common examples are: 2020 and 2021 Lenovo Legion series, HP OMEN series,
and Dell G15.</li>
<li><strong>I do not guarantee that this list is accurate!</strong> Do your own research or
ask a sales agent to make sure.</li>
</ul>
</li>
<li>
<p>Or choose a laptop with a mid-range to high-end graphics card. For NVIDIA
GPUs the model number needs to end with 60 or larger.</p>
<ul>
<li>It&#39;s common for mid to top-tier NVIDIA GPUs to have video output
functionality, and the manufacturer is likely to connect chassis video
ports to them.</li>
<li>Do not purchase a laptop with a GPU that ends in 50 or lower, like an RTX
3050 or GTX 1650 Ti. They very likely don&#39;t support video output.</li>
</ul>
</li>
<li>
<p>Take advantage of unconditional return policies.</p>
<ul>
<li>Since manufacturers won&#39;t advertise or won&#39;t even care much about their
video output connections, we have to guess from the specifications and
advertising pages. Therefore, it&#39;s possible that you followed every rule
above yet got a laptop that doesn&#39;t support GPU passthrough. In this case,
you may consider returning or reselling it.</li>
<li>In some countries, laptop manufacturers will only accept an unconditional
return if the preinstalled Windows and Office are never activated online.
However, the latest Windows 11 requires you to activate online in its
first-boot setup wizard. You may consider trying GPU passthrough with a
Linux installation on your USB drive before activating Windows.</li>
</ul>
</li>
</ol>
<h2 id="about-intel-gvt-g-virtual-gpus">About Intel GVT-g Virtual GPUs</h2>
<p>5th to 9th-Gen Intel integrated graphics support virtualizing the GPU itself, or
in other words, splitting it into several virtual GPUs. The virtual GPUs can be
passed through into VMs so they get GPU acceleration, while the host can still
display stuff on the very same GPU.</p>
<p>However, the GVT-g driver in Linux doesn&#39;t support 10th-Gen or newer Intel CPUs,
and
<a href="https://github.com/intel/gvt-linux/issues/126" rel="noopener noreferrer" target="_blank">Intel has no plan to support them</a>.
In addition, the GVT-g virtual GPU cannot form an Optimus configuration with an
NVIDIA GPU, so it isn&#39;t useful anyway.</p>
<p>That&#39;s why we&#39;re ignoring GVT-g and focusing on the NVIDIA GPU in this guide.</p>
<h2 id="2023-05-about-intel-sr-iov-virtual-gpus">(2023-05) About Intel SR-IOV Virtual GPUs</h2>
<p>11th-Gen and later Intel integrated graphics support another form of
virtualization: SR-IOV. Intel has
<a href="https://github.com/intel/linux-intel-lts/tree/lts-v5.15.49-adl-linux-220826T092047Z/drivers/gpu/drm/i915" rel="noopener noreferrer" target="_blank">officially released the source code to the kernel module with SR-IOV</a>,
but it isn&#39;t merged into Linux mainline as of now.
<a href="https://github.com/strongtz/i915-sriov-dkms" rel="noopener noreferrer" target="_blank">There&#39;s a third party project that ports the code into a DKMS module</a>,
but success rate is not high according to reports in Issues section. I tried it
with my i7-11800H and didn&#39;t succeed. Therefore, this time we will not try
SR-IOV on Intel GPUs.</p>
<h1 id="steps">Steps</h1>
<h2 id="stop-host-os-from-tampering-with-nvidia-gpu">Stop Host OS from Tampering with NVIDIA GPU</h2>
<blockquote>
<p>Most of the content is the same as
<a href="/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/">my post in 2021</a>.</p>
</blockquote>
<p>The NVIDIA driver on the Host OS will hold control of the dGPU, and stop VM from
using it. Therefore you need to replace the driver with <code>vfio-pci</code>, built solely
for PCIe passthrough.</p>
<p>Here are the steps for disabling the NVIDIA driver and passing control to the
PCIe passthrough module:</p>
<ol>
<li>
<p>Run <code>lspci -nn | grep NVIDIA</code> and obtain an output similar to:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">0000:01:00.0</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> VGA</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> compatible</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> controller</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> [0300]: NVIDIA Corporation GA104M [GeForce RTX </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">3070</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> Mobile / Max-Q] [10de:249d] (</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">rev</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> a1</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">0000:01:00.1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Audio</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> device</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> [0403]: NVIDIA Corporation GA104 High Definition Audio Controller [10de:228b] (</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">rev</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> a1</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span></code></pre>
<p>Here <code>[10de:249d]</code> is the vendor ID and device ID of the dGPU, where <code>10de</code>
means this device is manufactured by NVIDIA, and <code>249d</code> means this is a
RTX 3070. <code>228b</code> is the audio output on the HDMI port, which should also be
taken over by <code>vfio-pci</code>.</p>
</li>
<li>
<p>Create <code>/etc/modprobe.d/lantian.conf</code> with the following content:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">options</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio-pci</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ids=10de:249d,10de:228b</span></span></code></pre>
<p>This configures <code>vfio-pci</code>, the kernel module responsible for PCIe
passthrough, to manage the dGPU. <code>ids</code> is the vendor ID and device ID of the
device to be passed through.</p>
</li>
<li>
<p>Modify <code>/etc/mkinitcpio.conf</code>, add the following contents to <code>MODULES</code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">MODULES</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=(</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">vfio_pci</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio_iommu_type1</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> vfio_virqfd</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">)</span></span></code></pre>
<p>And remove anything related to NVIDIA drivers (such as <code>nvidia</code>), or make
sure they&#39;re listed after VFIO drivers. Now PCIe passthrough module will take
control of the dGPU in the early booting process, preventing NVIDIA drivers
from taking control.</p>
</li>
<li>
<p>Run <code>mkinitcpio -P</code> to update the initramfs.</p>
</li>
<li>
<p>Reboot.</p>
</li>
</ol>
<p>(2023-05) If you&#39;re using NixOS, you can use the following config:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">{</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">  boot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">kernelModules</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> = [</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&quot;vfio-pci&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">];</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">  boot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">extraModprobeConfig</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> = </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&#39;&#39;</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    # Change to your GPU&#39;s vendor ID and device ID</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    options vfio-pci ids=10de:249d</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  &#39;&#39;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">  boot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">blacklistedKernelModules</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> = [</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&quot;nouveau&quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> &quot;nvidiafb&quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> &quot;nvidia&quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> &quot;nvidia-uvm&quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> &quot;nvidia-drm&quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> &quot;nvidia-modeset&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">];</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">}</span></span></code></pre>
<h2 id="setting-up-nvidia-dgpu-passthrough">Setting up NVIDIA dGPU Passthrough</h2>
<p>In
<a href="/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/">my post in 2021</a>,
I mentioned a lot of configurations to circumvent restrictions of the NVIDIA
driver. But
<a href="https://nvidia.custhelp.com/app/answers/detail/a_id/5173" rel="noopener noreferrer" target="_blank">since version 465, NVIDIA lifted most of the restrictions</a>,
so theoretically, you pass a GPU into the VM, and everything should just work.</p>
<p>But that&#39;s just the theory.</p>
<p>I still recommend everyone to follow all the steps and hide the VM
characteristics, because:</p>
<ol>
<li>
<p>(2022-01) Not all restructions are lifted for laptops.</p>
<ul>
<li><del>At least in my tests, an incorrect PCIe bus address for the GPU and the
absence of a battery still causes passthrough to fail, and the driver will
error out with the infamous code 43.</del></li>
<li>(2023-05) In the attempt today, the PCIe bus address and absence of battery
no longer affects outcome of GPU passthrough.</li>
</ul>
</li>
<li>
<p>Even if NVIDIA driver isn&#39;t detecting VMs, the programs you run might. Hiding
VM characteristics increases the chance to run them successfully.</p>
<ul>
<li>Examples include online games with anti-cheat systems, or commercial
software that require online activation.</li>
</ul>
</li>
</ol>
<p>And here we start:</p>
<ol>
<li>
<p>Unlike the Optimus MUXless architecture, I didn&#39;t manually extract the
graphic card&#39;s BIOS nor modify the UEFI firmware, and everything just works.</p>
<ul>
<li>If you cannot install the GPU driver after passing it into the VM,
including the cases that Windows won&#39;t automatically install them, or
NVIDIA&#39;s official installer errors out saying lack of compatible devices,
you likely will still need to extract your GPU&#39;s video BIOS.</li>
<li>To double-check, open Device Manager in the VM, and look at the Hardware
ID, which looks like <code>PCI\VEN_10DE&amp;DEV_1C8D&amp;SUBSYS_39D117AA&amp;REV_A1</code>. If
<code>SUBSYS</code> is followed by a sequence of zeros, then the GPU video BIOS is
missing, and you need the manual steps.</li>
<li>Refer to
<a href="/en/article/modify-computer/laptop-intel-nvidia-optimus-passthrough.lantian/">my post last year</a>,
specifically the NVIDIA GPU passthrough section, for detailed steps.</li>
</ul>
</li>
<li>
<p>Modify your VM configuration, <code>virsh edit Windows</code>, and make the following
changes:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&lt;!-- Modify the features section, so QEMU will hide the fact that this is a VM --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">acpi</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">apic</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;custom&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">relaxed</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vapic</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">spinlocks</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> retries</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;8191&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vpindex</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">runtime</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">synic</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">stimer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">reset</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vendor_id</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;GenuineIntel&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">frequencies</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">tlbflush</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hidden</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vmport</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;off&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&lt;!-- Add the PCIe passthrough device, must be below the hostdev for iGPU --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;subsystem&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;pci&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;yes&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;0x0000&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;0x01&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;0x00&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;0x0&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">rom</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bar</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;off&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &lt;!-- The PCIe bus address here MUST BE EXACTLY 01:00.0 --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &lt;!-- If there is a PCIe bus address conflict when saving config changes, --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &lt;!-- Remove &lt;address&gt; of all other devices --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &lt;!-- And Libvirt will reallocate PCIe bus addresses --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;pci&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;0x0000&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;0x01&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;0x00&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;0x0&#39;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;on&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&lt;!-- Add a shared memory between VM and host --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&lt;!-- So VM can transfer its display content to host --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">shmem</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;looking-glass&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;ivshmem-plain&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &lt;!-- Size is calculated as: display resolution width x height / 131072 --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &lt;!--                        then round up to power of 2 --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &lt;!-- Most HDMI dummy plugs have a resolution of 3840 x 2160 --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &lt;!-- The result is 63.28MB which rounds up to 64MB --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">size</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;M&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">64</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">size</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">shmem</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&lt;!-- Disable memory ballooning, this hurts performance significantly --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memballoon</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;none&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&lt;!-- Add these parameters before &lt;/qemu:commandline&gt; --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;-acpitable&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;file=/ssdt1.dat&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span></code></pre>
<p>The ssdt1.dat is an ACPI table, and it emulates a fully-charged battery. It
corresponds to the Base64 below. It can be converted to a binary file with
<a href="https://base64.guru/converter/decode/file" rel="noopener noreferrer" target="_blank">Base64 decoding website</a> or
<a href="/usr/uploads/202007/ssdt1.dat">downloaded from this site</a>. Place it in the
root folder.</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">U1NEVKEAAAAB9EJPQ0hTAEJYUENTU0RUAQAAAElOVEwYEBkgoA8AFVwuX1NCX1BDSTAGABBMBi5f</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">U0JfUENJMFuCTwVCQVQwCF9ISUQMQdAMCghfVUlEABQJX1NUQQCkCh8UK19CSUYApBIjDQELcBcL</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">cBcBC9A5C1gCCywBCjwKPA0ADQANTElPTgANABQSX0JTVACkEgoEAAALcBcL0Dk</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span></span></code></pre>
</li>
<li>
<p>Modify permissions for the shared memory.</p>
<ol>
<li>
<p>Modify <code>/etc/apparmor.d/local/abstractions/libvirt-qemu</code> and add this
line:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">/dev/shm/looking-glass</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> rw,</span></span></code></pre>
<p>Then execute <code>sudo systemctl restart apparmor</code> to restart AppArmor.</p>
</li>
<li>
<p>Create <code>/etc/tmpfiles.d/looking-glass.conf</code> with the following contents,
replacing <code>lantian</code> to your username:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">f</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /dev/shm/looking-glass</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658"> 0660</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> lantian</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> kvm</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> -</span></span></code></pre>
<p>Then execute
<code>sudo systemd-tmpfiles /etc/tmpfiles.d/looking-glass.conf --create</code> to
make it effective.</p>
</li>
</ol>
</li>
<li>
<p>Start the VM and wait a while. Windows will automatically install NVIDIA
drivers.</p>
<ul>
<li>If Device Manager shows the GPU with an exclamation sign and error code 43,
you need to check if you&#39;ve missed any steps and if you&#39;ve configured
everything correctly.
<ul>
<li>(2022-01) <del>Switch Device Manager to <code>Device by Connection</code> and verify
that the NVIDIA GPU is at Bus 1, Slot 0, Function 0. The parent PCIe port
to the dGPU should be at Bus 0, Slot 1, Function 0.</del></li>
<li><del>If they don&#39;t match, you need to reallocate PCIe addresses with the
method above.</del></li>
<li>(2023-05) This step is no longer needed in my attempt today.</li>
</ul>
</li>
<li>If the OS didn&#39;t automatically install the NVIDIA driver, and your manually
downloaded driver installer also shows that the system is incompatible, you
need to check the properties of the GPU device. Check if there is a
sequence of zeros after <code>SUBSYS</code> in its Hardware ID.
<ul>
<li>If there is, refer to step 1.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Turn off the virtual machine and restart it. <strong>This is not just a reboot.</strong>
Confirm in the device manager that the GPU is working.</p>
<ul>
<li>If you get code 43 this time, check if you have the emulated battery in
step 2.</li>
<li>I tried first on Windows 10 LTSC 2019 and got this error. Since I didn&#39;t
have the emulated battery set up, I cannot confirm if it&#39;s an
incompatibility between the NVIDIA driver and the OS or the lack of
battery. I recommend using the latest versions of Windows 10 or Windows 11.</li>
</ul>
</li>
<li>
<p>Do either one of the following steps:</p>
<ol>
<li>(2022-01) Plug your HDMI dummy plug into your laptop, and the VM should
detect a new monitor.</li>
<li>(2023-05) Install a virtual monitor driver:
<ol>
<li>Download the virtual monitor driver from
<a href="https://github.com/ge9/IddSampleDriver" rel="noopener noreferrer" target="_blank">ge9/IddSampleDriver</a>, and
decompress it to <code>C:\IddSampleDriver</code>. Note that you must not move the
folder anywhere else!</li>
<li>Open <code>C:\IddSampleDriver\option.txt</code>. You&#39;ll see the number 1 on the
first line (don&#39;t change it), followed by a list of resolutions and
refresh rates. Only keep the one resolution and refresh rate entry you
want, and remove all other items.</li>
<li>Open Device Manager, select &quot;Action - Add Legacy Hardware&quot;, click &quot;Let
me pick from a list... - All Devices - Have disk&quot;, choose the file
<code>C:\IddSampleDriver\IddSampleDriver.inf</code>, and complete the
installation.</li>
<li>Windows should now detect a new monitor.</li>
<li>In my testing, while using the virtual monitor driver, I saw some
corrupted pixels on the Looking Glass display. As long as you can
obtain an HDMI dummy plug, I would recommend it over the virtual
monitor driver.</li>
</ol>
</li>
</ol>
</li>
<li>
<p>(2023-05) Now the newer version of Looking Glass will install IVSHMEM driver
automatically (the driver for shared memory between VM and host). You no
longer need to install it manually. These manual installation steps are kept
for reference only:</p>
<ol>
<li>
<p>(2022-01) Download this Virtio driver, copy it into the VM, and extract
it. <strong>You MUST use this copy, as no other copies have the IVSHMEM
driver!</strong></p>
<p><a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/upstream-virtio/virtio-win10-prewhql-0.1-161.zip" rel="noopener noreferrer" target="_blank">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/upstream-virtio/virtio-win10-prewhql-0.1-161.zip</a></p>
</li>
<li>
<p>Open Device Manager in the VM, and find
<code>System devices - PCI standard RAM controller</code>:</p>
<ol>
<li>Right-click and select &quot;Update driver&quot;</li>
<li>Click &quot;Browse my computer for drivers&quot;</li>
<li>Click &quot;Let me pick from a list of device drivers on my computer&quot;</li>
<li>Click &quot;Have disk&quot; button</li>
<li>Navigate to <code>Virtio Drivers/Win10/amd64/ivshmem.inf</code> file</li>
<li>Click next to install the driver. The device&#39;s name should change to
<code>IVSHMEM</code></li>
</ol>
</li>
</ol>
</li>
<li>
<p>Install <a href="https://looking-glass.io/downloads" rel="noopener noreferrer" target="_blank">Looking Glass</a>, a tool to
transfer the display output from the VM to the host.</p>
<ul>
<li>Our dummy plug is going to be the only monitor the VM can see. If we don&#39;t
install looking glass, we won&#39;t be able to see the VM desktop.</li>
<li>Click &quot;Windows Host Binary&quot; on the link above, double click in the VM to
install it.</li>
</ul>
</li>
<li>
<p>(2023-05) If you followed the steps from 2022-01, you won&#39;t be able to see
the startup screen while the VM is booting, and before Looking Glass starts.
Therefore, I recommend disabling the QXL virtual adapter in Device Manager.
The following older steps are kept for reference purpose only.</p>
<ul>
<li>
<p>(2022-01) Turn off the VM and run <code>virsh edit Windows</code> to edit the VM
config.</p>
<p>Find <code>&lt;video&gt;&lt;model type=&quot;qxl&quot; ...&gt;&lt;/video&gt;</code>, change <code>type</code> to <code>none</code> to
disable the QXL emulated GPU:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;none&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span></code></pre>
</li>
</ul>
</li>
<li>
<p>Install Looking Glass client on the host. Arch Linux users can simply
install <code>looking-glass</code> from AUR. Run <code>looking-glass-client</code> to start the
client.</p>
</li>
<li>
<p>Back to Virt-Manager, close the window of the VM (the window that shows the
VM desktop and changes VM configurations), right-click on the VM on
Virt-Manager&#39;s main window, and select Run.</p>
</li>
<li>
<p>In a moment, you should see the VM&#39;s display on Looking Glass client. Now
the GPU passthrough setup is complete.</p>
</li>
</ol>
<h1 id="performance-and-experience-optimizations">Performance and Experience Optimizations</h1>
<p>Although GPU passthrough is done, there is still room for user experience
optimization. Particularly:</p>
<ol>
<li>(2022-01) <del>Looking Glass can relay keyboard and mouse events, but not audio,
so we can&#39;t hear the VM;</del>
<ul>
<li>(2023-05) The latest Looking Glass can relay audio now.</li>
</ul>
</li>
<li>(2022-01) <del>Looking Glass may miss a few keystrokes from time to time;</del>
<ul>
<li>(2023-05) The latest Looking Glass can relay keyboard and mouse events
reliably now.</li>
</ul>
</li>
<li>There is a host kernel module for IVSHMEM, which improves Looking Glass
performance with its DMA mode;</li>
<li>After VM shutdown, the GPU is set to PCIe D3hot mode. It still consumes
around 10 watts of power, which is undesirable for battery life.</li>
</ol>
<p>We will fix the problems one by one.</p>
<h2 id="get-audio-output-from-vm">Get Audio Output from VM</h2>
<p>(2023-05) The latest Looking Glass can relay audio now. These steps are kept for
reference only.</p>
<p></p><div class="btn-group" role="group" id="lti-g8980863">  <input type="radio" name="lti-g8980863" id="lti-8980863-0" class="btn-check lti-option" autocomplete="off" data-lti-tag="sound_hide"> <label class="btn btn-outline-primary" for="lti-8980863-0"> Hide </label>  <input type="radio" name="lti-g8980863" id="lti-8980863-1" class="btn-check lti-option" autocomplete="off" data-lti-tag="sound_show"> <label class="btn btn-outline-primary" for="lti-8980863-1"> Show older steps from 2022-01 </label>  </div> 
<div id="lti-content-sound_show" class="lti-content"><p>While Virt-Manager can connect to the VM with SPICE protocol to get the VM&#39;s
sound output, Looking Glass also relays keyboard and mouse events through SPICE.
Since the VM only accepts one simultaneous SPICE connection, we cannot get the
audio output with Virt-Manager.</p><p>We can install <a href="https://github.com/duncanthrax/scream" rel="noopener noreferrer" target="_blank">Scream</a>, a virtual sound
card software in Windows, to transfer audio output over the network. A Scream
client can be run on the host to receive the audio signal.</p><p>Download the Scream installer from
<a href="https://github.com/duncanthrax/scream/releases" rel="noopener noreferrer" target="_blank">its download page</a> on the VM,
extract it, run <code>Install-x64.bat</code> as administrator to install the driver, and
reboot.</p><p>Install the Scream client on the host. Arch Linux users can install the <code>scream</code>
package from AUR.</p><p>Open a terminal on the host and run <code>scream -v</code>. Test by playing some sound in
the VM. If you can&#39;t hear anything, try specifying the network interface to the
VM, like <code>scream -i virbr0 -v</code>, where <code>virbr0</code> is the default NAT network for
Virt-Manager, and the network interface between the VM and the host.</p><p>Finally, you can create a SystemD service to run the Scream client conveniently
later. Create <code>~/.config/systemd/user/scream.service</code> with the following
content:</p><pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">[Unit]</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">Description</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">Scream</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">[Service]</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">Type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">simple</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">Restart</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">always</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">RestartSec</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">1</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">ExecStart</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">/usr/bin/scream</span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26"> -i</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> virbr0</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -v</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">[Install]</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">WantedBy</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">graphical-session.target</span></span></code></pre><p>You will only need to run <code>systemctl --user start scream</code> in the future.</p></div>
<h2 id="passthrough-keyboard--mouse-operations">Passthrough Keyboard &amp; Mouse Operations</h2>
<p>The latest Looking Glass can relay keyboard and mouse events reliably now. These
steps are kept for reference only.</p>
<p></p><div class="btn-group" role="group" id="lti-g11532">  <input type="radio" name="lti-g11532" id="lti-11532-0" class="btn-check lti-option" autocomplete="off" data-lti-tag="keyboardmouse_hide"> <label class="btn btn-outline-primary" for="lti-11532-0"> Hide </label>  <input type="radio" name="lti-g11532" id="lti-11532-1" class="btn-check lti-option" autocomplete="off" data-lti-tag="keyboardmouse_show"> <label class="btn btn-outline-primary" for="lti-11532-1"> Show older steps from 2022-01 </label>  </div> 
<div id="lti-content-keyboardmouse_show" class="lti-content"><p>The relay of the keyboard and mouse in Looking Glass isn&#39;t very stable, as
misses of operation can happen from time to time. Therefore, if you want to play
some games in the VM, you need a more reliable way to pass your keyboard and
mouse into the VM.</p><p>We have two options: letting Libvirt capture the keyboard and mouse events or
simply pass your keyboard and mouse into the VM.</p><ol>
<li>
<p>Capturing Keyboard and Mouse Events.</p>
<p>On Linux, all keyboard and mouse operations are passed to the desktop
environment via the <code>evdev</code> (or <code>Event Device</code>) framework. Libvirt can
capture your operations and pass them to the VM. In addition, Libvirt can
switch the control between the host and the VM whenever you press Left Ctrl
and the Right Ctrl, so you can operate on both the host and the VM with one
keyboard-mouse combo.</p>
<p>First run <code>ls -l /dev/input/by-path</code> on the host to see your present <code>evdev</code>
devices. I have these ones for example:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pci-0000:00:14.0-usb-0:1:1.1-event-mouse</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000">               # USB mouse</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pci-0000:00:14.0-usb-0:1:1.1-mouse</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pci-0000:00:14.0-usb-0:6:1.0-event</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pci-0000:00:15.0-platform-i2c_designware.0-event-mouse</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000"> # Builtin Touchpad</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pci-0000:00:15.0-platform-i2c_designware.0-mouse</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">pci-0000:00:1f.3-platform-skl_hda_dsp_generic-event</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">platform-i8042-serio-0-event-kbd</span><span style="--shiki-dark:#6A9955;--shiki-light:#008000">                       # Builtin Keyboard</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">platform-pcspkr-event-spkr</span></span></code></pre>
<p>Those with <code>event-mouse</code> are mouses, and the <code>event-kbd</code> ones are keyboards.</p>
<p>Then, run <code>virsh edit Windows</code> to edit the VM config. Add these into the
<code>&lt;devices&gt;</code> section:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;evdev&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  &lt;!-- Change the mouse or keyboard path based on your ls result --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dev</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;/dev/input/by-path/platform-i8042-serio-0-event-kbd&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> grab</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;all&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> repeat</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&lt;!-- Repeat if you have many mouses or keyboards --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;evdev&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dev</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;/dev/input/by-path/pci-0000:00:15.0-platform-i2c_designware.0-event-mouse&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> grab</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;all&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> repeat</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span></code></pre>
<p>Start the VM, and you should notice that your keyboard and mouse aren&#39;t
working on the host. They&#39;re captured by the VM. Press Left Ctrl + Right Ctrl
to return control to the host. Press again to control the VM.</p>
<p>Now we can disable the keyboard and mouse relay of Looking Glass. Create
<code>/etc/looking-glass-client.ini</code> with the following content:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">[spice]</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">enable</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=no</span></span></code></pre>
</li>
<li>
<p>USB Keyboard and Mouse Passthrough</p>
<p>Capturing keyboard and mouse operations doesn&#39;t always work. For example, my
touchpad cannot be captured properly, as I can&#39;t move the cursor in the VM.</p>
<p>If you also encountered the issue and you have a USB keyboard and mouse
combo, you can pass them into the VM and use them specifically for it. USB
passthrough to VM is a mature technology, so the chance of running into
problems is very low.</p>
<p>Simply click <code>Add Hardware - USB Host Device</code> in Virt-Manager and select your
keyboard and mouse.</p>
</li>
</ol></div>
<h2 id="accelerating-looking-glass-with-kernel-modules">Accelerating Looking Glass with Kernel Modules</h2>
<blockquote>
<p>Most of the content in this section is from
<a href="https://looking-glass.io/docs/B6/module/" rel="noopener noreferrer" target="_blank">https://looking-glass.io/docs/B6/module/</a></p>
</blockquote>
<p>Looking Glass provides a kernel module for the IVSHMEM shared memory device. It
allows Looking Glass to read the display output efficiently with DMA to improve
the framerate.</p>
<ol>
<li>
<p>Install Linux kernel header files and DKMS, or the packages of
<code>linux-headers</code> and <code>dkms</code> on Arch Linux.</p>
</li>
<li>
<p>Install <code>looking-glass-module-dkms</code> from AUR.</p>
</li>
<li>
<p>Set up an Udev rule: create <code>/etc/udev/rules.d/99-kvmfr.rules</code> with the
following content:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">SUBSYSTEM</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">=&quot;kvmfr&quot;,</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080"> OWNER</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&quot;lantian&quot;,</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080"> GROUP</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&quot;kvm&quot;,</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080"> MODE</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&quot;0660&quot;</span></span></code></pre>
<p>Replace <code>lantian</code> with your own username.</p>
</li>
<li>
<p>Configure the memory size: create <code>/etc/modprobe.d/looking-glass.conf</code> with
the following content:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># The memory size is calculates in the same way as VM&#39;s shmem.</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">options</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> kvmfr</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> static_size_mb=</span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">64</span></span></code></pre>
</li>
<li>
<p>Load the module automatically on boot: create
<code>/etc/modules-load.d/looking-glass.conf</code> with a single line of <code>kvmfr</code>.</p>
</li>
<li>
<p>Run <code>sudo modprobe kvmfr</code> to load the module. Now a <code>kvmfr0</code> device should
appear under <code>/dev</code>, and this is the memory device for Looking Glass.</p>
</li>
<li>
<p>Edit <code>/etc/apparmor.d/local/abstractions/libvirt-qemu</code> and add this line:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">/dev/kvmfr0</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> rw,</span></span></code></pre>
<p>It allows the VM to access the device. Run <code>sudo systemctl restart apparmor</code>
to restart AppArmor.</p>
</li>
<li>
<p>Run <code>virsh edit Windows</code> to change the VM&#39;s configuration：</p>
<ol>
<li>
<p>Delete <code>&lt;shmem&gt;</code> section from <code>&lt;devices&gt;</code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">shmem</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;looking-glass&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;ivshmem-plain&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">size</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&#39;M&#39;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">64</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">size</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">shmem</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span></code></pre>
</li>
<li>
<p>Add these lines under <code>&lt;qemu:commandline&gt;</code>:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;-device&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;{</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">driver</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">ivshmem-plain</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">id</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">shmem-looking-glass</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">memdev</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">looking-glass</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">}&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;-object&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&lt;!-- There is a number 67108864 in the next line, which is 64MB * 1048576 --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">&lt;!-- Change accordingly if you&#39;ve set a different memory size --&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;{</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">qom-type</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">memory-backend-file</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">id</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">looking-glass</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">mem-path</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">/dev/kvmfr0</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">size</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:67108864,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">share</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:true}&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span></code></pre>
</li>
<li>
<p>Start the VM.</p>
</li>
</ol>
</li>
<li>
<p>Change <code>/etc/looking-glass-client.ini</code> and add the following content:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">[app]</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">shmFile</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=/dev/kvmfr0</span></span></code></pre>
</li>
<li>
<p>Start Looking Glass. You should see the VM display now.</p>
</li>
<li>
<p>(2023-05) If you use NixOS, you can directly use the config below:</p>
</li>
</ol>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">{</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">  boot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">extraModulePackages</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> = </span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">with</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080"> config</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">boot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">kernelPackages</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">; [</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#001080">    kvmfr</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">  ];</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">  boot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">extraModprobeConfig</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> = </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&#39;&#39;</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    # The memory size is calculates in the same way as VM&#39;s shmem.</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    options kvmfr static_size_mb=64</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  &#39;&#39;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">;</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">  boot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">kernelModules</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> = [</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&quot;kvmfr&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">];</span></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">  services</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">udev</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">extraRules</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> = </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&#39;&#39;</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    SUBSYSTEM==&quot;kvmfr&quot;, OWNER=&quot;root&quot;, GROUP=&quot;libvirtd&quot;, MODE=&quot;0660&quot;</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  &#39;&#39;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">  environment</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">etc</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&quot;looking-glass-client.ini&quot;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">.</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000">text</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> = </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">&#39;&#39;</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    [app]</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    shmFile=/dev/kvmfr0</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  &#39;&#39;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">;</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">}</span></span></code></pre>
<h2 id="cutting-power-to-gpu-when-unused">Cutting Power to GPU When Unused</h2>
<p><strong>2022-01-26 Update: testing shows that the NVIDIA GPU still isn&#39;t completely
shut down after applying the patch. The power draw is the same as before. This
section is now invalid.</strong></p>
<p></p><div class="btn-group" role="group" id="lti-g4746474">  <input type="radio" name="lti-g4746474" id="lti-4746474-0" class="btn-check lti-option" autocomplete="off" data-lti-tag="power_hide"> <label class="btn btn-outline-primary" for="lti-4746474-0"> Invalid contents are hidden </label>  <input type="radio" name="lti-g4746474" id="lti-4746474-1" class="btn-check lti-option" autocomplete="off" data-lti-tag="power_show"> <label class="btn btn-outline-primary" for="lti-4746474-1"> Show </label>  </div> 
<div id="lti-content-power_show" class="lti-content"><blockquote>
<p>This section only applies to 20-series of NVIDIA GPUs or newer. They can shut
themselves down with the NVIDIA official drivers. The 10-series or older GPUs
don&#39;t support this feature.</p>
<p>This section involves compiling a kernel yourself, and <strong>using an patch
without extensive inspection or testing</strong>. Not intended for novice users.
Evaluate the risks yourself.</p>
</blockquote><p>When you aren&#39;t using the VM, the <code>vfio-pci</code> driver in charge of PCIe
passthrough sets the device to the <code>D3</code> mode, aka the power saving mode of PCIe
devices. But there are two types of <code>D3</code> modes: <code>D3hot</code>, where the device is
still powered, and <code>D3cold</code>, where the device is shut off completely. Currently,
the <code>vfio-pci</code> driver in the kernel only supports <code>D3hot</code>, and the NVIDIA GPU
will still consume around 10 watts of power since its chip power isn&#39;t cut. This
impacts the battery life of laptops.</p><p>An NVIDIA engineer posted a patchset for <code>vfio-pci</code>&#39;s <code>D3cold</code> support on the
Linux kernel mailing list. With this patchset, the NVIDIA GPU will be shut down
completely when the VM is off. It saves power for your battery.</p><p>The patchset can be found at
<a href="https://lore.kernel.org/lkml/20211115133640.2231-1-abhsahu@nvidia.com/T/" rel="noopener noreferrer" target="_blank">https://lore.kernel.org/lkml/20211115133640.2231-1-abhsahu@nvidia.com/T/</a>,
which consists of three patches. I combined the three patches and uploaded the
result to
<a href="https://github.com/xddxdd/pkgbuild/blob/master/linux-xanmod-lantian/0007-vfio-pci-d3cold.patch" rel="noopener noreferrer" target="_blank">https://github.com/xddxdd/pkgbuild/blob/master/linux-xanmod-lantian/0007-vfio-pci-d3cold.patch</a>.</p><p>Patching kernel is relatively simple for Arch Linux. Most kernel PKGBUILDs in
AUR can apply patches automatically. All you have to do is to download the
PKGBUILD for a kernel and add the patch to its <code>source</code> section. See my commit
for an example:
<a href="https://github.com/xddxdd/pkgbuild/commit/406adb7bf5657cfe07bb17ff561d11ed97ebab39" rel="noopener noreferrer" target="_blank">https://github.com/xddxdd/pkgbuild/commit/406adb7bf5657cfe07bb17ff561d11ed97ebab39</a>.</p><p><strong>DO NOTE that this patch doesn&#39;t guarantee stability.</strong></p><p>Based on mailing list discussions:</p><ol>
<li>It&#39;s an RFC patch, aka a testing patch. There is a big <code>[RFC]</code> on the title
of the e-mails.</li>
<li>If the GPU driver in the VM ever attempts to switch the GPU to <code>D3cold</code> mode,
with this patch, there are risks of resetting the GPU, losing all states, and
crashing the VM. Although I have never encountered such problems in my
experience, you should be aware of the possible outcomes.</li>
<li>The developer only tested some GPUs from NVIDIA. It does not guarantee
support for other PCIe devices.</li>
</ol><p><strong>Use this at your own risk.</strong></p></div>
<h2 id="references">References</h2>
<p>Huge thanks to previous explorers on the topic of GPU passthrough. Without their
efforts, this post won&#39;t have existed in the first place.</p>
<p>Here are the sources I referenced when I did my configuration:</p>
<ul>
<li>NVIDIA dGPU passthrough
<ul>
<li>GitHub Misairu-G&#39;s NVIDIA Optimus MUXed passthrough guide
<a href="https://gist.github.com/Misairu-G/616f7b2756c488148b7309addc940b28" rel="noopener noreferrer" target="_blank">https://gist.github.com/Misairu-G/616f7b2756c488148b7309addc940b28</a></li>
<li>Reddit r/VFIO&#39;s emulated battery patch
<a href="https://www.reddit.com/r/VFIO/comments/ebo2uk/nvidia_geforce_rtx_2060_mobile_success_qemu_ovmf/" rel="noopener noreferrer" target="_blank">https://www.reddit.com/r/VFIO/comments/ebo2uk/nvidia_geforce_rtx_2060_mobile_success_qemu_ovmf/</a></li>
<li>Arch Linux Wiki
<a href="https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF" rel="noopener noreferrer" target="_blank">https://wiki.archlinux.org/title/PCI_passthrough_via_OVMF</a></li>
</ul>
</li>
<li>Looking Glass Documentation
<ul>
<li>Installation Docs
<a href="https://looking-glass.io/docs/B6/install/" rel="noopener noreferrer" target="_blank">https://looking-glass.io/docs/B6/install/</a></li>
<li>Kernel Module Docs
<a href="https://looking-glass.io/docs/B6/module/" rel="noopener noreferrer" target="_blank">https://looking-glass.io/docs/B6/module/</a></li>
</ul>
</li>
<li>Virtual Monitor Driver
<ul>
<li>The one used in this post, with ability to customize resolution and refresh
rate
<a href="https://github.com/ge9/IddSampleDriver" rel="noopener noreferrer" target="_blank">https://github.com/ge9/IddSampleDriver</a></li>
<li>The original version with fixed list of resolution and refresh rate
<a href="https://github.com/roshkins/IddSampleDriver" rel="noopener noreferrer" target="_blank">https://github.com/roshkins/IddSampleDriver</a></li>
</ul>
</li>
<li>VFIO D3cold Patch
<ul>
<li>News report from Phoronix
<a href="https://www.phoronix.com/scan.php?page=news_item&px=NVIDIA-Runtime-PM-VFIO-PCI" rel="noopener noreferrer" target="_blank">https://www.phoronix.com/scan.php?page=news_item&amp;px=NVIDIA-Runtime-PM-VFIO-PCI</a></li>
<li>Link to Linux kernel mailing list
<a href="https://lore.kernel.org/lkml/20211115133640.2231-1-abhsahu@nvidia.com/T/" rel="noopener noreferrer" target="_blank">https://lore.kernel.org/lkml/20211115133640.2231-1-abhsahu@nvidia.com/T/</a></li>
</ul>
</li>
</ul>
<h2 id="appendix-final-libvirt-xml-file">Appendix: Final Libvirt XML File</h2>
<p></p><div class="btn-group" role="group" id="lti-g2436000">  <input type="radio" name="lti-g2436000" id="lti-2436000-0" class="btn-check lti-option" autocomplete="off" data-lti-tag="xml_hide"> <label class="btn btn-outline-primary" for="lti-2436000-0"> Hide </label>  <input type="radio" name="lti-g2436000" id="lti-2436000-1" class="btn-check lti-option" autocomplete="off" data-lti-tag="xml_show"> <label class="btn btn-outline-primary" for="lti-2436000-1"> Show the entire XML file </label>  </div> 
<div id="lti-content-xml_show" class="lti-content"><pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">domain</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:qemu</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;http://libvirt.org/schemas/domain/qemu/1.0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;kvm&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">name</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">Windows11</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">name</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">uuid</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">5d5b00d8-475a-4b6c-8053-9dda30cd2f95</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">uuid</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">metadata</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">libosinfo:libosinfo</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:libosinfo</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;http://libosinfo.org/xmlns/libvirt/domain/1.0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">libosinfo:os</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> id</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;http://microsoft.com/win/11&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">libosinfo:libosinfo</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">metadata</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memory</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;KiB&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">16777216</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memory</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">currentMemory</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;KiB&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">16777216</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">currentMemory</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vcpu</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> placement</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;static&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">16</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vcpu</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> arch</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;x86_64&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> machine</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pc-q35-8.0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">hvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">type</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> readonly</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;yes&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pflash&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/run/libvirt/nix-ovmf/OVMF_CODE.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">loader</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> template</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;/run/libvirt/nix-ovmf/OVMF_VARS.fd&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/var/lib/libvirt/qemu/nvram/Windows11_VARS.fd</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">nvram</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">os</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">acpi</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">apic</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;custom&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">relaxed</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vapic</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">spinlocks</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> retries</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;8191&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vpindex</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">runtime</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">synic</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">stimer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">reset</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vendor_id</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;GenuineIntel&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">frequencies</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">tlbflush</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hyperv</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hidden</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">kvm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">vmport</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> state</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;off&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">features</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cpu</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;host-passthrough&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> check</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;none&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> migratable</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">topology</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> sockets</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dies</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> cores</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;8&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> threads</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;2&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cpu</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">clock</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> offset</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;localtime&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;rtc&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> tickpolicy</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;catchup&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pit&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> tickpolicy</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;delay&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;hpet&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> present</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;no&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">timer</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;hypervclock&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> present</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;yes&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">clock</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_poweroff</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">destroy</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_poweroff</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_reboot</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">restart</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_reboot</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_crash</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">destroy</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">on_crash</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">pm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">suspend-to-mem</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enabled</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;no&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">suspend-to-disk</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> enabled</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;no&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">pm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">devices</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">emulator</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">/run/libvirt/nix-emulators/qemu-system-x86_64</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">emulator</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;file&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> device</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;disk&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">driver</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;qemu&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;qcow2&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> discard</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;unmap&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> file</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;/var/lib/libvirt/images/Windows11.qcow2&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dev</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;vda&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;virtio&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">boot</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> order</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x04&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;file&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> device</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;cdrom&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">driver</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;qemu&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;raw&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> file</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;/mnt/root/persistent/media/LegacyOS/Common/virtio-win-0.1.215.iso&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> dev</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;sdb&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;sata&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">readonly</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;drive&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> controller</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> target</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> unit</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">disk</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;usb&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;qemu-xhci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> ports</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;15&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x02&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x10&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x02&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;2&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;2&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x11&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x02&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x1&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;3&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;3&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x12&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x02&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x2&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;4&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;4&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x13&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x02&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x3&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;5&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;5&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x14&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x02&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x4&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;6&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;6&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x15&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x02&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x5&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;7&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;7&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x16&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x02&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x6&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;8&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;8&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x17&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x02&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x7&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;9&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;9&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x18&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x03&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> multifunction</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;on&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;10&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;10&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x19&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x03&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x1&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;11&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;11&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x1a&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x03&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x2&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;12&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;12&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x1b&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x03&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x3&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;13&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;13&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x1c&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x03&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x4&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;14&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pcie-root-port&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> chassis</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;14&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x1d&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x03&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x5&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;sata&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x1f&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x2&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;virtio-serial&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> index</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x03&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">controller</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">interface</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;network&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">mac</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> address</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;52:54:00:f4:bf:15&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> network</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;default&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;virtio&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x01&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">interface</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">serial</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pty&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;isa-serial&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">        &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;isa-serial&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">serial</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">console</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pty&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;serial&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">console</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">channel</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;spicevmc&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">target</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;virtio&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> name</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;com.redhat.spice.0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;virtio-serial&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> controller</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">channel</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;mouse&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;ps2&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;mouse&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;virtio&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x06&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;keyboard&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;ps2&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;keyboard&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;virtio&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x07&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">input</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">tpm</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;tpm-crb&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">backend</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;passthrough&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">        &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">device</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> path</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;/dev/tpm0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">backend</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">tpm</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;spice&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> autoport</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;yes&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">listen</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;address&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">image</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> compression</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;off&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">graphics</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">sound</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;ich9&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">audio</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> id</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x1b&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">sound</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">audio</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> id</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;spice&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">model</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;qxl&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> ram</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;65536&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> vram</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;65536&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> vgamem</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;16384&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> heads</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;1&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> primary</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;yes&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x01&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">video</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;subsystem&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> managed</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;yes&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">        &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x01&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">source</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;pci&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> domain</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0000&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x05&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> slot</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x00&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> function</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0x0&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">hostdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;usb&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;spicevmc&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;usb&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;2&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;usb&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;spicevmc&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">address</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;usb&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> bus</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;0&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;3&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">redirdev</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">watchdog</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;itco&quot;</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> action</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;reset&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">memballoon</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> model</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;none&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">devices</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;-device&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;{</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">driver</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">ivshmem-plain</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">id</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">shmem0</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">memdev</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">looking-glass</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">}&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;-object&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;{</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">qom-type</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">memory-backend-file</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">id</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">looking-glass</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">mem-path</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">/dev/kvmfr0</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">size</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:67108864,</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">share</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">&amp;quot;</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">:true}&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;-acpitable&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &lt;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:arg</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> value</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">&quot;file=/etc/ssdt1.dat&quot;</span><span style="--shiki-dark:#808080;--shiki-light:#800000">/&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">qemu:commandline</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&lt;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">domain</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&gt;</span></span></code></pre></div>  </div>  <div class="clearfix" id="post-navi" data-astro-cid-gfbmwgei=""> <div class="float-end text-end" data-astro-cid-gfbmwgei=""> <a href="/en/article/random-notes/fix-china-telecom-roaming-no-4g-on-aosp-rom.lantian/" title="Fix China Telecom 4G Roaming on AOSP ROM by Changing APN" data-astro-cid-gfbmwgei=""> Fix China Telecom 4G Roaming on AOSP ROM by Changing APN </a> <br data-astro-cid-gfbmwgei=""> Next post »
</div> <div class="float-start text-start position-absolute" data-astro-cid-gfbmwgei="">
« Previous post <br data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-website/how-to-kill-the-dn42-network.lantian/" title="How to Kill the DN42 Network (Updated 2023-05-12)" data-astro-cid-gfbmwgei=""> How to Kill the DN42 Network (Updated 2023-05-12) </a> </div> </div>  <div id="waline" data-waline-language="en-US" data-waline-path="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian"></div> <script type="module" src="/assets/WalineComment.astro_astro_type_script_index_0_lang.Dqib3X1E.js"></script>  </div> </div> </article>  </div> <aside class="d-none d-xl-block"> <section class="widget"> <h3>Latest posts</h3> <ul class="list-unstyled"> <li> 07-20  <a href="/en/article/modify-computer/legal-lte-network-at-home-with-open5gs.lantian/">Legal LTE Network at Home with Open5GS</a> </li><li> 06-27  <a href="/en/article/modify-computer/sidestore-without-stosvpn-across-lan.lantian/">Using SideStore without StosVPN across your LAN</a> </li><li> 05-19  <a href="/en/article/modify-computer/nix-logarithmetic-math-library-from-zero.lantian/">Nix Logarithmic Math Library from Ground Zero</a> </li><li> 04-06  <a href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/">Legal LTE Network at Home for $100</a> </li><li> 02-10  <a href="/en/article/modify-computer/build-custom-android-kernel-with-nix.lantian/">Building Custom Android Kernel with Nix</a> </li><li> 04-20  <a href="/en/article/modify-website/migrate-blog-to-astro-js.lantian/">Migrating My Blog to Astro.js</a> </li><li> 12-16  <a href="/en/article/modify-computer/nixos-low-ram-vps.lantian/">NixOS Series 5: Creating Disk Image for Low RAM VPS</a> </li><li> 09-20  <a href="/en/article/modify-computer/nix-trigonometric-math-library-from-zero.lantian/">Nix Trigonometric Math Library from Ground Zero</a> </li><li> 05-29  <a href="/en/article/random-notes/pipewire-sigkill-fix.lantian/">Preventing Pipewire from being SIGKILLed</a> </li><li> 05-12  <a href="/en/article/modify-website/how-to-kill-the-dn42-network.lantian/">How to Kill the DN42 Network (Updated 2023-05-12)</a> </li><li> 05-08  <a href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/">NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05)</a> </li><li> 04-17  <a href="/en/article/random-notes/fix-china-telecom-roaming-no-4g-on-aosp-rom.lantian/">Fix China Telecom 4G Roaming on AOSP ROM by Changing APN</a> </li><li> 03-26  <a href="/en/article/random-notes/old-hp-workstation-as-all-in-one.lantian/">Notes on Setting Up NAS+Router on Old HP Workstation</a> </li><li> 01-14  <a href="/en/article/modify-computer/nixos-impermanence.lantian/">NixOS Series 4: &quot;Stateless&quot; Operating System</a> </li><li> 06-21  <a href="/en/article/modify-computer/nixos-packaging.lantian/">NixOS Series 3: Software Packaging 101</a> </li> </ul> </section> <section class="widget"> <h3>Latest comments</h3> <ul class="list-unstyled" id="recent-comments">  <li><a href="#">Loading...</a></li>  </ul> </section> <script type="module">const i=window.location.hostname=="localhost"?"https://comments.lantian.pub":window.location.origin;fetch(`${i}/api/comment?type=recent&count=10`).then(t=>{if(t.status!==200)throw new Error(`Server returned bad HTTP status ${t.status}`);return t.json()}).then(t=>{const e=document.getElementById("recent-comments");e&&(e.innerHTML=t.data.map(n=>{const o=n.comment.replace(/(<([^>]+)>)/gi,"");return"<li>"+n.nick+' <a href="'+n.url+'">'+o+"</a></li>"}).join(""))});</script> <section class="widget"> <h3>Others</h3> <ul class="list-unstyled">  <li> <i class="fas fa-fw fa-rss"></i>  <a href="/rss2.xml" target="_blank">RSS Feed</a> |  <a href="/feed.xml" target="_blank">Atom</a> |  <a href="/feed.json" target="_blank">JSON</a> </li> <li> <i class="fas fa-fw fa-globe"></i>  <a href="https://stats.uptimerobot.com/BLK6VsRkR" target="_blank"> Sever Status </a> </li> <li> <i class="fas fa-fw fa-sitemap"></i>  <a href="https://lg.lantian.pub" target="_blank">DN42 Looking Glass</a> </li> <li> <i class="fas fa-fw fa-link"></i>  <a href="gopher://lantian.pub" target="_blank">Access with Gopher protocol</a> </li>  </ul> </section> <section class="widget"> <h3>Links</h3> <ul class="list-unstyled"> <li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://0x7f.cc"> 0x7f Blog 🐑 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="http://foreverblog.cn"> 10 Year&#39;s Promise (Forever Blog) </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://alanyhq.com"> Alanyhq </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.baoshuo.ren/?utm_source=friends"> Baoshuo&#39;s Blog </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.cas7.moe"> Blog of Moecast </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://jerryxiao.cc"> JerryXiao </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://sangsir.com"> SangSir </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://snli.org"> Shucheng Li </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://yuetau.net"> YuetAu&#39;s Spot </a> </li> </ul> </section> </aside> </div> <footer class="lantian clearfix" data-astro-cid-w3csb3e3="">  <div id="copyright" class="float-end text-end" data-astro-cid-w3csb3e3=""> <i class="fas fa-copyright" data-astro-cid-w3csb3e3=""></i> 2012-2025 Lan Tian @ Blog<br data-astro-cid-w3csb3e3=""> <small data-astro-cid-w3csb3e3=""> Powered by Astro v5.15.1 @ 2025-10-25 23:46:37 </small> </div> <script type="module">function v(c,o,r){const h=/^localhost$|^127(?:\.[0-9]+){0,2}\.[0-9]+$|^(?:0*:)*?:?0*1$/.test(location.hostname)||location.protocol==="file:";if(!o.trackLocalhost&&h)return console.warn("[Plausible] Ignoring event because website is running locally");try{if(window.localStorage.plausible_ignore==="true")return console.warn('[Plausible] Ignoring event because "plausible_ignore" is set to "true" in localStorage')}catch{}const p={n:c,u:o.url,d:o.domain,r:o.referrer,w:o.deviceWidth,h:o.hashMode?1:0,p:r&&r.props?JSON.stringify(r.props):void 0},s=new XMLHttpRequest;s.open("POST",`${o.apiHost}/api/event`,!0),s.setRequestHeader("Content-Type","text/plain"),s.send(JSON.stringify(p)),s.onreadystatechange=()=>{s.readyState===4&&r&&r.callback&&r.callback()}}function b(c){const o=()=>({hashMode:!1,trackLocalhost:!1,url:location.href,domain:location.hostname,referrer:document.referrer||null,deviceWidth:window.innerWidth,apiHost:"https://plausible.io",...c}),r=(t,n,i)=>{v(t,{...o(),...i},n)},h=(t,n)=>{r("pageview",n,t)};return{trackEvent:r,trackPageview:h,enableAutoPageviews:()=>{const t=()=>h(),n=history.pushState;return n&&(history.pushState=function(i,l,u){n.apply(this,[i,l,u]),t()},addEventListener("popstate",t)),c&&c.hashMode&&addEventListener("hashchange",t),h(),function(){n&&(history.pushState=n,removeEventListener("popstate",t)),c&&c.hashMode&&removeEventListener("hashchange",t)}},enableAutoOutboundTracking:(t=document,n={subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]})=>{function i(e){r("Outbound Link: Click",{props:{url:this.href}}),typeof process<"u"&&process,setTimeout(()=>{location.href=this.href},150),e.preventDefault()}const l=new Set;function u(e){e instanceof HTMLAnchorElement?e.host!==location.host&&(e.addEventListener("click",i),l.add(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(u)}function f(e){e instanceof HTMLAnchorElement?(e.removeEventListener("click",i),l.delete(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(f)}const d=new MutationObserver(e=>{e.forEach(a=>{a.type==="attributes"?(f(a.target),u(a.target)):a.type==="childList"&&(a.addedNodes.forEach(u),a.removedNodes.forEach(f))})});return t.querySelectorAll("a").forEach(u),d.observe(t,n),function(){l.forEach(a=>{a.removeEventListener("click",i)}),l.clear(),d.disconnect()}}}}const g=b({domain:"lantian.pub",trackLocalhost:!0,apiHost:""});g.trackPageview();</script> </footer>  </div>  </body> </html>