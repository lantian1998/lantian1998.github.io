<!DOCTYPE html><html lang="en-US" itemscope="" itemtype="https://schema.org/Article" data-astro-cid-porej7z2=""> <head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Legal LTE Network at Home for $100 - Lan Tian @ Blog</title><script>
  ;(() => {
    try {
      const mode = localStorage.getItem('user-color-scheme')
      if (mode == 'dark' || mode == 'light') {
        document.documentElement.setAttribute('data-user-color-scheme', mode)
      }
    } catch {
      // Ignore errors
    }
  })()
</script><link rel="stylesheet" href="/assets/index.CUlf1-Vz.css"><style>#post-navi[data-astro-cid-gfbmwgei]{padding:5px;border-top:1px solid var(--lt-border-weak);border-bottom:1px solid var(--lt-border-weak)}
ol[data-astro-cid-nj3qel45]{margin:0;padding:0;line-height:1.5}ol[data-astro-cid-nj3qel45] .toc-item[data-astro-cid-nj3qel45]{list-style:none}ol[data-astro-cid-nj3qel45] .toc-child[data-astro-cid-nj3qel45],ol[data-astro-cid-nj3qel45] .toc[data-astro-cid-nj3qel45]{padding:0}ol[data-astro-cid-nj3qel45] .toc-link[data-astro-cid-nj3qel45]{display:block;margin-left:1em;padding:.25em 0}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:1em;padding:.25em 0;float:left;font-style:normal;font-variant:normal;font-weight:900;font-family:Font Awesome\ 6 Free;font-feature-settings:normal;text-align:center}ol[data-astro-cid-nj3qel45] .toc-level-1[data-astro-cid-nj3qel45]:before{content:""}ol[data-astro-cid-nj3qel45] .toc-level-2[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-3[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-4[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-5[data-astro-cid-nj3qel45]:before,ol[data-astro-cid-nj3qel45] .toc-level-6[data-astro-cid-nj3qel45]:before{content:""}.post-info-wrap[data-astro-cid-dckccua4]{-ms-flex:0 0 2.5em;flex:0 0 2.5em;background-color:var(--lt-component-bg-emphasis)}@media(min-width:768px){.post-info[data-astro-cid-dckccua4]{position:sticky;top:0}}@media(max-width:767.98px){.post-info[data-astro-cid-dckccua4]{position:absolute}}
</style><script type="module" src="/assets/PageLayout.astro_astro_type_script_index_0_lang.C1wfUPs6.js"></script><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Referrer-Policy" content="no-referrer, strict-origin-when-cross-origin"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="imagemode" content="force"><meta name="nightmode" content="disable"><meta name="wap-font-scale" content="no"><meta name="title" content="Legal LTE Network at Home for $100 - Lan Tian @ Blog"><meta name="keywords" content=""><meta name="author" content="Lan Tian"><link rel="canonical" href="https://lantian.pub/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/"><link rel="alternate" type="application/rss+xml" title="Lan Tian @ Blog" href="https://lantian.pub/rss2.xml"><link rel="alternate" type="application/atom+xml" title="Lan Tian @ Blog" href="https://lantian.pub/feed.xml"><link rel="alternate" href="https://lantian.pub/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/" hreflang="zh"><link rel="alternate" href="https://lantian.pub/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/" hreflang="en"><meta name="copyright" content="Copyright 2012-2025 Lan Tian @ Blog"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="manifest" href="/manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#03a9f4"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#212121"><meta name="application-name" content="Lan Tian @ Blog"><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-precomposed.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#03a9f4"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="Lan Tian @ Blog"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1170x2532.png"><link rel="apple-touch-startup-image" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2532x1170.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1179x2556.png"><link rel="apple-touch-startup-image" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2556x1179.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1284x2778.png"><link rel="apple-touch-startup-image" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2778x1284.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1290x2796.png"><link rel="apple-touch-startup-image" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2796x1290.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1488x2266.png"><link rel="apple-touch-startup-image" media="(device-width: 744px) and (device-height: 1133px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2266x1488.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1640x2160.png"><link rel="apple-touch-startup-image" media="(device-width: 820px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1640.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"><meta name="msapplication-TileColor" content="#bbdefb"><meta name="msapplication-TileImage" content="/mstile-144x144.png"><meta name="msapplication-config" content="/browserconfig.xml"><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"><meta property="og:url" content="https://lantian.pub/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/"><meta property="og:type" content="website"><meta property="og:title" content="Legal LTE Network at Home for $100 - Lan Tian @ Blog"><meta property="og:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="Yes, you read that right. Without the need for Faraday cages or signal-blocking measures, you can build a legal LTE network at home (in the US) for around $100, capable of transmitting continuously 24/7. Regarding &#34;legal&#34;: I am not a lawyer or a wireless expert. Based on my research into the relevant policies and regulations, my entire setup should be legal. However, I take no responsibility if you encounter any legal issues after following the instructions in this post. CBRS Band: Unlicensed LTE/5G Band in the US The challenge in building your own LTE network lies not in the technology but in legally acquiring radio spectrum resources. On the software side, as early as 2014, solutions like srsRAN based on SDR (Software Defined Radio) for LTE transmission were available,..."><meta property="og:site_name" content="Lan Tian @ Blog"><meta property="og:locale" content="en"><meta name="twitter:card" content="summary"><meta name="twitter:url" content="https://lantian.pub/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/"><meta name="twitter:title" content="Legal LTE Network at Home for $100 - Lan Tian @ Blog"><meta property="twitter:image" content="https://lantian.pub/apple-touch-icon.png"><meta content="Yes, you read that right. Without the need for Faraday cages or signal-blocking measures, you can build a legal LTE network at home (in the US) for around $100, capable of transmitting continuously 24/7. Regarding &#34;legal&#34;: I am not a lawyer or a wireless expert. Based on my research into the relevant policies and regulations, my entire setup should be legal. However, I take no responsibility if you encounter any legal issues after following the instructions in this post. CBRS Band: Unlicensed LTE/5G Band in the US The challenge in building your own LTE network lies not in the technology but in legally acquiring radio spectrum resources. On the software side, as early as 2014, solutions like srsRAN based on SDR (Software Defined Radio) for LTE transmission were available,..."><meta name="twitter:dnt" content="on"><meta itemprop="name" content="Legal LTE Network at Home for $100 - Lan Tian @ Blog"><meta property="image" content="https://lantian.pub/apple-touch-icon.png"><meta content="Yes, you read that right. Without the need for Faraday cages or signal-blocking measures, you can build a legal LTE network at home (in the US) for around $100, capable of transmitting continuously 24/7. Regarding &#34;legal&#34;: I am not a lawyer or a wireless expert. Based on my research into the relevant policies and regulations, my entire setup should be legal. However, I take no responsibility if you encounter any legal issues after following the instructions in this post. CBRS Band: Unlicensed LTE/5G Band in the US The challenge in building your own LTE network lies not in the technology but in legally acquiring radio spectrum resources. On the software side, as early as 2014, solutions like srsRAN based on SDR (Software Defined Radio) for LTE transmission were available,..."><meta content="Yes, you read that right. Without the need for Faraday cages or signal-blocking measures, you can build a legal LTE network at home (in the US) for around $100, capable of transmitting continuously 24/7. Regarding &#34;legal&#34;: I am not a lawyer or a wireless expert. Based on my research into the relevant policies and regulations, my entire setup should be legal. However, I take no responsibility if you encounter any legal issues after following the instructions in this post. CBRS Band: Unlicensed LTE/5G Band in the US The challenge in building your own LTE network lies not in the technology but in legally acquiring radio spectrum resources. On the software side, as early as 2014, solutions like srsRAN based on SDR (Software Defined Radio) for LTE transmission were available,..."><link rel="me" href="https://mastodon.social/@lantian"></head> <body data-astro-cid-porej7z2=""> <div id="bg" data-astro-cid-j6vmxtef=""></div>   <div id="container" class="container" data-astro-cid-porej7z2=""> <nav class="lantian navbar navbar-expand-lg" data-astro-cid-wu5dj4rx=""> <div class="container-fluid" data-astro-cid-wu5dj4rx=""> <a class="navbar-brand" href="/en/" data-astro-cid-wu5dj4rx="">Lan Tian @ Blog</a> <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#lantian-navbar" aria-controls="lantian-navbar" aria-expanded="false" aria-label="Toggle navigation" data-astro-cid-wu5dj4rx=""> <span class="navbar-toggler-icon" data-astro-cid-wu5dj4rx=""></span> </button> <div class="collapse navbar-collapse" id="lantian-navbar" data-astro-cid-wu5dj4rx=""> <ul class="navbar-nav" data-astro-cid-wu5dj4rx=""> <li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li class="nav-item d-none d-lg-block" data-astro-cid-wu5dj4rx=""> <a class="nav-link" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> <li class="nav-item dropdown d-block d-lg-none" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="pages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-file" data-astro-cid-wu5dj4rx=""></i> Page  <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="pages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/archive/index.html" data-astro-cid-wu5dj4rx=""> Posts </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/himawari/index.html" data-astro-cid-wu5dj4rx=""> Himawari </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/en/page/dn42/index.html" data-astro-cid-wu5dj4rx=""> DN42 </a> </li> </ul> </li> </ul> <ul class="navbar-nav ms-auto" data-astro-cid-wu5dj4rx=""> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="languages-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-language" data-astro-cid-wu5dj4rx=""></i> Language <span class="caret" data-astro-cid-wu5dj4rx=""></span> </a> <ul class="dropdown-menu" aria-labelledby="languages-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item" href="/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-cn" data-astro-cid-wu5dj4rx=""></span> Chinese Simplified / 简体中文 </a> </li><li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item active" href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/" data-astro-cid-wu5dj4rx=""> <span class="flag-icon flag-icon-us" data-astro-cid-wu5dj4rx=""></span> English </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">Not all pages have translations.</a> </li> <li data-astro-cid-wu5dj4rx=""> <a class="dropdown-item disabled" href="#" data-astro-cid-wu5dj4rx="">You may see 404 - this is normal.</a> </li> </ul> </li> <li class="nav-item dropdown" data-astro-cid-wu5dj4rx=""> <a href="#" class="nav-link dropdown-toggle" id="color-scheme-dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" data-astro-cid-wu5dj4rx=""> <i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Night Mode </a> <ul class="dropdown-menu" aria-labelledby="color-scheme-dropdown" data-astro-cid-wu5dj4rx=""> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-auto" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-adjust" data-astro-cid-wu5dj4rx=""></i> Auto </a> </li> <li data-astro-cid-wu5dj4rx=""><hr class="dropdown-divider" data-astro-cid-wu5dj4rx=""></li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-light" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-sun" data-astro-cid-wu5dj4rx=""></i> Light</a> </li> <li data-astro-cid-wu5dj4rx=""> <a id="color-scheme-dark" class="dropdown-item" href="#" data-astro-cid-wu5dj4rx=""><i class="fas fa-fw fa-moon" data-astro-cid-wu5dj4rx=""></i> Dark</a> </li> </ul> </li> </ul> </div> </div> </nav> <script type="module">const m="user-color-scheme",s="data-user-color-scheme",u=(e,t)=>{try{localStorage.setItem(e,t)}catch{}},i=e=>{try{return localStorage.getItem(e)}catch{return null}},c=e=>{const t={dark:!0,light:!0,auto:!0},o=e===null||!Object.keys(t).includes(e)?"auto":e;u(m,o);for(const l in t){const n=document.getElementById("color-scheme-"+l);n&&(l==o?n.classList.add("active"):n.classList.remove("active"))}o!="auto"?document.documentElement.setAttribute(s,o):document.documentElement.removeAttribute(s)};c(i(m));const r=document.getElementById("color-scheme-auto");r&&r.addEventListener("click",()=>c("auto"));const a=document.getElementById("color-scheme-light");a&&a.addEventListener("click",()=>c("light"));const d=document.getElementById("color-scheme-dark");d&&d.addEventListener("click",()=>c("dark"));</script>  <div class="d-flex" data-astro-cid-porej7z2=""> <div id="content" data-astro-cid-porej7z2="">  <article> <div class="d-flex"> <div class="post-info-wrap" data-astro-cid-dckccua4=""> <div class="post-info" data-astro-cid-dckccua4=""> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-clock"></span> <br> <small>04-06</small> </p> <div class="post-meta-value"> Published on<span class="badge badge-tag" data-astro-cid-dckccua4=""> 2025-04-06 02:56 </span>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-file-alt"></span> <br> <small>Computers and Clients</small> </p> <div class="post-meta-value"> Category <a class="badge badge-tag" href="/en/category/modify-computer" data-astro-cid-dckccua4=""> Computers and Clients </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-tag"></span> <br> <small>4 tags</small> </p> <div class="post-meta-value"> Tags  <a class="badge badge-tag" href="/en/tag/LTE" data-astro-cid-dckccua4=""> LTE </a>  <a class="badge badge-tag" href="/en/tag/4G" data-astro-cid-dckccua4=""> 4G </a>  <a class="badge badge-tag" href="/en/tag/CBRS" data-astro-cid-dckccua4=""> CBRS </a>  <a class="badge badge-tag" href="/en/tag/Magma" data-astro-cid-dckccua4=""> Magma </a>  </div> </div> </div> <div class="post-meta-wrap"> <div class="post-meta"> <p> <span class="fas fa-list"></span> <br> <small>ToC</small> </p> <div class="post-meta-value">  <ol data-astro-cid-nj3qel45=""> <li class="toc-item toc-level-1" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#cbrs-band-unlicensed-lte5g-band-in-the-us" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">CBRS Band: Unlicensed LTE/5G Band in the US</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#buying-a-used-base-station-on-ebay" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Buying a Used Base Station on eBay</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#unlocking-the-management-interface-of-the-indoor-base-station" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Unlocking the Management Interface of the Indoor Base Station</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#purchasing-programmable-sim-cards" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Purchasing Programmable SIM Cards</span> </a> </li><li class="toc-item toc-level-1" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#building-a-magma-core-network" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Building a Magma Core Network</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#building-the-magma-core-network-orchestrator-and-nms" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Building the Magma Core Network (Orchestrator and NMS)</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#building-the-magma-access-gateway-agw" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Building the Magma Access Gateway (AGW)</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#connecting-the-base-station-to-the-magma-access-gateway" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Connecting the Base Station to the Magma Access Gateway</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#connecting-the-base-station-to-sas" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Connecting the Base Station to SAS</span> </a> </li><li class="toc-item toc-level-1" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#programming-sim-cards" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Programming SIM Cards</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#creating-a-data-plan" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Creating a Data Plan</span> </a> </li><li class="toc-item toc-level-2" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#registering-sim-cards" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Registering SIM Cards</span> </a> </li><li class="toc-item toc-level-1" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#connecting-a-phone-to-the-network" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Connecting a Phone to the Network</span> </a> </li><li class="toc-item toc-level-1" data-astro-cid-nj3qel45=""> <a class="toc-link" href="#conclusion" data-astro-cid-nj3qel45=""> <span class="toc-text" data-astro-cid-nj3qel45="">Conclusion</span> </a> </li> </ol>   </div> </div> </div> </div>  </div>  <div class="post-wrap">  <h1 class="post-title"> <a href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/" rel="bookmark" title="Legal LTE Network at Home for $100">Legal LTE Network at Home for $100</a> </h1> <div class="post-text">  <blockquote><p>List of Lan Tian Mobile (LTE at Home) series posts:</p><ul><li><a href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/">Legal LTE Network at Home for $100</a> (current post)</li><li><a href="/en/article/modify-computer/legal-lte-network-at-home-with-open5gs.lantian/">Legal LTE Network at Home with Open5GS</a> </li></ul></blockquote> <p>Yes, you read that right. Without the need for Faraday cages or signal-blocking measures, you can build a legal LTE network at home (in the US) for around $100, capable of transmitting continuously 24/7.</p>
<blockquote>
<p>Regarding "legal": I am not a lawyer or a wireless expert. Based on my research into the relevant policies and regulations, my entire setup should be legal. However, I take no responsibility if you encounter any legal issues after following the instructions in this post.</p>
</blockquote>
<h1 id="cbrs-band-unlicensed-lte5g-band-in-the-us">CBRS Band: Unlicensed LTE/5G Band in the US</h1>
<p>The challenge in building your own LTE network lies not in the technology but in legally acquiring radio spectrum resources. On the software side, as early as 2014, solutions like <a href="https://www.srslte.com/" rel="noopener noreferrer" target="_blank">srsRAN</a> based on SDR (Software Defined Radio) for LTE transmission were available, along with open-source core network software like <a href="https://magmacore.org/" rel="noopener noreferrer" target="_blank">Magma</a> and <a href="https://open5gs.org/" rel="noopener noreferrer" target="_blank">Open5GS</a>.</p>
<p>However, when it comes to radio spectrum, the frequencies used by LTE and 5G mobile networks fall within licensed bands. To use them legally, you must apply to the local radio regulatory authority and pay expensive spectrum usage fees (usually based on coverage area and local population). Unless you live in a sparsely populated area, most enthusiasts will be stopped at this step. If you transmit without authorization, you will interfere with operators using the same frequency, and the affected operators have a strong incentive to collaborate with enforcement agencies to locate the source of interference and heavily fine you.</p>
<p>In 2017, however, the Federal Communications Commission (FCC) opened the 3550-3700 MHz band to the public, known as the CBRS (Citizens Broadband Radio Service) band. Anyone who meets simple restrictions can transmit on this band without prior authorization. Since this band corresponds to LTE band 48 and 5G band n48, you can transmit LTE or 5G signals on this band, allowing phones that support band 48 to connect, thereby legally establishing your own LTE/5G network.</p>
<p>If many devices transmit on the same band without coordination, severe signal interference will occur, rendering the band unusable for everyone. To address this, CBRS introduced the SAS system (Spectrum Access System) to manage all radio devices transmitting on the CBRS band. SAS categorizes CBRS users into three levels:</p>
<ul>
<li>Incumbent Access: Users who were authorized to use this band before 2017 have the highest priority. These are typically satellite control stations and US Navy radars. If these users transmit on the CBRS band, all other users must yield.</li>
<li>Priority Access: Users who have obtained priority usage rights for portions of the CBRS band through auctions have a lower priority than incumbent users but higher than all other users.</li>
<li>General Authorized Access: All other users without prior authorization have the lowest priority and must yield to all other users.</li>
</ul>
<p>All CBRS band users, except the US Navy, must obtain authorization from SAS before starting transmission, allowing SAS to dynamically adjust frequency allocations in different areas to prevent mutual interference. For interference from US Navy radars, SAS uses signal receivers installed along the US coast to determine if the US Navy is using the band.</p>
<p>Therefore, with a LTE/5G base station that supports the CBRS band and can connect to SAS to obtain frequency allocations, you can legally transmit signals and build your own mobile network.</p>
<p>But where can you buy such a device?</p>
<h2 id="buying-a-used-base-station-on-ebay">Buying a Used Base Station on eBay</h2>
<p>After the CBRS band was opened, it attracted the interest of many companies. <a href="https://ongoalliance.org/members/" rel="noopener noreferrer" target="_blank">As of today, 95 companies have joined the CBRS Alliance</a>, including the big three US operators AT&#x26;T, T-Mobile, and Verizon, SAS system operators Google and Federated Wireless, and base station equipment manufacturers Baicells and Sercomm, among others.</p>
<p>Another company called Nova Labs was also interested in CBRS. Nova Labs operates a virtual network operator (MVNO) called Helium Mobile, providing services through T-Mobile's mobile network. To achieve lower costs and lower plan prices than other virtual operators, they:</p>
<ul>
<li>Sold Wi-Fi hotspots and CBRS base stations dedicated to the Helium Mobile network, allowing users to share their existing broadband connection.</li>
<li>Prioritized Helium Mobile users to use these Wi-Fi hotspots and CBRS base stations, bypassing T-Mobile to reduce data traffic costs.</li>
<li>Issued a digital currency called HNT, and used HNT to pay for traffic cost on Wi-Fi hotspots and CBRS base stations.</li>
</ul>
<p>However, Nova Labs could never solve the stability issues of roaming to CBRS base stations and eventually abandoned the CBRS network entirely in March 2025, fully transitioning to using Wi-Fi hotspots. The CBRS base stations, originally costing thousands of dollars, were replaced and now listed on eBay for around $60 each. After flashing back to the original firmware and unlocking the management interface, these base stations can connect to core networks built with Magma, Open5GS, etc., and transmit for your own LTE network.</p>
<p><a href="https://www.ebay.com/sch/i.html?_nkw=cbrs&#x26;_sacat=0&#x26;_sop=15" rel="noopener noreferrer" target="_blank">Search for "CBRS" on eBay</a> to find many CBRS base stations from the Helium Mobile network.</p>
<p>Note that Helium Mobile sells two types of CBRS base stations:</p>
<ul>
<li>Indoor base stations produced by Sercomm, branded by FreedomFi or MosoLabs, model <code>SCE4255W</code>, characterized by the FreedomFi or MosoLabs logo on the casing.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/cbrs-indoor-radio.jpg.webp" type="image/webp"><source srcset="/usr/uploads/202504/cbrs-indoor-radio.jpg.avif" type="image/avif"><source srcset="/usr/uploads/202504/cbrs-indoor-radio.jpg.jxl" type="image/jxl"><img src="/usr/uploads/202504/cbrs-indoor-radio.jpg" alt="FreedomFi/Sercomm Indoor Base Station Appearance"></picture></p>
<p>(Image source: Amazon)</p>
<ul>
<li>Outdoor base stations produced by Baicells, model <code>Nova 430h</code>, characterized by the orange Baicells logo on the casing.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/cbrs-outdoor-radio.jpg.webp" type="image/webp"><source srcset="/usr/uploads/202504/cbrs-outdoor-radio.jpg.avif" type="image/avif"><source srcset="/usr/uploads/202504/cbrs-outdoor-radio.jpg.jxl" type="image/jxl"><img src="/usr/uploads/202504/cbrs-outdoor-radio.jpg" alt="Baicells Outdoor Base Station Appearance"></picture></p>
<p>(Image source: Amazon)</p>
<p>If you are deploying at home, <strong>you must buy an indoor base station</strong>, not an outdoor one. The differences between the two are:</p>
<ul>
<li>Indoor base stations can only be used indoors. They can easily connect to SAS without additional steps.</li>
<li>Outdoor base stations can only be used outdoors. They have higher SAS authorization fees, and require a CBRS Alliance-authorized installer to check the installation before transmission can begin. If you want to install an outdoor base station but can't find an authorized installer, <a href="https://www.coursera.org/learn/google-cbrs-cpi-training" rel="noopener noreferrer" target="_blank">you can also spend $600 to get certified as an authorized installer</a>, valid for 3 years, and then you can approve your own base stations and install as many base stations as you want.</li>
</ul>
<p>I didn't want to spend $600 on a certification that has little other use, so I bought an indoor base station directly.</p>
<h2 id="unlocking-the-management-interface-of-the-indoor-base-station">Unlocking the Management Interface of the Indoor Base Station</h2>
<p>When you buy a FreedomFi/Sercomm SCE4255W indoor base station from eBay, plug it in and turn it on, you'll find you can't connect to the base station's web management interface to change its configuration. This was done to prevent base station owners from messing with the settings, which could affect network stability, but it also prevents us from using the base station elsewhere.</p>
<p>However, these base stations connect to a central server to get configurations via the HTTP-based TR-069 protocol, a term you might be familiar with if you've ever modified your model or router provided by ISP. We can hijack the default control server address to our own control server, allowing us to freely modify the base station's configuration.</p>
<p>If you plan to use Magma to build your core network, you can skip this step. Magma comes with a TR-069 server that can send configurations to the base station, and engineers from Helium Mobile and FreedomFi have already added support for this base station to Magma, so we can later hijack the base station's control server <code>acs.freedomfi.com</code> to Magma via DNS.</p>
<p>If you plan to use Open5GS or other software that doesn't support TR-069 to build your core network, you can use my script to simulate a TR-069 server and send the command to enable the web management interface to the base station:</p>
<ol>
<li>Download the <code>tr069.py</code> script from <a href="https://github.com/xddxdd/freedomfi-cbrs-enable-webui" rel="noopener noreferrer" target="_blank">https://github.com/xddxdd/freedomfi-cbrs-enable-webui</a>.</li>
<li>Install Python 3, then run <code>python3 tr069.py</code>.</li>
<li>Modify your router's DNS settings to hijack the IP of <code>acs.freedomfi.com</code> to the IP of the computer running the <code>tr069.py</code> script. My router uses OpenWRT, so I can add a rule in the Dnsmasq configuration page: <code>/acs.freedomfi.com/192.168.4.2</code>.</li>
<li>Unbox the base station, connect it with an Ethernet cable, and plug in the power.</li>
<li>Wait a moment, and you should see a large amount of XML output in the window running the <code>tr069.py</code> script, which are the commands sent by the base station to the server. If you aren't receiving any requests, check if the DNS configuration is correct and if there's a firewall on your computer blocking port 8443.</li>
<li>When you see output containing <code>cwmp:SetParameterValuesResponse</code>, it means the web management interface has been successfully enabled. The complete output should look like this:</li>
</ol>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">soap-env:Envelope</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:soap-env</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"http://schemas.xmlsoap.org/soap/envelope/"</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:soap-enc</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"http://schemas.xmlsoap.org/soap/encoding/"</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:xsd</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"http://www.w3.org/2001/XMLSchema"</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:xsi</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"http://www.w3.org/2001/XMLSchema-instance"</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xmlns:cwmp</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"urn:dslforum-org:cwmp-1-0"</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">soap-env:Header</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cwmp:ID</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> soap-env:mustUnderstand</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"1"</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">null</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cwmp:ID</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">soap-env:Header</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">soap-env:Body</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cwmp:SetParameterValuesResponse</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">      &#x3C;</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">Status</span><span style="--shiki-dark:#9CDCFE;--shiki-light:#E50000"> xsi:type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">=</span><span style="--shiki-dark:#CE9178;--shiki-light:#0000FF">"xsd:int"</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">0</span><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">Status</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">    &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">cwmp:SetParameterValuesResponse</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">  &#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">soap-env:Body</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span>
<span class="line"><span style="--shiki-dark:#808080;--shiki-light:#800000">&#x3C;/</span><span style="--shiki-dark:#569CD6;--shiki-light:#800000">soap-env:Envelope</span><span style="--shiki-dark:#808080;--shiki-light:#800000">></span></span></code></pre>
<p>After enabling the management interface, you can access the base station's management interface via HTTPS, like <code>https://192.168.1.123/</code>.</p>
<p><picture><source srcset="/usr/uploads/202504/sercomm-login.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/sercomm-login.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/sercomm-login.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/sercomm-login.png" alt="Indoor Base Station Login Interface"></picture></p>
<p>The default username and password are <code>sc_femto</code> and <code>tsFid2wz</code> (from Helium Mobile's Discord: <a href="https://discord.com/channels/404106811252408320/836735476659912754/1355330850232995861" rel="noopener noreferrer" target="_blank">link</a>).</p>
<p><picture><source srcset="/usr/uploads/202504/sercomm-status.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/sercomm-status.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/sercomm-status.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/sercomm-status.png" alt="Indoor Base Station Management Interface"></picture></p>
<h2 id="purchasing-programmable-sim-cards">Purchasing Programmable SIM Cards</h2>
<p>After building your LTE network, you'll need some SIM cards with your network's configuration programmed on them to allow phones to connect to your network. Since the information on regular SIM cards is hardcoded during production, you can't just buy any SIM card; you must use programmable SIM cards.</p>
<p>Search for <code>Programmable SIM</code> on shopping websites like Amazon and Aliexpress to find these cards, for example: <a href="https://www.amazon.com/s?k=Programmable+SIM" rel="noopener noreferrer" target="_blank">https://www.amazon.com/s?k=Programmable+SIM</a>.</p>
<p><picture><source srcset="/usr/uploads/202504/programmable-sim-card.jpg.webp" type="image/webp"><source srcset="/usr/uploads/202504/programmable-sim-card.jpg.avif" type="image/avif"><source srcset="/usr/uploads/202504/programmable-sim-card.jpg.jxl" type="image/jxl"><img src="/usr/uploads/202504/programmable-sim-card.jpg" alt="Programmable SIM Card Appearance"></picture></p>
<p>(Image source: Amazon)</p>
<p>I bought a set of SIM cards on Amazon for $38.99, which included 5 programmable SIM cards, a card programmer, a USB drive with Windows card-programming software, and an adapter from Micro SIM/Nano SIM to full-size SIM.</p>
<h1 id="building-a-magma-core-network">Building a Magma Core Network</h1>
<p>To build your own LTE network, you first need a core network. The LTE core network mainly manages user device (e.g., phone) authentication information and controls billing, traffic throttling, and other functions.</p>
<p>Magma is an open-source 4G/5G core network developed by Meta (Facebook), running on Docker/Kubernetes. It can quickly scale horizontally to support large amounts of mobile network traffic and can run on low-spec devices like Raspberry Pi to provide simple network services.</p>
<p>Since I don't need the complex container orchestration features of Kubernetes, I chose to build Magma's components using Docker.</p>
<blockquote>
<p>I referenced the following materials during the configuration process:</p>
<ul>
<li>Core network (Orchestrator and NMS) part: <a href="https://hackmd.io/@RaffieWinata/rJ5oHgk3a#1-Install-Orchestrator-and-NMS" rel="noopener noreferrer" target="_blank">[Study Note] How To Install Magma Core (Orchestrator)</a></li>
<li>Core network (Orchestrator and NMS) part: <a href="https://learn.rakwireless.com/hc/en-us/articles/26476385758615-How-To-Configure-Magma-Orchestrator-NMS" rel="noopener noreferrer" target="_blank">How To Configure Magma Orchestrator &#x26; NMS - RakWireless</a></li>
<li>Access Gateway part: <a href="https://magma.github.io/magma/docs/lte/deploy_install_docker" rel="noopener noreferrer" target="_blank">Install Docker-based Access Gateway on Ubuntu - Magma</a></li>
</ul>
</blockquote>
<h2 id="building-the-magma-core-network-orchestrator-and-nms">Building the Magma Core Network (Orchestrator and NMS)</h2>
<p>First, prepare a system to run the core network. I chose to create a virtual machine on Proxmox VE. After installation, the system services and Magma together use about 4GB of memory, so a virtual machine with about 8GB of memory should be sufficient.</p>
<p>I installed Ubuntu 24.04, but other systems should theoretically work as well.</p>
<p>Then, install Docker and Docker-compose.</p>
<p>Then, execute the following operations:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># All commands below assume you are staring from the HOME directory</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Download Magma v1.8.0 source code; you can replace the version number if there's an update</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> clone</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/magma/magma.git</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> magma</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">git</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> checkout</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> v1.8.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Generate SSL certificates for the core network</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">mkdir</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -p</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~/secrets/certs</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~/secrets/certs</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Here, magma.test can be replaced with your own domain or subdomain,</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># but since we're generating self-signed certificates, the domain cannot have HSTS enabled</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">bash</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~/magma/orc8r/cloud/deploy/scripts/self_sign_certs.sh</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> magma.test</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">bash</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~/magma/orc8r/cloud/deploy/scripts/create_application_certs.sh</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> magma.test</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Copy the SSL certificates to the configuration needed by the Magma Docker containers</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">mkdir</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -p</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~/magma/.cache/test_certs/</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cp</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -r</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> *</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~/magma/.cache/test_certs/</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">chmod</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -R</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> +r</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~/magma/.cache/test_certs/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Build the Docker containers for the Orchestrator component</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~/magma/orc8r/cloud/docker</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">python3</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> build.py</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> --all</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Wait for the Docker image build to complete, which takes about 30 minutes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify the configuration in docker-compose.yml</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">nano</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> docker-compose.yml</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Items to modify:</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - If you used a different domain when generating SSL certificates, search for magma.test and replace it with your own domain</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - Add `restart: always` to the `kibana` and `fluentd` containers for auto-start on boot</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Start the Orchestrator</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">python3</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> run.py</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Confirm all containers have started successfully</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">docker</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ps</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -a</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># All containers except orc8r-test should be in the Up state</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># If any container fails to start, use `docker logs [container name]` to view logs and resolve issues accordingly</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify the DNS server configuration to point magma.test (or your own domain) and all subdomains to this machine's IP</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># For example, my Dnsmasq rule is: /magma.test/192.168.0.7</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Prepare to build the Web management interface (NMS)</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cd</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ~/magma/nms</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify the configuration in docker-compose.yml</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">nano</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> docker-compose.yml</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Items to modify:</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># - Add `restart: always` to all containers for auto-start on boot</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify a configuration in docker/docker_ssl_proxy/proxy_ssl.conf that is no longer supported by the new version of nginx</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">nano</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> docker/docker_ssl_proxy/proxy_ssl.conf</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Delete the lines `listen 443;` and `ssl on;`, replace with `listen 443 ssl;`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Start the Docker containers for the Web management interface</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">docker-compose</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> up</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -d</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Wait for the Docker image build to complete, which takes about 20 minutes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Confirm all containers have started successfully</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">docker</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ps</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -a</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># All containers starting with nms should be in Up state</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># If any container fails to start, use `docker logs [container name]` to view logs and resolve issues accordingly</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Create the default administrator</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">bash</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> scripts/dev_setup.sh</span></span></code></pre>
<p>Then, in your local browser, visit <a href="https://magma-test.magma.test" rel="noopener noreferrer" target="_blank">https://magma-test.magma.test</a> (or <code>magma-test.[your own domain]</code>), and you should see the login interface. If you see an address not found error, confirm that the domain is resolving correctly.</p>
<p><picture><source srcset="/usr/uploads/202504/magma-login.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-login.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-login.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-login.png" alt="Magma Login Interface"></picture></p>
<p>Log in with the default username <code>admin@magma.test</code> and password <code>password1234</code>.</p>
<p>In the left <code>Network</code> tab, add a network and fill in the following:</p>
<ul>
<li>In the <code>Config</code> tab, <code>Network ID</code> and <code>Network Name</code> can be filled in arbitrarily.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/magma-add-network.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-network.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-network.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-network.png" alt="Magma Add Network Interface"></picture></p>
<ul>
<li>In the <code>Epc</code> tab, change MCC to <code>315</code>, MNC to <code>010</code>, and TAC to <code>1</code>. MCC/MNC are the codes for mobile operators, for example, AT&#x26;T's MCC/MNC is <code>310/410</code>, and T-Mobile's is <code>310/260</code>. <code>315/010</code> is the code specifically allocated for CBRS networks, and all mobile networks on the CBRS band can use it.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/magma-add-network-epc.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-network-epc.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-network-epc.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-network-epc.png" alt="Magma Add Network Interface Epc Tab"></picture></p>
<ul>
<li>In the <code>Ran</code> tab, change <code>Bandwidth</code> to 20 MHz for the fastest speed. Select <code>Band Type</code> as <code>TDD</code> because the LTE 48/5G n48 band uses TDD time-division multiplexing.</li>
<li>Fill in EARFCNDL with <code>55540</code>, which represents the 3580 MHz frequency point within the CBRS band, but the CBRS base station will actually use the frequency allocated by SAS, not the one specified here.</li>
<li>Keep all other configurations at their defaults.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/magma-add-network-ran.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-network-ran.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-network-ran.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-network-ran.png" alt="Magma Add Network Interface Ran Tab"></picture></p>
<p>After completing the above configuration, you now have an LTE core network. However, your base station cannot directly connect to the core network; it needs another component: the Access Gateway (AGW).</p>
<h2 id="building-the-magma-access-gateway-agw">Building the Magma Access Gateway (AGW)</h2>
<p>Magma's Access Gateway manages the base station and forwards the base station's data traffic to the internet. Note that Magma's core network only manages user information and does not handle data traffic, and the traffic from the Access Gateway does not pass through the core network.</p>
<p>First, prepare a system to run the Access Gateway. This system needs to be configured with two network interfaces, where <code>eth0</code> is used for remote management and connecting to the core network, and <code>eth1</code> is used for connecting to the base station. If you're using a separate computer, you'll need to plug the base station's Ethernet cable into the <code>eth1</code> interface later, and Magma will automatically configure DHCP to allow the base station to connect to the Access Gateway. However, since I'm using a virtual machine on Proxmox VE, I chose to place the additional <code>eth1</code> interface in a VLAN and set up the corresponding VLAN and IP on the main router. This way, I can ping the <code>eth1</code> IP from any machine on my local network, meaning the base station can be plugged into any port on my main switch.</p>
<p>This system must be installed with Ubuntu 20.04 because the Magma Access Gateway installation modifies many system configurations, and these modifications are only supported on Ubuntu 20.04.</p>
<p>After installation, the system services and Magma together use about 1GB of memory, so a virtual machine with about 2-4GB of memory should be sufficient.</p>
<p>Then, install Docker and Docker-compose.</p>
<p>Then, execute the following operations:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Copy the rootCA.pem from the core network to the Access Gateway</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># On the access gateway machine, run:</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">mkdir</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -p</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /var/opt/magma/certs</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># On your local computer, run:</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">scp</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> root@[core</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> network</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> machine]:~/magma/.cache/test_certs/rootCA.pem</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> .</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">scp</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> rootCA.pem</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> root@[Access</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> Gateway</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> machine]:/var/opt/magma/certs/rootCA.pem</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Create the configuration file for connecting to the core network, on the access gateway machine:</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># If your core network domain is not magma.test, replace accordingly</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cat</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> &#x3C;&#x3C; </span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">EOF</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">sudo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> tee</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /var/opt/magma/configs/control_proxy.yml</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">cloud_address: controller.magma.test</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">cloud_port: 7443</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">bootstrap_address: bootstrapper-controller.magma.test</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">bootstrap_port: 7444</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">fluentd_address: fluentd.magma.test</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">fluentd_port: 24224</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">rootca_cert: /var/opt/magma/certs/rootCA.pem</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Run the one-click installation script, on the access gateway machine:</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">wget</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> https://github.com/magma/magma/raw/v1.8/lte/gateway/deploy/agw_install_docker.sh</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">bash</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> agw_install_docker.sh</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># The first installation attempt will likely fail, due to the expiration of Magma's official GPG certificate. Below is how to resolve this issue.</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Solution from https://github.com/magma/magma/issues/15572</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Disable apt-get GPG verification</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">echo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "Acquire::AllowInsecureRepositories true;"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> > </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">/etc/apt/apt.conf.d/99AllowInsecureRepositories</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">echo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> "APT::Get::AllowUnauthenticated true;"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> >> </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">/etc/apt/apt.conf.d/99AllowInsecureRepositories</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">apt</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> update</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Remove the problematic steps</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">nano</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /opt/magma/lte/gateway/deploy/roles/magma_deploy/tasks/main.yml</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Delete the steps `Add unvalidated Apt signing key.` and `Add validated Apt signing key.`</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify the installation script to skip already executed parts</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">nano</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> agw_install_docker.sh</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Change `RERUN=0` to `RERUN=1` to skip already executed parts</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Rerun the installation script</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">bash</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> agw_install_docker.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># If successful, the installation should complete. Reboot the machine</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">reboot</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify the IP address configuration for the eth1 interface as needed</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">cat</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> &#x3C;&#x3C; </span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">EOF</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000"> | </span><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">sudo</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> tee</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> /etc/netplan/70-secondary-itf.yaml</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">network:</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  ethernets:</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">    eth1:</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      addresses:</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      - 192.168.4.2/24</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      routes:</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      - to: 0.0.0.0/0</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">        via: 192.168.4.1</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">        metric: 1000</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">      nameservers:</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">        addresses:</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">        - 192.168.4.1</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">        search: []</span></span>
<span class="line"><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">  version: 2</span></span>
<span class="line"><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">EOF</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">netplan</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> apply</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Confirm all containers have started successfully</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">docker</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> ps</span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF"> -a</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># All containers except liagentd should be in Up state</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># If any container fails to start, use `docker logs [container name]` to view logs and resolve issues accordingly</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Get the Access Gateway's key, which will be needed later to connect to the core network</span></span>
<span class="line"><span style="--shiki-dark:#DCDCAA;--shiki-light:#795E26">docker</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> exec</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> magmad</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515"> show_gateway_info.py</span></span></code></pre>
<p>Return to the core network management interface at <a href="https://magma-test.magma.test" rel="noopener noreferrer" target="_blank">https://magma-test.magma.test</a> (or <code>magma-test.[your own domain]</code>), go to the left <code>Equipment</code> tab, and ensure the network you created earlier is selected in the top right corner.</p>
<p>Click the <code>Add New</code> button in the top right to add the Access Gateway, and fill in the following:</p>
<ul>
<li>In the <code>Config</code> tab, <code>Gateway Name</code> and <code>Gateway ID</code> can be filled in arbitrarily.</li>
<li>In the <code>Config</code> tab, fill in <code>Hardware UUID</code> with the <code>Hardware ID</code> you obtained from the Access Gateway.</li>
<li>In the <code>Config</code> tab, fill in <code>Challenge Key</code> with the <code>Challenge key</code> you obtained from the Access Gateway.</li>
<li>Keep all other configurations at their defaults.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/magma-add-agw.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-agw.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-agw.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-agw.png" alt="Magma Add Access Gateway Interface"></picture></p>
<p>After saving, wait a moment, and the management interface should show the status of this Access Gateway as <code>Health</code> being <code>Good</code>. If the status remains <code>Bad</code>, try rebooting the Access Gateway or check the DNS on the Access Gateway to ensure <code>magma.test</code> (or your domain) points to the core network.</p>
<p><picture><source srcset="/usr/uploads/202504/magma-agw-status.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-agw-status.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-agw-status.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-agw-status.png" alt="Magma Access Gateway Status Interface"></picture></p>
<h2 id="connecting-the-base-station-to-the-magma-access-gateway">Connecting the Base Station to the Magma Access Gateway</h2>
<p>Pick up your CBRS base station and look at the label on the back, which should have a serial number like <code>2112CW5012345</code>.</p>
<p>In the core network management interface, go to the left <code>Equipment</code> tab, then to the <code>eNodeB</code> tab. Click the <code>Add New</code> button in the top right to add the base station, and fill in the following:</p>
<ul>
<li>In the <code>Config</code> tab, <code>Name</code> can be filled in arbitrarily.</li>
<li>In the <code>Config</code> tab, fill in <code>Serial number</code> with the serial number from the base station's label.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/magma-add-enodeb.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-enodeb.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-enodeb.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-enodeb.png" alt="Magma Add Base Station Interface"></picture></p>
<ul>
<li>In the <code>Ran</code> tab, <strong>do not select</strong> <code>eNodeB Managed Externally</code> (disallow Magma from managing the base station).</li>
<li>In the <code>Ran</code> tab, select <code>Device Class</code> as <code>FreedomFi One</code> (for FreedomFi/Sercomm's indoor base station).</li>
<li>In the <code>Ran</code> tab, fill in <code>Cell ID</code> with <code>0</code> (increment by one for each additional base station).</li>
<li>In the <code>Ran</code> tab, select <code>Bandwidth</code> as 20 MHz for the fastest speed.</li>
<li>In the <code>Ran</code> tab, fill in <code>PCI</code> with <code>100</code> (increment by one for each additional base station).</li>
<li>In the <code>Ran</code> tab, fill in <code>TAC</code> with <code>1</code>.</li>
<li>In the <code>Ran</code> tab, select <code>Transmit</code> as <code>Enabled</code> (enable transmission).</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/magma-add-enodeb-ran-1.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-enodeb-ran-1.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-enodeb-ran-1.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-enodeb-ran-1.png" alt="Magma Add Base Station Interface Ran Tab 1"></picture></p>
<p><picture><source srcset="/usr/uploads/202504/magma-add-enodeb-ran-2.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-enodeb-ran-2.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-enodeb-ran-2.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-enodeb-ran-2.png" alt="Magma Add Base Station Interface Ran Tab 2"></picture></p>
<p>Although we've added the base station to Magma, since the base station device defaults to connecting to Helium Mobile's server for configuration, it still can't connect to our Access Gateway properly. Therefore, we need to hijack the base station's control server <code>acs.freedomfi.com</code> to the <code>eth1</code> IP address of Magma access gateway via DNS. Modify your router's DNS settings to hijack the IP of <code>acs.freedomfi.com</code> to the <code>eth1</code> IP of the machine running the Access Gateway. My router uses OpenWRT, so I can add a rule in the Dnsmasq configuration page: <code>/acs.freedomfi.com/192.168.4.2</code>.</p>
<p>Additionally, because the port number of the TR-069 server on the Magma Access Gateway is different from Helium Mobile's, we need to modify the port number and some other configurations on the Access Gateway.</p>
<p>On the Access Gateway, edit <code>nano /etc/magma/enodebd.yml</code> and make the following changes:</p>
<pre class="shiki shiki-themes dark-plus light-plus" style="--shiki-dark:#D4D4D4;--shiki-light:#000000;--shiki-dark-bg:#1E1E1E;--shiki-light-bg:#FFFFFF" tabindex="0"><code><span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Change the port under tr069 to 8443 to match Helium Mobile's control server port number</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">tr069</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  port</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#B5CEA8;--shiki-light:#098658">8443</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Modify the configuration for the base station to connect to the SAS server; this configuration corresponds to connecting to Google SAS</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">sas</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">:</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  # Let the base station connect to the SAS server directly, not through Magma proxy. Magma proxy SAS connection requires installing additional components, which is too complicated</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  dp_mode</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#569CD6;--shiki-light:#0000FF">False</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  # SAS server address, here for Google SAS</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  sas_server_url</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"https://sas.goog/v1.2/"</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  # Your Google Cloud Project ID can be seen on the console homepage: https://console.cloud.google.com</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  sas_uid</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"[replace with your own Google Cloud Project ID]"</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  # A represents indoor, B represents outdoor</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  sas_category</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"A"</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  # GAA represents the lowest priority General Authorized Access</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  sas_channel_type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"GAA"</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  # indoor for indoor, outdoor for outdoor</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  sas_location</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"indoor"</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  # Use this value for FreedomFi/Sercomm indoor base stations; it may be different for other brands</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  sas_cert_subject</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"/C=TW/O=Sercomm/OU=WInnForum CBSD Certificate/CN=P27-SCE4255W:%s"</span></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000">  # Keep the following two items unchanged</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  sas_icg_group_id</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">""</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">  sas_height_type</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"AMSL"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Change the LTE synchronization source to FREE_RUNNING; otherwise, the indoor base station may not transmit signals if the GPS signal is too weak</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">prim_src</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: </span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"FREE_RUNNING"</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Add your base station's serial number here to enable the web management interface</span></span>
<span class="line"><span style="--shiki-dark:#569CD6;--shiki-light:#800000">web_ui_enable_list</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">: [</span><span style="--shiki-dark:#CE9178;--shiki-light:#A31515">"2112CW5012345"</span><span style="--shiki-dark:#D4D4D4;--shiki-light:#000000">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#6A9955;--shiki-light:#008000"># Keep all other configurations unchanged</span></span></code></pre>
<p>After saving the configuration file, reboot the entire Access Gateway system. I found during testing that restarting individual Docker containers on the Access Gateway can cause strange issues, such as the base station not being able to connect to the Access Gateway. A full reboot can resolve most strange issues.</p>
<p>Wait a moment, and the core network management interface should show the status of this base station as <code>Health</code> being <code>Good</code>. If the status remains <code>Bad</code>, try rebooting the Access Gateway.</p>
<p><picture><source srcset="/usr/uploads/202504/magma-enodeb-status.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-enodeb-status.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-enodeb-status.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-enodeb-status.png" alt="Magma Base Station Status Interface"></picture></p>
<p>If you added the indoor base station's serial number to <code>web_ui_enable_list</code> to enable the management interface, you can now access the base station's management interface via HTTPS, like <code>https://192.168.1.123/</code>. The default username and password are <code>sc_femto</code> and <code>tsFid2wz</code> (from Helium Mobile's Discord: <a href="https://discord.com/channels/404106811252408320/836735476659912754/1355330850232995861" rel="noopener noreferrer" target="_blank">link</a>).</p>
<h2 id="connecting-the-base-station-to-sas">Connecting the Base Station to SAS</h2>
<p>At this point, the base station is connected to your core network, but since it hasn't connected to the CBRS SAS system (Spectrum Access System) and obtained frequency authorization, it still won't transmit LTE signals.</p>
<p>We need to register an account with a SAS system and register our base station to obtain frequency authorization.</p>
<p>I used <a href="https://cloud.google.com/products/spectrum-access-system" rel="noopener noreferrer" target="_blank">Google SAS</a>, a SAS system run by Google Cloud. Google SAS is currently the easiest SAS system to register with; other vendors' SAS systems usually require contacting sales and signing enterprise-level service contracts to use. Moreover, Google SAS is extremely affordable; at the time of writing, <a href="https://cloud.google.com/products/spectrum-access-system#pricing" rel="noopener noreferrer" target="_blank">the price for indoor base stations is $2.64 per month per unit, and for outdoor base stations, it's $13.15 per month per unit</a>.</p>
<p>You need to register a Google Cloud account first, then visit the <a href="https://console.cloud.google.com/spectrum-access" rel="noopener noreferrer" target="_blank">SAS configuration page in the console</a> and follow these steps to configure:</p>
<ol>
<li>Determine your latitude and longitude. If you use an Android phone, you can download the <a href="https://play.google.com/store/apps/details?id=com.eclipsim.gpsstatus2" rel="noopener noreferrer" target="_blank">GPS Status &#x26; Toolbox</a> app from Google Play to view your latitude and longitude. If you use an iPhone, you can view your latitude and longitude from the built-in Compass app.</li>
<li>In the console, select the "Add Site" button at the top (the one with a plus sign), and click anywhere on the map. A sidebar will pop up on the right, asking you to enter information about your base station.</li>
</ol>
<p><picture><source srcset="/usr/uploads/202504/google-sas-add-button.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/google-sas-add-button.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/google-sas-add-button.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/google-sas-add-button.png" alt="Google SAS Add Site Button"></picture></p>
<ol start="3">
<li>First, switch to the first tab on the right sidebar (Location) and enter your correct latitude and longitude. It doesn't need to be very precise; the base station itself will upload its GPS location.</li>
</ol>
<p><picture><source srcset="/usr/uploads/202504/google-sas-enter-location.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/google-sas-enter-location.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/google-sas-enter-location.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/google-sas-enter-location.png" alt="Google SAS Enter Latitude and Longitude Interface"></picture></p>
<ol start="4">
<li>Then, switch to the second tab (Base Station Information) and fill in the following:
<ul>
<li><code>CBSD category</code> should be <code>A</code> for indoor base stations and <code>B</code> for outdoor base stations, based on your actual situation.</li>
<li><code>FCC ID</code> should be the FCC ID on the base station's label.</li>
<li><code>Serial number</code> should be the serial number on the base station's label.</li>
<li><code>Device type</code> should be <code>Indoor</code> (indoor) or <code>Outdoor</code> (outdoor), based on your actual situation.</li>
<li>Under <code>Air Interface</code>, select <code>E_UTRA</code> (corresponding to LTE) for <code>Radio technology</code>.</li>
<li>Under <code>Antenna</code>, fill in <code>Height</code> with your GPS altitude.</li>
<li>Under <code>Antenna</code>, select <code>Height type</code> as <code>AMSL</code> (height referenced to sea level).</li>
<li>Under <code>Antenna</code>, fill in <code>Azimuth</code> with the compass direction the base station faces.
<ul>
<li>For FreedomFi/Sercomm indoor base stations, since the antenna transmits in 360 degrees, the direction doesn't matter, so you can directly enter <code>0</code>.</li>
</ul>
</li>
<li>Under <code>Antenna</code>, fill in <code>Mech downtilt</code> with the degree of downward tilt of the base station; if there's no tilt, you can directly enter <code>0</code>.</li>
<li>Under <code>Antenna</code>, fill in <code>Horiz accuracy</code> with <code>10</code>.</li>
<li>Under <code>Antenna</code>, fill in <code>Vert accuracy</code> with <code>3</code>.</li>
</ul>
</li>
<li>You also need to fill in the following based on the base station's data sheet. If you're using a FreedomFi/Sercomm indoor base station, you can directly copy my configuration:
<ul>
<li><code>Max EIRP</code> should be <code>29</code> for FreedomFi/Sercomm indoor base stations.</li>
<li>Under <code>Antenna</code>, <code>Max gain</code> should be <code>5</code> for FreedomFi/Sercomm indoor base stations.</li>
<li>Under <code>Antenna</code>, <code>Beamwidth</code> should be <code>360</code> for FreedomFi/Sercomm indoor base stations.</li>
<li>Under <code>Antenna</code>, <code>Azimuth</code> should be <code>360</code> for FreedomFi/Sercomm indoor base stations.</li>
<li>Under <code>Measurement capability</code>, for FreedomFi/Sercomm indoor base stations, do not check <code>RX w/ grant</code>, but check <code>RX w/o grant</code>.</li>
<li>Under <code>Air Interface</code>, <code>Supported spec</code> should be <code>FFS</code> for FreedomFi/Sercomm indoor base stations.</li>
</ul>
</li>
<li>You can leave the rest of the configurations blank; click <code>Ready for CPI</code>.</li>
<li>At this point, the page will display "The new configuration must be signed by a CPI before the CBSD registers with the SAS." If you're installing an indoor base station, you can ignore this. But if you're installing an outdoor base station, you'll need to find a Certified Professional Installer to approve the configuration, or <a href="https://www.coursera.org/learn/google-cbrs-cpi-training" rel="noopener noreferrer" target="_blank">spend $600 to get certified as a CPI</a>.</li>
</ol>
<p><picture><source srcset="/usr/uploads/202504/google-sas-radio-info-1.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/google-sas-radio-info-1.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/google-sas-radio-info-1.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/google-sas-radio-info-1.png" alt="Google SAS Base Station Information Interface 1"></picture></p>
<p><picture><source srcset="/usr/uploads/202504/google-sas-radio-info-2.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/google-sas-radio-info-2.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/google-sas-radio-info-2.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/google-sas-radio-info-2.png" alt="Google SAS Base Station Information Interface 2"></picture></p>
<p>Reboot the base station: unplug the power from your base station, wait a few seconds, then plug it back in. After a few minutes, once the base station has started up and completed GPS positioning, the Google SAS configuration page should show some yellow-highlighted <code>Active config value</code>, indicating that these configurations differ from what you entered. You can ignore them.</p>
<p>Switch to the <code>Status</code> tab to view the device status; you should see the base station status as <code>Authorized</code> and the corresponding frequency allocation.</p>
<p>At this point, check the base station's indicator lights; the leftmost LTE status indicator light should be a steady blue, indicating that it's now transmitting LTE signals. This completes the base station configuration.</p>
<p>Take out your phone, select any SIM card, turn off the "Automatic Network Selection" option, and the phone will automatically search for nearby mobile networks. If your phone supports LTE band 48, you should see a network named 315010, which is the signal transmitted by your base station.</p>
<h1 id="programming-sim-cards">Programming SIM Cards</h1>
<p>With the LTE network in place, the next step is to program your network's authentication information onto the SIM cards, allowing phones to connect to your network.</p>
<p>When I bought the programmable SIM cards, the seller provided Windows card-programming software compatible with these SIM cards. I tried using pySim to program the cards on Linux, but the resulting SIM cards couldn't connect to the network for authentication, so I used Windows for this step.</p>
<p>Insert the SIM card programmer into your computer and insert a programmable SIM card into the programmer.</p>
<p>Open the card-programming software, first click the <code>Read Card</code> button in the top right to attempt to read the card's information, ensuring the programmer is connected properly.</p>
<p>Then, in the <code>LTE/WCDMA Parameter</code> section on the right, enter the following information:</p>
<ul>
<li>Select <code>IMSI15</code> and enter <code>3150109999XXXXX</code>, where the first ten digits are fixed, and the last five can be numbered arbitrarily.
<ul>
<li>The first six digits <code>315010</code> are the MCC/MNC for CBRS networks.</li>
<li>The next four digits <code>9999</code> are the IBN (IMSI Block Number) within the CBRS network; <code>9999</code> is the test number reserved for CBRS. The complete IBN allocation table can be found on the <a href="https://imsiadmin.com/assignments/cbrs/" rel="noopener noreferrer" target="_blank">CBRS Assignments</a> webpage.</li>
<li>The last five digits can be any number you choose.</li>
</ul>
</li>
<li>Ensure the <code>AD</code> field value is <code>00000003</code>. If it's different, click the edit button on the right and ensure the MNC length is set to 3.</li>
<li>In the <code>KI</code> and <code>OPC</code> fields, enter a random 32-character hexadecimal string for each. These strings are the authentication keys for the SIM card and cannot be read back once written to the SIM card.
<ul>
<li>Keep a backup of the <code>KI</code> and <code>OPC</code> values; you'll need to enter them into the Magma core network management page later.</li>
</ul>
</li>
<li>Click the <code>Auto</code> button next to <code>PLMNwAct</code>, and the four input fields on the left should automatically fill with the values shown in the image.</li>
<li>Change the <code>SPN</code> to the operator name you want to display on your phone, for example, <code>Lan Tian Mobile</code>.</li>
</ul>
<p>Finally, click the <code>Write Card</code> button in the top right to program the card.</p>
<p>If you want to program multiple SIM cards, follow the same process, but ensure that the <code>IMSI15</code>, <code>KI</code>, and <code>OPC</code> values are different for each card.</p>
<p><picture><source srcset="/usr/uploads/202504/write-sim-card.jpg.webp" type="image/webp"><source srcset="/usr/uploads/202504/write-sim-card.jpg.avif" type="image/avif"><source srcset="/usr/uploads/202504/write-sim-card.jpg.jxl" type="image/jxl"><img src="/usr/uploads/202504/write-sim-card.jpg" alt="SIM card programming software interface"></picture></p>
<h2 id="creating-a-data-plan">Creating a Data Plan</h2>
<p>Return to the core network management interface at <a href="https://magma-test.magma.test" rel="noopener noreferrer" target="_blank">https://magma-test.magma.test</a> (or <code>magma-test.[your own domain]</code>), go to the left <code>Traffic</code> tab, then to the top <code>APNs</code> tab, and click <code>Create New APN</code> to create an APN.</p>
<ul>
<li>Enter <code>internet</code> for <code>APN ID</code>.</li>
<li>For <code>Max Required Bandwidth</code>, enter <code>1000000000</code> (1 Gbps, far exceeding the speed LTE can provide) for both upload and download.</li>
<li>Select <code>IPV4V6</code> for <code>PDN Type</code>.</li>
<li>Keep all other configurations at their defaults.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/magma-add-apn.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-apn.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-apn.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-apn.png" alt="Magma Add APN Interface"></picture></p>
<p>Then, click the top <code>Data Plans</code> tab and click <code>Create New Data Plan</code>.</p>
<ul>
<li>You can enter any value for <code>Data Plan ID</code>.</li>
<li>Keep both <code>Download</code> and <code>Upload</code> set to <code>Unlimited</code>.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/magma-add-data-plan.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-data-plan.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-data-plan.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-data-plan.png" alt="Magma Add Data Plan Interface"></picture></p>
<p>At this point, the data plan is created, and you can start registering SIM cards.</p>
<h2 id="registering-sim-cards">Registering SIM Cards</h2>
<p>Go to the left <code>Subscriber</code> tab in the management interface, then click <code>Manage Subscribers</code> - <code>Add Subscribers</code>.</p>
<p>For each SIM card you want to add, click the <code>Add New Row</code> button in the top right and enter the SIM card's information:</p>
<ul>
<li>In the <code>IMSI</code> field, first enter <code>IMSI</code>, then the <code>IMSI15</code> you used when programming the card. For example: <code>IMSI315010999925470</code>.</li>
<li>You can enter any value for <code>Subscriber Name</code>.</li>
<li>Enter the <code>KI</code> you used when programming the card in the <code>Auth Key</code> field.</li>
<li>Enter the <code>OPC</code> you used when programming the card in the <code>Auth OPC</code> field.</li>
<li>Select <code>ACTIVE</code> for <code>Service</code> to enable the SIM card.</li>
<li>Select the data plan you created earlier for <code>Data Plan</code>.</li>
<li>Select the APN you created earlier for <code>Active APNs</code>.</li>
<li>Click the checkmark on the right to save.</li>
</ul>
<p><picture><source srcset="/usr/uploads/202504/magma-add-sim.png.webp" type="image/webp"><source srcset="/usr/uploads/202504/magma-add-sim.png.avif" type="image/avif"><source srcset="/usr/uploads/202504/magma-add-sim.png.jxl" type="image/jxl"><img src="/usr/uploads/202504/magma-add-sim.png" alt="Magma Add SIM Card Interface"></picture></p>
<p>At this point, your SIM card is successfully registered with the Magma core network, and after a brief data synchronization, it will be ready for use.</p>
<h1 id="connecting-a-phone-to-the-network">Connecting a Phone to the Network</h1>
<p>Insert the SIM card into your phone. I used an iPhone SE 2022 for testing.</p>
<p>After inserting the SIM card and waiting a moment, the iPhone connected to my base station, showing full signal strength in the top left corner, with the network displayed as <code>315 010</code>, which is the MCC/MNC for CBRS:</p>
<p><picture><source srcset="/usr/uploads/202504/iphone-non-public-network-en.jpg.webp" type="image/webp"><source srcset="/usr/uploads/202504/iphone-non-public-network-en.jpg.avif" type="image/avif"><source srcset="/usr/uploads/202504/iphone-non-public-network-en.jpg.jxl" type="image/jxl"><img src="/usr/uploads/202504/iphone-non-public-network-en.jpg" alt="iPhone Network Status"></picture></p>
<p>Using Speedtest to measure the speed, I achieved a download speed of 100 Mbps and an upload speed of 10 Mbps:</p>
<p><picture><source srcset="/usr/uploads/202504/iphone-speedtest.jpg.webp" type="image/webp"><source srcset="/usr/uploads/202504/iphone-speedtest.jpg.avif" type="image/avif"><source srcset="/usr/uploads/202504/iphone-speedtest.jpg.jxl" type="image/jxl"><img src="/usr/uploads/202504/iphone-speedtest.jpg" alt="iPhone Speedtest"></picture></p>
<p>I also tried an Android phone, a Motorola Edge+ 2023. Although this phone could see my LTE network, it couldn't connect to it properly, even with the same SIM card that worked on the iPhone. Further investigation is needed.</p>
<h1 id="conclusion">Conclusion</h1>
<p>The total cost of all the equipment and services I used to build this LTE network (excluding sales tax) is as follows:</p>
<ul>
<li>Proxmox VE host for running virtual machines, my existing equipment: $0</li>
<li>FreedomFi/Sercomm indoor base station: $49 + shipping $12.3 = $61.3</li>
<li>Programmable SIM cards and card programmer: $38.99</li>
<li>Google SAS: $2.64/month, calculated for one month</li>
<li>Total cost: $102.93</li>
</ul>
<p>This price is not expensive for a Homelabber, far below the traditional belief that building an LTE network costs hundreds or thousands of dollars, and all the equipment and services can be easily purchased.</p>  </div>  <div class="clearfix" id="post-navi" data-astro-cid-gfbmwgei=""> <div class="float-end text-end" data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-computer/build-custom-android-kernel-with-nix.lantian/" title="Building Custom Android Kernel with Nix" data-astro-cid-gfbmwgei=""> Building Custom Android Kernel with Nix </a> <br data-astro-cid-gfbmwgei=""> Next post »
</div> <div class="float-start text-start position-absolute" data-astro-cid-gfbmwgei="">
« Previous post <br data-astro-cid-gfbmwgei=""> <a href="/en/article/modify-computer/nix-logarithmetic-math-library-from-zero.lantian/" title="Nix Logarithmic Math Library from Ground Zero" data-astro-cid-gfbmwgei=""> Nix Logarithmic Math Library from Ground Zero </a> </div> </div>  <div id="waline" data-waline-language="en-US" data-waline-path="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian"></div> <script type="module" src="/assets/WalineComment.astro_astro_type_script_index_0_lang.Dqib3X1E.js"></script>  </div> </div> </article>  </div> <aside class="d-none d-xl-block"> <section class="widget"> <h3>Latest posts</h3> <ul class="list-unstyled"> <li> 07-20  <a href="/en/article/modify-computer/legal-lte-network-at-home-with-open5gs.lantian/">Legal LTE Network at Home with Open5GS</a> </li><li> 06-27  <a href="/en/article/modify-computer/sidestore-without-stosvpn-across-lan.lantian/">Using SideStore without StosVPN across your LAN</a> </li><li> 05-19  <a href="/en/article/modify-computer/nix-logarithmetic-math-library-from-zero.lantian/">Nix Logarithmic Math Library from Ground Zero</a> </li><li> 04-06  <a href="/en/article/modify-computer/legal-lte-network-at-home-for-100-bucks.lantian/">Legal LTE Network at Home for $100</a> </li><li> 02-10  <a href="/en/article/modify-computer/build-custom-android-kernel-with-nix.lantian/">Building Custom Android Kernel with Nix</a> </li><li> 04-20  <a href="/en/article/modify-website/migrate-blog-to-astro-js.lantian/">Migrating My Blog to Astro.js</a> </li><li> 12-16  <a href="/en/article/modify-computer/nixos-low-ram-vps.lantian/">NixOS Series 5: Creating Disk Image for Low RAM VPS</a> </li><li> 09-20  <a href="/en/article/modify-computer/nix-trigonometric-math-library-from-zero.lantian/">Nix Trigonometric Math Library from Ground Zero</a> </li><li> 05-29  <a href="/en/article/random-notes/pipewire-sigkill-fix.lantian/">Preventing Pipewire from being SIGKILLed</a> </li><li> 05-12  <a href="/en/article/modify-website/how-to-kill-the-dn42-network.lantian/">How to Kill the DN42 Network (Updated 2023-05-12)</a> </li><li> 05-08  <a href="/en/article/modify-computer/laptop-muxed-nvidia-passthrough.lantian/">NVIDIA GPU Passthrough on an Optimus MUXed Laptop (Updated 2023-05)</a> </li><li> 04-17  <a href="/en/article/random-notes/fix-china-telecom-roaming-no-4g-on-aosp-rom.lantian/">Fix China Telecom 4G Roaming on AOSP ROM by Changing APN</a> </li><li> 03-26  <a href="/en/article/random-notes/old-hp-workstation-as-all-in-one.lantian/">Notes on Setting Up NAS+Router on Old HP Workstation</a> </li><li> 01-14  <a href="/en/article/modify-computer/nixos-impermanence.lantian/">NixOS Series 4: &quot;Stateless&quot; Operating System</a> </li><li> 06-21  <a href="/en/article/modify-computer/nixos-packaging.lantian/">NixOS Series 3: Software Packaging 101</a> </li> </ul> </section> <section class="widget"> <h3>Latest comments</h3> <ul class="list-unstyled" id="recent-comments">  <li><a href="#">Loading...</a></li>  </ul> </section> <script type="module">const i=window.location.hostname=="localhost"?"https://comments.lantian.pub":window.location.origin;fetch(`${i}/api/comment?type=recent&count=10`).then(t=>{if(t.status!==200)throw new Error(`Server returned bad HTTP status ${t.status}`);return t.json()}).then(t=>{const e=document.getElementById("recent-comments");e&&(e.innerHTML=t.data.map(n=>{const o=n.comment.replace(/(<([^>]+)>)/gi,"");return"<li>"+n.nick+' <a href="'+n.url+'">'+o+"</a></li>"}).join(""))});</script> <section class="widget"> <h3>Others</h3> <ul class="list-unstyled">  <li> <i class="fas fa-fw fa-rss"></i>  <a href="/rss2.xml" target="_blank">RSS Feed</a> |  <a href="/feed.xml" target="_blank">Atom</a> |  <a href="/feed.json" target="_blank">JSON</a> </li> <li> <i class="fas fa-fw fa-globe"></i>  <a href="https://stats.uptimerobot.com/BLK6VsRkR" target="_blank"> Sever Status </a> </li> <li> <i class="fas fa-fw fa-sitemap"></i>  <a href="https://lg.lantian.pub" target="_blank">DN42 Looking Glass</a> </li> <li> <i class="fas fa-fw fa-link"></i>  <a href="gopher://lantian.pub" target="_blank">Access with Gopher protocol</a> </li>  </ul> </section> <section class="widget"> <h3>Links</h3> <ul class="list-unstyled"> <li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://0x7f.cc"> 0x7f Blog 🐑 </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="http://foreverblog.cn"> 10 Year&#39;s Promise (Forever Blog) </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://alanyhq.com"> Alanyhq </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.baoshuo.ren/?utm_source=friends"> Baoshuo&#39;s Blog </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://blog.cas7.moe"> Blog of Moecast </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://jerryxiao.cc"> JerryXiao </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://sangsir.com"> SangSir </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://snli.org"> Shucheng Li </a> </li><li> <i class="fas fa-fw fa-link"></i>  <a target="_blank" href="https://yuetau.net"> YuetAu&#39;s Spot </a> </li> </ul> </section> </aside> </div> <footer class="lantian clearfix" data-astro-cid-w3csb3e3="">  <div id="copyright" class="float-end text-end" data-astro-cid-w3csb3e3=""> <i class="fas fa-copyright" data-astro-cid-w3csb3e3=""></i> 2012-2025 Lan Tian @ Blog<br data-astro-cid-w3csb3e3=""> <small data-astro-cid-w3csb3e3=""> Powered by Astro v5.15.1 @ 2025-10-25 23:46:37 </small> </div> <script type="module">function v(c,o,r){const h=/^localhost$|^127(?:\.[0-9]+){0,2}\.[0-9]+$|^(?:0*:)*?:?0*1$/.test(location.hostname)||location.protocol==="file:";if(!o.trackLocalhost&&h)return console.warn("[Plausible] Ignoring event because website is running locally");try{if(window.localStorage.plausible_ignore==="true")return console.warn('[Plausible] Ignoring event because "plausible_ignore" is set to "true" in localStorage')}catch{}const p={n:c,u:o.url,d:o.domain,r:o.referrer,w:o.deviceWidth,h:o.hashMode?1:0,p:r&&r.props?JSON.stringify(r.props):void 0},s=new XMLHttpRequest;s.open("POST",`${o.apiHost}/api/event`,!0),s.setRequestHeader("Content-Type","text/plain"),s.send(JSON.stringify(p)),s.onreadystatechange=()=>{s.readyState===4&&r&&r.callback&&r.callback()}}function b(c){const o=()=>({hashMode:!1,trackLocalhost:!1,url:location.href,domain:location.hostname,referrer:document.referrer||null,deviceWidth:window.innerWidth,apiHost:"https://plausible.io",...c}),r=(t,n,i)=>{v(t,{...o(),...i},n)},h=(t,n)=>{r("pageview",n,t)};return{trackEvent:r,trackPageview:h,enableAutoPageviews:()=>{const t=()=>h(),n=history.pushState;return n&&(history.pushState=function(i,l,u){n.apply(this,[i,l,u]),t()},addEventListener("popstate",t)),c&&c.hashMode&&addEventListener("hashchange",t),h(),function(){n&&(history.pushState=n,removeEventListener("popstate",t)),c&&c.hashMode&&removeEventListener("hashchange",t)}},enableAutoOutboundTracking:(t=document,n={subtree:!0,childList:!0,attributes:!0,attributeFilter:["href"]})=>{function i(e){r("Outbound Link: Click",{props:{url:this.href}}),typeof process<"u"&&process,setTimeout(()=>{location.href=this.href},150),e.preventDefault()}const l=new Set;function u(e){e instanceof HTMLAnchorElement?e.host!==location.host&&(e.addEventListener("click",i),l.add(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(u)}function f(e){e instanceof HTMLAnchorElement?(e.removeEventListener("click",i),l.delete(e)):"querySelectorAll"in e&&e.querySelectorAll("a").forEach(f)}const d=new MutationObserver(e=>{e.forEach(a=>{a.type==="attributes"?(f(a.target),u(a.target)):a.type==="childList"&&(a.addedNodes.forEach(u),a.removedNodes.forEach(f))})});return t.querySelectorAll("a").forEach(u),d.observe(t,n),function(){l.forEach(a=>{a.removeEventListener("click",i)}),l.clear(),d.disconnect()}}}}const g=b({domain:"lantian.pub",trackLocalhost:!0,apiHost:""});g.trackPageview();</script> </footer>  </div>  </body> </html>